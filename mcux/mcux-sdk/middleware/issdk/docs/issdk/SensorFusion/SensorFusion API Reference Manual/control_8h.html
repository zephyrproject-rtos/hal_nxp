<!-- HTML header for doxygen 1.8.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>control.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script src="http://www.nxp.com/files/abstract/misc/COLLATERALTEMPLATE_infocenter.js" type="text/javascript" xml:space="preserve"><!-- --></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="html_custom.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="NXP_FullColor_RGB_wrapped.png"/></td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief">Sensor Fusion for Kinetis MCUs (ISSDK/KSDK version)</div>
    </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>API</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('control_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#nested-classes">Data Structures</a> &#124;
<a href="#typedef-members">Typedefs</a> &#124;
<a href="#func-members">Functions</a> &#124;
<a href="#var-members">Variables</a>  </div>
  <div class="headertitle">
<div class="title">control.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> This graph shows which files directly or indirectly include this file:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="control_8h__dep__incl.png" border="0" usemap="#control_8hdep" alt=""/></div>
<map name="control_8hdep" id="control_8hdep">
<area shape="rect" id="node2" href="control_8c.html" title="Defines control sub&#45;system. " alt="" coords="5,87,77,114"/>
<area shape="rect" id="node3" href="debug_8c.html" title="ApplyPerturbation function used to analyze dynamic performance. " alt="" coords="102,87,170,114"/>
<area shape="rect" id="node4" href="DecodeCommandBytes_8c.html" title="Command interpreter which interfaces to the Sensor Fusion Toolbox. " alt="" coords="195,87,365,114"/>
<area shape="rect" id="node5" href="fusion_8c.html" title="Lower level sensor fusion interface. " alt="" coords="389,87,456,114"/>
<area shape="rect" id="node6" href="main__agm01__freertos__two__tasks_8c.html" title="FreeRTOS (two task) implementation of sensor fusion on FRDM&#45;K64F. " alt="" coords="480,80,627,121"/>
<area shape="rect" id="node7" href="main__baremetal_8c.html" title="Bare metal implementation of sensor fusion on FRDM&#45;K64F. " alt="" coords="651,87,776,114"/>
<area shape="rect" id="node8" href="main__freertos__agm02_8c.html" title="FreeRTOS (two task) implementation of sensor fusion on FRDM&#45;K64F/FRDM&#45;FXS&#45;AGM02. " alt="" coords="800,87,957,114"/>
<area shape="rect" id="node9" href="main__freertos__agm02__power__cycling_8c.html" title="FreeRTOS (two task) implementation of sensor fusion on FRDM&#45;K64F/FRDM&#45;FXS&#45;AGM02 with smart power&#45;cycl..." alt="" coords="981,80,1128,121"/>
<area shape="rect" id="node10" href="main__freertos__single__task_8c.html" title="FreeRTOS (single task) implementation of sensor fusion on FRDM&#45;K64F. " alt="" coords="1152,80,1293,121"/>
<area shape="rect" id="node11" href="main__freertos__two__tasks_8c.html" title="FreeRTOS (two task) implementation of sensor fusion on FRDM&#45;K64F. " alt="" coords="1318,87,1495,114"/>
<area shape="rect" id="node12" href="output__stream_8c.html" title="Implements streaming function for the status subsystem. See status.h. " alt="" coords="1519,87,1635,114"/>
<area shape="rect" id="node13" href="sensor__fusion_8c.html" title="The sensor_fusion.c file implements the top level programming interface. " alt="" coords="1659,87,1773,114"/>
</map>
</div>
</div>
<p><a href="control_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="nested-classes"></a>
Data Structures</h2></td></tr>
<tr class="memitem:"><td class="memItemLeft" align="right" valign="top">struct &#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="structControlSubsystem.html">ControlSubsystem</a></td></tr>
<tr class="separator:"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="typedef-members"></a>
Typedefs</h2></td></tr>
<tr class="memitem:a7bb1f2fadae97637d14fefbd6456fa33"><td class="memItemLeft" align="right" valign="top">typedef struct <a class="el" href="structControlSubsystem.html">ControlSubsystem</a>&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a7bb1f2fadae97637d14fefbd6456fa33">ControlSubsystem</a></td></tr>
<tr class="separator:a7bb1f2fadae97637d14fefbd6456fa33"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr><td colspan="2"><div class="groupHeader">Control Port Function Type Definitions</div></td></tr>
<tr><td colspan="2"><div class="groupText"><p>The "write" and "stream" commands provide two control functions visible at the <a class="el" href="main__agm01__freertos__two__tasks_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="This is a FreeRTOS (dual task) implementation of the NXP sensor fusion demo build. ">main()</a> level. These typedefs define the structure of those two calls. </p>
</div></td></tr>
<tr class="memitem:a28367a9178388f6dc7ef3a47544e250d"><td class="memItemLeft" align="right" valign="top">typedef int8_t(&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a28367a9178388f6dc7ef3a47544e250d">writePort_t</a>) (struct <a class="el" href="structControlSubsystem.html">ControlSubsystem</a> *pComm, uint8_t buffer[], uint16_t nbytes)</td></tr>
<tr class="separator:a28367a9178388f6dc7ef3a47544e250d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a067b4c2ce3a778c349b3f77936c68b2d"><td class="memItemLeft" align="right" valign="top">typedef void(&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a067b4c2ce3a778c349b3f77936c68b2d">streamData_t</a>) (<a class="el" href="structSensorFusionGlobals.html">SensorFusionGlobals</a> *<a class="el" href="main__freertos__two__tasks_8c.html#afa81c629d378fe700f351a1bce411ad5">sfg</a>, uint8_t *<a class="el" href="main__freertos__single__task_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>)</td></tr>
<tr class="separator:a067b4c2ce3a778c349b3f77936c68b2d"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a67029acf1be9712c5d30c625132ad958"><td class="memItemLeft" align="right" valign="top">int8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a67029acf1be9712c5d30c625132ad958">initializeControlPort</a> (<a class="el" href="structControlSubsystem.html">ControlSubsystem</a> *pComm)</td></tr>
<tr class="separator:a67029acf1be9712c5d30c625132ad958"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:adbb4129e795ca534e4bb1649bb81b559"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#adbb4129e795ca534e4bb1649bb81b559">CreateAndSendPackets</a> (<a class="el" href="structSensorFusionGlobals.html">SensorFusionGlobals</a> *<a class="el" href="main__freertos__two__tasks_8c.html#afa81c629d378fe700f351a1bce411ad5">sfg</a>, uint8_t *<a class="el" href="main__freertos__single__task_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>)</td></tr>
<tr class="separator:adbb4129e795ca534e4bb1649bb81b559"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2d80b68d03de87c2d3cce67273f8a165"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a2d80b68d03de87c2d3cce67273f8a165">DecodeCommandBytes</a> (<a class="el" href="structSensorFusionGlobals.html">SensorFusionGlobals</a> *<a class="el" href="main__freertos__two__tasks_8c.html#afa81c629d378fe700f351a1bce411ad5">sfg</a>, char iCommandBuffer[], <a class="el" href="sensor__fusion_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a> sUART_InputBuffer[], <a class="el" href="sensor__fusion_8h.html#ac2a9e79eb120216f855626495b7bd18a">uint16</a> nbytes)</td></tr>
<tr class="separator:a2d80b68d03de87c2d3cce67273f8a165"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0022c0c45a3b736ffe21164001662b44"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a0022c0c45a3b736ffe21164001662b44">BlueRadios_Init</a> (void)</td></tr>
<tr class="separator:a0022c0c45a3b736ffe21164001662b44"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a7ad6e53b35d6fc860a1299ceff40a299"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a> (uint8_t *pDest, uint16_t *pIndex, uint8_t *pSource, uint16_t iBytesToCopy)</td></tr>
<tr class="separator:a7ad6e53b35d6fc860a1299ceff40a299"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table><table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="var-members"></a>
Variables</h2></td></tr>
<tr class="memitem:a3b6c71dda245dccb73352c7264176527"><td class="memItemLeft" align="right" valign="top">uint8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="control_8h.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a> [256]</td></tr>
<tr class="separator:a3b6c71dda245dccb73352c7264176527"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Each sensor fusion application will probably have its own set of functions to control the fusion process and report results. This file defines the programming interface that should be followed in order for the fusion functions to operate correctly out of the box. The actual command interpreter is defined separately in <a class="el" href="DecodeCommandBytes_8c.html" title="Command interpreter which interfaces to the Sensor Fusion Toolbox. ">DecodeCommandBytes.c</a>. The output streaming function is defined in <a class="el" href="output__stream_8c.html" title="Implements streaming function for the status subsystem. See status.h. ">output_stream.c</a>. Via these three files, the NXP Sensor Fusion Library provides a default set of functions which are compatible with the Sensor Fusion Toolbox. Use of the toolbox is highly recommended at least during initial development, as it provides many useful debug features. The NXP development team will typically require use of the toolbox as a pre-requisite for providing software support. </p>

<p>Definition in file <a class="el" href="control_8h_source.html">control.h</a>.</p>
</div><h2 class="groupheader">Typedef Documentation</h2>
<a class="anchor" id="a7bb1f2fadae97637d14fefbd6456fa33"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef struct <a class="el" href="structControlSubsystem.html">ControlSubsystem</a>  <a class="el" href="structControlSubsystem.html">ControlSubsystem</a></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>he <a class="el" href="structControlSubsystem.html" title="he ControlSubsystem encapsulates command and data streaming functions. ">ControlSubsystem</a> encapsulates command and data streaming functions. </p>
<p>The <a class="el" href="structControlSubsystem.html" title="he ControlSubsystem encapsulates command and data streaming functions. ">ControlSubsystem</a> encapsulates command and data streaming functions for the library. A C++-like typedef structure which includes executable methods for the subsystem is defined here. </p>

</div>
</div>
<a class="anchor" id="a067b4c2ce3a778c349b3f77936c68b2d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef void( streamData_t) (<a class="el" href="structSensorFusionGlobals.html">SensorFusionGlobals</a> *<a class="el" href="main__freertos__two__tasks_8c.html#afa81c629d378fe700f351a1bce411ad5">sfg</a>, uint8_t *<a class="el" href="main__freertos__single__task_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="control_8h_source.html#l00056">56</a> of file <a class="el" href="control_8h_source.html">control.h</a>.</p>

</div>
</div>
<a class="anchor" id="a28367a9178388f6dc7ef3a47544e250d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">typedef int8_t( writePort_t) (struct <a class="el" href="structControlSubsystem.html">ControlSubsystem</a> *pComm, uint8_t buffer[], uint16_t nbytes)</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="control_8h_source.html#l00055">55</a> of file <a class="el" href="control_8h_source.html">control.h</a>.</p>

</div>
</div>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a0022c0c45a3b736ffe21164001662b44"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void BlueRadios_Init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Used to initialize the Blue Radios Bluetooth module found on the FRDM-FXS-MULT2-B sensor shield from NXP. </p>

<p>Definition at line <a class="el" href="control_8c_source.html#l00132">132</a> of file <a class="el" href="control_8c_source.html">control.c</a>.</p>

<p>Referenced by <a class="el" href="control_8c_source.html#l00182">initializeControlPort()</a>.</p>
<div class="fragment"><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;{</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    uint16_t ilen;      <span class="comment">// command string length</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="comment">// transmit &quot;ATSRM,2,0\r&quot; to minimize traffic from the module</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="comment">// command &quot;ATSRM&quot;: sets the module response mode which configures how verbose the module will be</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="comment">// 2: response mode at to minimal</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="comment">// 0: disconnected mode is command mode</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <span class="comment">// \r: carriage return escape sequence</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    strcpy((<span class="keywordtype">char</span> *)<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, <span class="stringliteral">&quot;ATSRM,2,0\r&quot;</span>);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    ilen = strlen((<span class="keywordtype">char</span> *)<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        <a class="code" href="control_8c.html#acb3383fd1d5fe2678879bb01266e7701">writeWirelessPort</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, ilen);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;}</div><div class="ttc" id="control_8c_html_acb3383fd1d5fe2678879bb01266e7701"><div class="ttname"><a href="control_8c.html#acb3383fd1d5fe2678879bb01266e7701">writeWirelessPort</a></div><div class="ttdeci">int8_t writeWirelessPort(uint8_t buffer[], uint16_t nbytes)</div><div class="ttdef"><b>Definition:</b> <a href="control_8c_source.html#l00099">control.c:99</a></div></div>
<div class="ttc" id="control_8c_html_a3b6c71dda245dccb73352c7264176527"><div class="ttname"><a href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a></div><div class="ttdeci">uint8_t sUARTOutputBuffer[256]</div><div class="ttdoc">main output buffer defined in control.c </div><div class="ttdef"><b>Definition:</b> <a href="control_8c_source.html#l00059">control.c:59</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="control_8h_a0022c0c45a3b736ffe21164001662b44_cgraph.png" border="0" usemap="#control_8h_a0022c0c45a3b736ffe21164001662b44_cgraph" alt=""/></div>
<map name="control_8h_a0022c0c45a3b736ffe21164001662b44_cgraph" id="control_8h_a0022c0c45a3b736ffe21164001662b44_cgraph">
<area shape="rect" id="node2" href="control_8c.html#acb3383fd1d5fe2678879bb01266e7701" title="writeWirelessPort" alt="" coords="165,5,289,32"/>
<area shape="rect" id="node3" href="control_8c.html#a9f548c7fc2a3dce2f1c2b0c044dbd2c8" title="myUART_WriteByte" alt="" coords="337,5,476,32"/>
</map>
</div>
</p>

<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="control_8h_a0022c0c45a3b736ffe21164001662b44_icgraph.png" border="0" usemap="#control_8h_a0022c0c45a3b736ffe21164001662b44_icgraph" alt=""/></div>
<map name="control_8h_a0022c0c45a3b736ffe21164001662b44_icgraph" id="control_8h_a0022c0c45a3b736ffe21164001662b44_icgraph">
<area shape="rect" id="node2" href="control_8h.html#a67029acf1be9712c5d30c625132ad958" title="Call this once to initialize structures, ports, etc. " alt="" coords="165,5,300,32"/>
<area shape="rect" id="node3" href="main__agm01__freertos__two__tasks_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="This is a FreeRTOS (dual task) implementation of the NXP sensor fusion demo build. " alt="" coords="348,5,399,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="adbb4129e795ca534e4bb1649bb81b559"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void CreateAndSendPackets </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSensorFusionGlobals.html">SensorFusionGlobals</a> *&#160;</td>
          <td class="paramname"><em>sfg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>sUARTOutputBuffer</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Called once per fusion cycle to stream information required by the NXP Sensor Fusion Toolbox. Packet protocols are defined in the NXP Sensor Fusion for Kinetis Product Development Kit User Guide. </p>

<p>Definition at line <a class="el" href="output__stream_8c_source.html#l00144">144</a> of file <a class="el" href="output__stream_8c_source.html">output_stream.c</a>.</p>

<p>Referenced by <a class="el" href="control_8c_source.html#l00182">initializeControlPort()</a>.</p>
<div class="fragment"><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;{</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;    <a class="code" href="structQuaternion.html">Quaternion</a>      fq;                 <span class="comment">// quaternion to be transmitted</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordtype">float</span>           ftmp;               <span class="comment">// scratch</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    <span class="keyword">static</span> uint32_t iTimeStamp = 0;     <span class="comment">// 1MHz time stamp</span></div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    uint16_t        iIndex;             <span class="comment">// output buffer counter</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    int32_t         scratch32;          <span class="comment">// scratch int32_t</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    int16_t         scratch16;          <span class="comment">// scratch int16_t</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;    int16_t         iPhi,</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;                    iThe,</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;                    iRho;               <span class="comment">// integer angles to be transmitted</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    int16_t         iDelta;             <span class="comment">// magnetic inclination angle if available</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;    int16_t         iOmega[3];          <span class="comment">// scaled angular velocity vector</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    uint16_t        isystick;           <span class="comment">// algorithm systick time</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    int16_t         i, j, k;            <span class="comment">// general purpose</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    uint8_t         tmpuint8_t;         <span class="comment">// scratch uint8_t</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    uint8_t         flags;              <span class="comment">// byte of flags</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    uint8_t         AngularVelocityPacketOn,</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                    DebugPacketOn,</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;                    RPCPacketOn;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;    int8_t          AccelCalPacketOn;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="keyword">static</span> uint8_t  iPacketNumber = 0;  <span class="comment">// packet number</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">// update the 1MHz time stamp counter expected by the PC GUI (independent of project clock rates)</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    iTimeStamp += 1000000 / <a class="code" href="standard__build_8h.html#a470d8d33fe0efafcc0c0835fbea14f5e">FUSION_HZ</a>;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="preprocessor">#if (MAXPACKETRATEHZ &lt; FUSION_HZ)</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;    uint8_t  skip_packet = <a class="code" href="output__stream_8c.html#a16d1508470294835d76682195104898e">throttle</a>(); <span class="comment">// possible UART bandwidth problem</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    <span class="keywordflow">if</span> (skip_packet) <span class="keywordflow">return</span>;  <span class="comment">// need to skip packet transmission to avoid UART overrun</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="comment">// cache local copies of control flags so we don&#39;t have to keep dereferencing pointers below</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    <a class="code" href="sensor__fusion_8h.html#ad1d4d649bfa88f655f8f2d1ee5ae5ace">quaternion_type</a> quaternionPacketType;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    quaternionPacketType = sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a51cbe943cdee0fd0a2ff72d2a04fad9a">pControlSubsystem</a>-&gt;<a class="code" href="structControlSubsystem.html#a560615429c69fcefa85de0624fa6d83e">QuaternionPacketType</a>;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;    AngularVelocityPacketOn = sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a51cbe943cdee0fd0a2ff72d2a04fad9a">pControlSubsystem</a>-&gt;<a class="code" href="structControlSubsystem.html#a527b159143188ef9b66bd4c8a6aefcdf">AngularVelocityPacketOn</a>;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;    DebugPacketOn = sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a51cbe943cdee0fd0a2ff72d2a04fad9a">pControlSubsystem</a>-&gt;<a class="code" href="structControlSubsystem.html#a41ad90f99ac3c14b2bdce3967df14f1b">DebugPacketOn</a>;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;    RPCPacketOn = sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a51cbe943cdee0fd0a2ff72d2a04fad9a">pControlSubsystem</a>-&gt;<a class="code" href="structControlSubsystem.html#a6c5365ebe170e2ee207212da7531ccea">RPCPacketOn</a>;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;    AccelCalPacketOn = sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a51cbe943cdee0fd0a2ff72d2a04fad9a">pControlSubsystem</a>-&gt;<a class="code" href="structControlSubsystem.html#aa62f07fac570bf67c0832d4bf7d38e76">AccelCalPacketOn</a>;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;</div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;    <span class="comment">// zero the counter for bytes accumulated into the transmit buffer</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;    iIndex = 0;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    <span class="comment">// ************************************************************************</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="comment">// Main type 1: range 0 to 35 = 36 bytes</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="comment">// Debug type 2: range 0 to 7 = 8 bytes</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="comment">// Angular velocity type 3: range 0 to 13 = 14 bytes</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="comment">// Euler angles type 4: range 0 to 13 = 14 bytes</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="comment">// Altitude/Temp type 5: range 0 to 13 = 14 bytes</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;    <span class="comment">// Magnetic type 6: range 0 to 16 = 18 bytes</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;    <span class="comment">// Kalman packet 7: range 0 to 47 = 48 bytes</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    <span class="comment">// Precision Accelerometer packet 8: range 0 to 46 = 47 bytes</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;    <span class="comment">//</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="comment">// Total excluding intermittent packet 8 is:</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;    <span class="comment">// 152 bytes vs 256 bytes size of sUARTOutputBuffer</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    <span class="comment">// at 25Hz, data rate is 25*152 = 3800 bytes/sec = 38.0kbaud = 33% of 115.2kbaud</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="comment">// at 40Hz, data rate is 40*152 = 6080 bytes/sec = 60.8kbaud = 53% of 115.2kbaud</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">// at 50Hz, data rate is 50*152 = 7600 bytes/sec = 76.0kbaud = 66% of 115.2kbaud</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="comment">// ************************************************************************</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;    <span class="comment">// ************************************************************************</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">// fixed length packet type 1</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="comment">// this packet type is always transmitted</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="comment">// total size is 0 to 35 equals 36 bytes</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;    <span class="comment">// ************************************************************************</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    <span class="comment">// [0]: packet start byte (need a iIndex++ here since not using sBufAppendItem)</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;    <a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>[iIndex++] = 0x7E;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">// [1]: packet type 1 byte (iIndex is automatically updated in sBufAppendItem)</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    tmpuint8_t = 0x01;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, &amp;tmpuint8_t, 1);</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">// [2]: packet number byte</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, &amp;iPacketNumber, 1);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    iPacketNumber++;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;    <span class="comment">// [6-3]: 1MHz time stamp (4 bytes)</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;iTimeStamp, 4);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">// [12-7]: integer accelerometer data words (scaled to 8192 counts per g for PC GUI)</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="comment">// send non-zero data only if the accelerometer sensor is enabled and used by the selected quaternion</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">if</span> (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#aef4363c6eab965a0a328ee2108572893">iFlags</a> &amp; <a class="code" href="standard__build_8h.html#a8f284d04ec459633d30dc85cf0a32a0d">F_USING_ACCEL</a>) {</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="keywordflow">switch</span> (quaternionPacketType)</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        {</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa19bd87b11e82b9047ad750fb62711ba8">Q3</a>:</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa0cf62dda224dcbac09ae26cd46ccce01">Q6MA</a>:</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa59c8dc55b720396019ef93eb943a3b96">Q6AG</a>:</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa9c5ceeb2bc9bf27379c7e72bc4d0ff13">Q9</a>:</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;<span class="preprocessor">#if F_USING_ACCEL</span></div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                <span class="comment">// accelerometer data is used for the selected quaternion so transmit but clip at 4g</span></div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                scratch32 = (sfg-&gt;Accel.iGc[<a class="code" href="sensor__fusion_8h.html#a48bbd27e913de8d7749dff9dec2fe816">CHX</a>] * 8192) / sfg-&gt;Accel.iCountsPerg;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                if (scratch32 &gt; 32767) scratch32 = 32767;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;                <span class="keywordflow">if</span> (scratch32 &lt; -32768) scratch32 = -32768;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                scratch16 = (int16_t) (scratch32);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                scratch32 = (sfg-&gt;Accel.iGc[<a class="code" href="sensor__fusion_8h.html#a6a25024f52cc6bea13d19f8b68456cea">CHY</a>] * 8192) / sfg-&gt;Accel.iCountsPerg;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;                if (scratch32 &gt; 32767) scratch32 = 32767;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;                <span class="keywordflow">if</span> (scratch32 &lt; -32768) scratch32 = -32768;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                scratch16 = (int16_t) (scratch32);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;                scratch32 = (sfg-&gt;Accel.iGc[<a class="code" href="sensor__fusion_8h.html#a76143891435bdd7248857e45b93521ed">CHZ</a>] * 8192) / sfg-&gt;Accel.iCountsPerg;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;                if (scratch32 &gt; 32767) scratch32 = 32767;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;                <span class="keywordflow">if</span> (scratch32 &lt; -32768) scratch32 = -32768;</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                scratch16 = (int16_t) (scratch32);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;<span class="preprocessor">#endif // F_USING_ACCEL</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaada2dae63d5865a8446caa7938c73c5dc">Q3M</a>:</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaaf63c9f6fec59717499a84048f682cf8a">Q3G</a>:</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;            <span class="keywordflow">default</span>:</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                <span class="comment">// accelerometer data is not used in currently selected algorithm so transmit zero</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                <a class="code" href="output__stream_8c.html#a93db92e775dee51c4dbf2dca2aed05b3">sBufAppendZeros</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, 3);</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;        }</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;     } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                <span class="comment">// accelerometer structure is not defined so transmit zero</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                <a class="code" href="output__stream_8c.html#a93db92e775dee51c4dbf2dca2aed05b3">sBufAppendZeros</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, 3);</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        }</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;    <span class="comment">// [18-13]: integer calibrated magnetometer data words (already scaled to 10 count per uT for PC GUI)</span></div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;    <span class="comment">// send non-zero data only if the magnetometer sensor is enabled and used by the selected quaternion</span></div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;    <span class="keywordflow">if</span> (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#aef4363c6eab965a0a328ee2108572893">iFlags</a> &amp; <a class="code" href="magnetic_8h.html#a78765407e471fe0b9119e5ff41aa7d16">F_USING_MAG</a>)</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        <span class="keywordflow">switch</span> (quaternionPacketType)</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        {</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaada2dae63d5865a8446caa7938c73c5dc">Q3M</a>:</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa0cf62dda224dcbac09ae26cd46ccce01">Q6MA</a>:</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa9c5ceeb2bc9bf27379c7e72bc4d0ff13">Q9</a>:</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;<span class="preprocessor">#if F_USING_MAG</span></div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;                <span class="comment">// magnetometer data is used for the selected quaternion so transmit</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                scratch16 = (int16_t) (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a876af8fddc05153d04bda2d8a8107819">Mag</a>.<a class="code" href="structMagSensor.html#a8a3b181bc80ba70aa8e9741c6a4b8320">iBc</a>[<a class="code" href="sensor__fusion_8h.html#a48bbd27e913de8d7749dff9dec2fe816">CHX</a>] * 10) / (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a876af8fddc05153d04bda2d8a8107819">Mag</a>.<a class="code" href="structMagSensor.html#a8d14850aea4f6f78343db74f3208f5d0">iCountsPeruT</a>);</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                scratch16 = (int16_t) ((sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a876af8fddc05153d04bda2d8a8107819">Mag</a>.<a class="code" href="structMagSensor.html#a8a3b181bc80ba70aa8e9741c6a4b8320">iBc</a>[<a class="code" href="sensor__fusion_8h.html#a6a25024f52cc6bea13d19f8b68456cea">CHY</a>] * 10) / sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a876af8fddc05153d04bda2d8a8107819">Mag</a>.<a class="code" href="structMagSensor.html#a8d14850aea4f6f78343db74f3208f5d0">iCountsPeruT</a>);</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                scratch16 = (int16_t) ((sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a876af8fddc05153d04bda2d8a8107819">Mag</a>.<a class="code" href="structMagSensor.html#a8a3b181bc80ba70aa8e9741c6a4b8320">iBc</a>[<a class="code" href="sensor__fusion_8h.html#a76143891435bdd7248857e45b93521ed">CHZ</a>] * 10) / sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a876af8fddc05153d04bda2d8a8107819">Mag</a>.<a class="code" href="structMagSensor.html#a8d14850aea4f6f78343db74f3208f5d0">iCountsPeruT</a>);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;            <span class="comment">// magnetometer data is not used in currently selected algorithm so transmit zero</span></div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa19bd87b11e82b9047ad750fb62711ba8">Q3</a>:</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaaf63c9f6fec59717499a84048f682cf8a">Q3G</a>:</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa59c8dc55b720396019ef93eb943a3b96">Q6AG</a>:</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;            <span class="keywordflow">default</span>:</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                <a class="code" href="output__stream_8c.html#a93db92e775dee51c4dbf2dca2aed05b3">sBufAppendZeros</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, 3);</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;        }</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    {</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;        <span class="comment">// magnetometer structure is not defined so transmit zero</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <a class="code" href="output__stream_8c.html#a93db92e775dee51c4dbf2dca2aed05b3">sBufAppendZeros</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, 3);</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    }</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;    <span class="comment">// [24-19]: uncalibrated gyro data words (scaled to 20 counts per deg/s for PC GUI)</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;    <span class="comment">// send non-zero data only if the gyro sensor is enabled and used by the selected quaternion</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    <span class="keywordflow">if</span> (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#aef4363c6eab965a0a328ee2108572893">iFlags</a> &amp; <a class="code" href="standard__build_8h.html#aecf1505d7dbaa2569dd3f36bf05ab5a0">F_USING_GYRO</a>)</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    {</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;        <span class="keywordflow">switch</span> (quaternionPacketType)</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        {</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaaf63c9f6fec59717499a84048f682cf8a">Q3G</a>:</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa59c8dc55b720396019ef93eb943a3b96">Q6AG</a>:</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;<span class="preprocessor">#if F_USING_GYRO</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa9c5ceeb2bc9bf27379c7e72bc4d0ff13">Q9</a>:</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;              <span class="comment">// gyro data is used for the selected quaternion so transmit</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                scratch16 = (int16_t) ((sfg-&gt;Gyro.iYs[<a class="code" href="sensor__fusion_8h.html#a48bbd27e913de8d7749dff9dec2fe816">CHX</a>] * 20) / sfg-&gt;Gyro.iCountsPerDegPerSec);</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                scratch16 = (int16_t) ((sfg-&gt;Gyro.iYs[<a class="code" href="sensor__fusion_8h.html#a6a25024f52cc6bea13d19f8b68456cea">CHY</a>] * 20) / sfg-&gt;Gyro.iCountsPerDegPerSec);</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                scratch16 = (int16_t) ((sfg-&gt;Gyro.iYs[<a class="code" href="sensor__fusion_8h.html#a76143891435bdd7248857e45b93521ed">CHZ</a>] * 20) / sfg-&gt;Gyro.iCountsPerDegPerSec);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa19bd87b11e82b9047ad750fb62711ba8">Q3</a>:</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaada2dae63d5865a8446caa7938c73c5dc">Q3M</a>:</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa0cf62dda224dcbac09ae26cd46ccce01">Q6MA</a>:</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;            <span class="keywordflow">default</span>:</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                <span class="comment">// gyro data is not used in currently selected algorithm so transmit zero</span></div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                <a class="code" href="output__stream_8c.html#a93db92e775dee51c4dbf2dca2aed05b3">sBufAppendZeros</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, 3);</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;        }</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;    }</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;    {</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;        <span class="comment">// gyro structure is not defined so transmit zero</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <a class="code" href="output__stream_8c.html#a93db92e775dee51c4dbf2dca2aed05b3">sBufAppendZeros</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, 3);</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    }</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="comment">// initialize default quaternion, flags byte, angular velocity and orientation</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    fq.<a class="code" href="structQuaternion.html#a27b8f713c4a449fb2fbb1cbdb3a1e149">q0</a> = 1.0F;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    fq.<a class="code" href="structQuaternion.html#a209c65446ca302d32cbb908c4d75f616">q1</a> = fq.<a class="code" href="structQuaternion.html#afddca3451c589f7b5928b6dccf8c88ba">q2</a> = fq.<a class="code" href="structQuaternion.html#aa92940755b1370321ed489e6f2448ad9">q3</a> = 0.0F;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    flags = 0x00;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    iOmega[<a class="code" href="sensor__fusion_8h.html#a48bbd27e913de8d7749dff9dec2fe816">CHX</a>] = iOmega[<a class="code" href="sensor__fusion_8h.html#a6a25024f52cc6bea13d19f8b68456cea">CHY</a>] = iOmega[<a class="code" href="sensor__fusion_8h.html#a76143891435bdd7248857e45b93521ed">CHZ</a>] = 0;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;    iPhi = iThe = iRho = iDelta = 0;</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    isystick = 0;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="comment">// flags byte 33: quaternion type in least significant nibble</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;    <span class="comment">// Q3:   coordinate nibble, 1</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    <span class="comment">// Q3M:  coordinate nibble, 6</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;    <span class="comment">// Q3G:  coordinate nibble, 3</span></div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;    <span class="comment">// Q6MA: coordinate nibble, 2</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="comment">// Q6AG: coordinate nibble, 4</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="comment">// Q9:   coordinate nibble, 8</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;    <span class="comment">// flags byte 33: coordinate in most significant nibble</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;    <span class="comment">// Aerospace/NED:   0, quaternion nibble</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;    <span class="comment">// Android:         1, quaternion nibble</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;    <span class="comment">// Windows 8:       2, quaternion nibble</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="comment">// set the quaternion, flags, angular velocity and Euler angles</span></div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;    <span class="keywordflow">switch</span> (quaternionPacketType)</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    {</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;<span class="preprocessor">#if F_3DOF_G_BASIC</span></div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa19bd87b11e82b9047ad750fb62711ba8">Q3</a>:</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;            <span class="keywordflow">if</span> (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#aef4363c6eab965a0a328ee2108572893">iFlags</a> &amp; <a class="code" href="standard__build_8h.html#adb79fa7eb529c4cae2619ef22af3211e">F_3DOF_G_BASIC</a>)</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;            {</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                flags |= 0x01;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                <a class="code" href="output__stream_8c.html#a96da70ac128170ff0d03feffa05ef769">readCommon</a>((<a class="code" href="structSV__COMMON.html">SV_ptr</a>)&amp;sfg-&gt;SV_3DOF_G_BASIC, &amp;fq, &amp;iPhi, &amp;iThe, &amp;iRho, iOmega, &amp;isystick);</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;            }</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;<span class="preprocessor">#if F_3DOF_B_BASIC</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaada2dae63d5865a8446caa7938c73c5dc">Q3M</a>:</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;            <span class="keywordflow">if</span> (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#aef4363c6eab965a0a328ee2108572893">iFlags</a> &amp; <a class="code" href="standard__build_8h.html#aed8da52c8d0d14325445b139876492b4">F_3DOF_B_BASIC</a>)</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;            {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                flags |= 0x06;</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                <a class="code" href="output__stream_8c.html#a96da70ac128170ff0d03feffa05ef769">readCommon</a>((<a class="code" href="structSV__COMMON.html">SV_ptr</a>)&amp;sfg-&gt;SV_3DOF_B_BASIC, &amp;fq, &amp;iPhi, &amp;iThe, &amp;iRho, iOmega, &amp;isystick);</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;            }</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="preprocessor">#if F_3DOF_Y_BASIC</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaaf63c9f6fec59717499a84048f682cf8a">Q3G</a>:</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            <span class="keywordflow">if</span> (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#aef4363c6eab965a0a328ee2108572893">iFlags</a> &amp; <a class="code" href="standard__build_8h.html#a990887d9ed9f03bcaffcd4abae429265">F_3DOF_Y_BASIC</a>)</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;            {</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                flags |= 0x03;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                <a class="code" href="output__stream_8c.html#a96da70ac128170ff0d03feffa05ef769">readCommon</a>((<a class="code" href="structSV__COMMON.html">SV_ptr</a>)&amp;sfg-&gt;SV_3DOF_Y_BASIC, &amp;fq, &amp;iPhi, &amp;iThe, &amp;iRho, iOmega, &amp;isystick);</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;            }</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="preprocessor">#if F_6DOF_GB_BASIC</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa0cf62dda224dcbac09ae26cd46ccce01">Q6MA</a>:</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;            <span class="keywordflow">if</span> (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#aef4363c6eab965a0a328ee2108572893">iFlags</a> &amp; <a class="code" href="standard__build_8h.html#a9b0aadad0b960783ff2ecd5174a57905">F_6DOF_GB_BASIC</a>)</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;            {</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                flags |= 0x02;</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                iDelta = (int16_t) (10.0F * sfg-&gt;SV_6DOF_GB_BASIC.fLPDelta);</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                <a class="code" href="output__stream_8c.html#a96da70ac128170ff0d03feffa05ef769">readCommon</a>((<a class="code" href="structSV__COMMON.html">SV_ptr</a>)&amp;sfg-&gt;SV_6DOF_GB_BASIC, &amp;fq, &amp;iPhi, &amp;iThe, &amp;iRho, iOmega, &amp;isystick);</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;            }</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;<span class="preprocessor">#if F_6DOF_GY_KALMAN</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa59c8dc55b720396019ef93eb943a3b96">Q6AG</a>:</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;            <span class="keywordflow">if</span> (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#aef4363c6eab965a0a328ee2108572893">iFlags</a> &amp; <a class="code" href="standard__build_8h.html#a3aa2972ee6d1865b5bd7ab4e1914a4c5">F_6DOF_GY_KALMAN</a>)</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;            {</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;                flags |= 0x04;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;                <a class="code" href="output__stream_8c.html#a96da70ac128170ff0d03feffa05ef769">readCommon</a>((<a class="code" href="structSV__COMMON.html">SV_ptr</a>)&amp;sfg-&gt;SV_6DOF_GY_KALMAN, &amp;fq, &amp;iPhi, &amp;iThe, &amp;iRho, iOmega, &amp;isystick);</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;            }</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;<span class="preprocessor">#if F_9DOF_GBY_KALMAN</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa9c5ceeb2bc9bf27379c7e72bc4d0ff13">Q9</a>:</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            <span class="keywordflow">if</span> (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#aef4363c6eab965a0a328ee2108572893">iFlags</a> &amp; <a class="code" href="standard__build_8h.html#a067a973335873757f5ecfda300e9c082">F_9DOF_GBY_KALMAN</a>)</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;             {</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;                flags |= 0x08;</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;                iDelta = (int16_t) (10.0F * sfg-&gt;SV_9DOF_GBY_KALMAN.fDeltaPl);</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;                <a class="code" href="output__stream_8c.html#a96da70ac128170ff0d03feffa05ef769">readCommon</a>((<a class="code" href="structSV__COMMON.html">SV_ptr</a>)&amp;sfg-&gt;SV_9DOF_GBY_KALMAN, &amp;fq, &amp;iPhi, &amp;iThe, &amp;iRho, iOmega, &amp;isystick);</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            }</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;        <span class="keywordflow">default</span>:</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;            <span class="comment">// use the default data already initialized</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    }</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="comment">// [32-25]: scale the quaternion (30K = 1.0F) and add to the buffer</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    scratch16 = (int16_t) (fq.<a class="code" href="structQuaternion.html#a27b8f713c4a449fb2fbb1cbdb3a1e149">q0</a> * 30000.0F);</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    scratch16 = (int16_t) (fq.<a class="code" href="structQuaternion.html#a209c65446ca302d32cbb908c4d75f616">q1</a> * 30000.0F);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;    scratch16 = (int16_t) (fq.<a class="code" href="structQuaternion.html#afddca3451c589f7b5928b6dccf8c88ba">q2</a> * 30000.0F);</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;    scratch16 = (int16_t) (fq.<a class="code" href="structQuaternion.html#aa92940755b1370321ed489e6f2448ad9">q3</a> * 30000.0F);</div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;    <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;    <span class="comment">// set the coordinate system bits in flags from default NED (00)</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;<span class="preprocessor">#if THISCOORDSYSTEM == ANDROID</span></div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;    <span class="comment">// set the Android flag bits</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;    flags |= 0x10;</div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;<span class="preprocessor">#elif THISCOORDSYSTEM == WIN8</span></div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;    <span class="comment">// set the Win8 flag bits</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    flags |= 0x20;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="preprocessor">#endif // THISCOORDSYSTEM</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    <span class="comment">// [33]: add the flags byte to the buffer</span></div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;    <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, &amp;flags, 1);</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    <span class="comment">// [34]: add the shield (bits 7-5) and Kinetis (bits 4-0) byte</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    tmpuint8_t = ((THIS_SHIELD &amp; 0x07) &lt;&lt; 5) | (THIS_BOARD &amp; 0x1F);</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, &amp;tmpuint8_t, 1);</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    <span class="comment">// [35]: add the tail byte for the standard packet type 1</span></div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>[iIndex++] = 0x7E;</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    <span class="comment">// ************************************************************************</span></div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="comment">// Variable length debug packet type 2</span></div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;    <span class="comment">// total size is 0 to 7 equals 8 bytes</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    <span class="comment">// ************************************************************************</span></div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    <span class="keywordflow">if</span> (DebugPacketOn)</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;    {</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="comment">// [0]: packet start byte</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;        <a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>[iIndex++] = 0x7E;</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;        <span class="comment">// [1]: packet type 2 byte</span></div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;        tmpuint8_t = 0x02;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, &amp;tmpuint8_t, 1);</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;        <span class="comment">// [2]: packet number byte</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, &amp;iPacketNumber, 1);</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;        iPacketNumber++;</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;        <span class="comment">// [4-3] software version number</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;        scratch16 = <a class="code" href="standard__build_8h.html#a37b68379c938c8404e8e8b0572e7a530">THISBUILD</a>;</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;        <span class="comment">// [6-5] systick count / 20</span></div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;isystick, 2);</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;        <span class="comment">// [7 in practice but can be variable]: add the tail byte for the debug packet type 2</span></div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;        <a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>[iIndex++] = 0x7E;</div><div class="line"><a name="l00467"></a><span class="lineno">  467</span>&#160;    }</div><div class="line"><a name="l00468"></a><span class="lineno">  468</span>&#160;</div><div class="line"><a name="l00469"></a><span class="lineno">  469</span>&#160;    <span class="comment">// ************************************************************************</span></div><div class="line"><a name="l00470"></a><span class="lineno">  470</span>&#160;    <span class="comment">// Angular Velocity packet type 3</span></div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;    <span class="comment">// total bytes for packet type 2 is range 0 to 13 = 14 bytes</span></div><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;    <span class="comment">// ************************************************************************</span></div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    <span class="keywordflow">if</span> (AngularVelocityPacketOn)</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    {</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;        <span class="comment">// [0]: packet start byte</span></div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;        <a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>[iIndex++] = 0x7E;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;        <span class="comment">// [1]: packet type 3 byte (angular velocity)</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;        tmpuint8_t = 0x03;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, &amp;tmpuint8_t, 1);</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <span class="comment">// [2]: packet number byte</span></div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, &amp;iPacketNumber, 1);</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        iPacketNumber++;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;</div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        <span class="comment">// [6-3]: time stamp (4 bytes)</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;iTimeStamp, 4);</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;        <span class="comment">// [12-7]: add the scaled angular velocity vector to the output buffer</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;iOmega[<a class="code" href="sensor__fusion_8h.html#a48bbd27e913de8d7749dff9dec2fe816">CHX</a>], 2);</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;iOmega[<a class="code" href="sensor__fusion_8h.html#a6a25024f52cc6bea13d19f8b68456cea">CHY</a>], 2);</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;iOmega[<a class="code" href="sensor__fusion_8h.html#a76143891435bdd7248857e45b93521ed">CHZ</a>], 2);</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;        <span class="comment">// [13]: add the tail byte for the angular velocity packet type 3</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;        <a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>[iIndex++] = 0x7E;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    }</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;    <span class="comment">// ************************************************************************</span></div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="comment">// Roll, Pitch, Compass Euler angles packet type 4</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <span class="comment">// total bytes for packet type 4 is range 0 to 13 = 14 bytes</span></div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;    <span class="comment">// ************************************************************************</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="keywordflow">if</span> (RPCPacketOn)</div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    {</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;        <span class="comment">// [0]: packet start byte</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;        <a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>[iIndex++] = 0x7E;</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;        <span class="comment">// [1]: packet type 4 byte (Euler angles)</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;        tmpuint8_t = 0x04;</div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, &amp;tmpuint8_t, 1);</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;        <span class="comment">// [2]: packet number byte</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, &amp;iPacketNumber, 1);</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;        iPacketNumber++;</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;        <span class="comment">// [6-3]: time stamp (4 bytes)</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;iTimeStamp, 4);</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;        <span class="comment">// [12-7]: add the angles (resolution 0.1 deg per count) to the transmit buffer</span></div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;iPhi, 2);</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;iThe, 2);</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;iRho, 2);</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;        <span class="comment">// [13]: add the tail byte for the roll, pitch, compass angle packet type 4</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;        <a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>[iIndex++] = 0x7E;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    }</div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;</div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="comment">// ************************************************************************</span></div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="comment">// Altitude / Temperature packet type 5</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="comment">// total bytes for packet type 5 is range 0 to 13 = 14 bytes</span></div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="comment">// ************************************************************************</span></div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;<span class="preprocessor">#if F_USING_PRESSURE</span></div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <span class="keywordflow">if</span> (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#aef4363c6eab965a0a328ee2108572893">iFlags</a> &amp; <a class="code" href="standard__build_8h.html#a69b745acfd24d1873d47c67aca06df26">F_1DOF_P_BASIC</a>)</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    {</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;        <span class="keywordflow">if</span> (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a51cbe943cdee0fd0a2ff72d2a04fad9a">pControlSubsystem</a>-&gt;<a class="code" href="structControlSubsystem.html#af46ef3a1af714f7d40707053964db4a8">AltPacketOn</a> &amp;&amp; sfg-&gt;Pressure.iWhoAmI)</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;        {</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;            <span class="comment">// [0]: packet start byte</span></div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;            <a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>[iIndex++] = 0x7E;</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;            <span class="comment">// [1]: packet type 5 byte</span></div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;            tmpuint8_t = 0x05;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;            <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, &amp;tmpuint8_t, 1);</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;            <span class="comment">// [2]: packet number byte</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;            <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, &amp;iPacketNumber, 1);</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;            iPacketNumber++;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;            <span class="comment">// [6-3]: time stamp (4 bytes)</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;            <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;iTimeStamp,</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;                           4);</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;            <span class="comment">// [10-7]: altitude (4 bytes, metres times 1000)</span></div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;            scratch32 = (int32_t) (sfg-&gt;SV_1DOF_P_BASIC.fLPH * 1000.0F);</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;            <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch32, 4);</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            <span class="comment">// [12-11]: temperature (2 bytes, deg C times 100)</span></div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;            scratch16 = (int16_t) (sfg-&gt;SV_1DOF_P_BASIC.fLPT * 100.0F);</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;            <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;            <span class="comment">// [13]: add the tail byte for the altitude / temperature packet type 5</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;            <a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>[iIndex++] = 0x7E;</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;        }</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    }</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;    <span class="comment">// ************************************************************************</span></div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;    <span class="comment">// magnetic buffer packet type 6</span></div><div class="line"><a name="l00567"></a><span class="lineno">  567</span>&#160;    <span class="comment">// currently total size is 0 to 17 equals 18 bytes</span></div><div class="line"><a name="l00568"></a><span class="lineno">  568</span>&#160;    <span class="comment">// this packet is only transmitted if a magnetic algorithm is computed</span></div><div class="line"><a name="l00569"></a><span class="lineno">  569</span>&#160;    <span class="comment">// ************************************************************************</span></div><div class="line"><a name="l00570"></a><span class="lineno">  570</span>&#160;<span class="preprocessor">#if F_USING_MAG</span></div><div class="line"><a name="l00571"></a><span class="lineno">  571</span>&#160;    <span class="keyword">static</span> int16_t  MagneticPacketID = 0;   <span class="comment">// magnetic packet number</span></div><div class="line"><a name="l00572"></a><span class="lineno">  572</span>&#160;    <span class="keywordflow">if</span> (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#aef4363c6eab965a0a328ee2108572893">iFlags</a> &amp; <a class="code" href="magnetic_8h.html#a78765407e471fe0b9119e5ff41aa7d16">F_USING_MAG</a>)</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    {</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;        <span class="comment">// [0]: packet start byte</span></div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;        <a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>[iIndex++] = 0x7E;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;        <span class="comment">// [1]: packet type 6 byte</span></div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;        tmpuint8_t = 0x06;</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, &amp;tmpuint8_t, 1);</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;        <span class="comment">// [2]: packet number byte</span></div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, &amp;iPacketNumber, 1);</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;        iPacketNumber++;</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;        <span class="comment">// [4-3]: number of active measurements in the magnetic buffer</span></div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex,</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;                       (uint8_t *) &amp;(sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#ad44d6aaf76570ad374ad7c170175de5a">MagBuffer</a>.<a class="code" href="structMagBuffer.html#a3cf587e6fce57898d9d4977239462406">iMagBufferCount</a>), 2);</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;        <span class="comment">// [6-5]: fit error (%) with resolution 0.01%</span></div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;        <span class="keywordflow">if</span> (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#acf241c1ff86d307d296f560449acc2a4">MagCal</a>.<a class="code" href="structMagCalibration.html#aed673fe73dd32922ee873849472dfe71">fFitErrorpc</a> &gt; 327.67F)</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;            scratch16 = 32767;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;            scratch16 = (int16_t) (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#acf241c1ff86d307d296f560449acc2a4">MagCal</a>.<a class="code" href="structMagCalibration.html#aed673fe73dd32922ee873849472dfe71">fFitErrorpc</a> * 100.0F);</div><div class="line"><a name="l00594"></a><span class="lineno">  594</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00595"></a><span class="lineno">  595</span>&#160;</div><div class="line"><a name="l00596"></a><span class="lineno">  596</span>&#160;        <span class="comment">// [8-7]: geomagnetic field strength with resolution 0.1uT</span></div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;        scratch16 = (int16_t) (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#acf241c1ff86d307d296f560449acc2a4">MagCal</a>.<a class="code" href="structMagCalibration.html#a70d5d3dc1013e238e1d623e67332d87c">fB</a> * 10.0F);</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;        <span class="comment">// always calculate magnetic buffer row and column (low overhead and saves warnings)</span></div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;        k = MagneticPacketID - 10;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;        j = k / <a class="code" href="magnetic_8h.html#a1b70272c1471e11b0484ffa27f815e17">MAGBUFFSIZEX</a>;</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;        i = k - j * <a class="code" href="magnetic_8h.html#a1b70272c1471e11b0484ffa27f815e17">MAGBUFFSIZEX</a>;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;        <span class="comment">// [10-9]: int16_t: ID of magnetic variable to be transmitted</span></div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;        <span class="comment">// ID 0 to 4 inclusive are magnetic calibration coefficients</span></div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;        <span class="comment">// ID 5 to 9 inclusive are for future expansion</span></div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;        <span class="comment">// ID 10 to (MAGBUFFSIZEX=12) * (MAGBUFFSIZEY=24)-1 or 10 to 10+288-1 are magnetic buffer elements</span></div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;        <span class="comment">// where the convention is used that a negative value indicates empty buffer element (index=-1)</span></div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;        <span class="keywordflow">if</span> ((MagneticPacketID &gt;= 10) &amp;&amp; (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#ad44d6aaf76570ad374ad7c170175de5a">MagBuffer</a>.<a class="code" href="structMagBuffer.html#a516ccae5ac2dac76ae40f1a3818bd853">index</a>[i][j] == -1))</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;        {</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;            <span class="comment">// use negative ID to indicate inactive magnetic buffer element</span></div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;            scratch16 = -MagneticPacketID;</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;            <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00615"></a><span class="lineno">  615</span>&#160;        }</div><div class="line"><a name="l00616"></a><span class="lineno">  616</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;        {</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;            <span class="comment">// use positive ID unchanged for variable or active magnetic buffer entry</span></div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;            scratch16 = MagneticPacketID;</div><div class="line"><a name="l00620"></a><span class="lineno">  620</span>&#160;            <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00621"></a><span class="lineno">  621</span>&#160;        }</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;        <span class="comment">// [12-11]: int16_t: variable 1 to be transmitted this iteration</span></div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;        <span class="comment">// [14-13]: int16_t: variable 2 to be transmitted this iteration</span></div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;        <span class="comment">// [16-15]: int16_t: variable 3 to be transmitted this iteration</span></div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;        <span class="keywordflow">switch</span> (MagneticPacketID)</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;        {</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;            <span class="keywordflow">case</span> 0:</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;                <span class="comment">// item 1: currently unused</span></div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;                scratch16 = 0;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;                <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;                <span class="comment">// item 2: currently unused</span></div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;                scratch16 = 0;</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;                <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;                <span class="comment">// item 3: magnetic inclination angle with resolution 0.1 deg</span></div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;                scratch16 = iDelta;</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;                <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;            <span class="keywordflow">case</span> 1:</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;                <span class="comment">// items 1 to 3: hard iron components range -3276uT to +3276uT encoded with 0.1uT resolution</span></div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;                scratch16 = (int16_t) (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#acf241c1ff86d307d296f560449acc2a4">MagCal</a>.<a class="code" href="structMagCalibration.html#a549982ae4ede950388c65e2f945cc372">fV</a>[<a class="code" href="sensor__fusion_8h.html#a48bbd27e913de8d7749dff9dec2fe816">CHX</a>] * 10.0F);</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;                <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;                scratch16 = (int16_t) (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#acf241c1ff86d307d296f560449acc2a4">MagCal</a>.<a class="code" href="structMagCalibration.html#a549982ae4ede950388c65e2f945cc372">fV</a>[<a class="code" href="sensor__fusion_8h.html#a6a25024f52cc6bea13d19f8b68456cea">CHY</a>] * 10.0F);</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                scratch16 = (int16_t) (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#acf241c1ff86d307d296f560449acc2a4">MagCal</a>.<a class="code" href="structMagCalibration.html#a549982ae4ede950388c65e2f945cc372">fV</a>[<a class="code" href="sensor__fusion_8h.html#a76143891435bdd7248857e45b93521ed">CHZ</a>] * 10.0F);</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;                <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;            <span class="keywordflow">case</span> 2:</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;                <span class="comment">// items 1 to 3: diagonal soft iron range -32. to +32. encoded with 0.001 resolution</span></div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;                scratch16 = (int16_t) (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#acf241c1ff86d307d296f560449acc2a4">MagCal</a>.<a class="code" href="structMagCalibration.html#aa6507fceb0291baedb7aaf19d84a73d6">finvW</a>[<a class="code" href="sensor__fusion_8h.html#a48bbd27e913de8d7749dff9dec2fe816">CHX</a>][<a class="code" href="sensor__fusion_8h.html#a48bbd27e913de8d7749dff9dec2fe816">CHX</a>] * 1000.0F);</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;                <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;                scratch16 = (int16_t) (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#acf241c1ff86d307d296f560449acc2a4">MagCal</a>.<a class="code" href="structMagCalibration.html#aa6507fceb0291baedb7aaf19d84a73d6">finvW</a>[<a class="code" href="sensor__fusion_8h.html#a6a25024f52cc6bea13d19f8b68456cea">CHY</a>][<a class="code" href="sensor__fusion_8h.html#a6a25024f52cc6bea13d19f8b68456cea">CHY</a>] * 1000.0F);</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;                <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;                scratch16 = (int16_t) (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#acf241c1ff86d307d296f560449acc2a4">MagCal</a>.<a class="code" href="structMagCalibration.html#aa6507fceb0291baedb7aaf19d84a73d6">finvW</a>[<a class="code" href="sensor__fusion_8h.html#a76143891435bdd7248857e45b93521ed">CHZ</a>][<a class="code" href="sensor__fusion_8h.html#a76143891435bdd7248857e45b93521ed">CHZ</a>] * 1000.0F);</div><div class="line"><a name="l00659"></a><span class="lineno">  659</span>&#160;                <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00660"></a><span class="lineno">  660</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;            <span class="keywordflow">case</span> 3:</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;                <span class="comment">// items 1 to 3: off-diagonal soft iron range -32. to +32. encoded with 0.001 resolution</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;                scratch16 = (int16_t) (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#acf241c1ff86d307d296f560449acc2a4">MagCal</a>.<a class="code" href="structMagCalibration.html#aa6507fceb0291baedb7aaf19d84a73d6">finvW</a>[CHX][CHY] * 1000.0F);</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;                <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;                scratch16 = (int16_t) (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#acf241c1ff86d307d296f560449acc2a4">MagCal</a>.<a class="code" href="structMagCalibration.html#aa6507fceb0291baedb7aaf19d84a73d6">finvW</a>[CHX][CHZ] * 1000.0F);</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;                <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;                scratch16 = (int16_t) (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#acf241c1ff86d307d296f560449acc2a4">MagCal</a>.<a class="code" href="structMagCalibration.html#aa6507fceb0291baedb7aaf19d84a73d6">finvW</a>[CHY][CHZ] * 1000.0F);</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;                <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;            <span class="keywordflow">case</span> 4:</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;            <span class="keywordflow">case</span> 5:</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;            <span class="keywordflow">case</span> 6:</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;            <span class="keywordflow">case</span> 7:</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;            <span class="keywordflow">case</span> 8:</div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;            <span class="keywordflow">case</span> 9:</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;                <span class="comment">// cases 4 to 9 inclusive are for future expansion so transmit zeroes for now</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                <a class="code" href="output__stream_8c.html#a93db92e775dee51c4dbf2dca2aed05b3">sBufAppendZeros</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, 3);</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;            <span class="keywordflow">default</span>:</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;                <span class="comment">// 10 and upwards: this handles the magnetic buffer elements</span></div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;                <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex,</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;                               (uint8_t *) &amp;(sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#ad44d6aaf76570ad374ad7c170175de5a">MagBuffer</a>.<a class="code" href="structMagBuffer.html#a9d168c941699f9628cc9c0af79b85032">iBs</a>[CHX][i][j]), 2);</div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;                <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex,</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;                               (uint8_t *) &amp;(sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#ad44d6aaf76570ad374ad7c170175de5a">MagBuffer</a>.<a class="code" href="structMagBuffer.html#a9d168c941699f9628cc9c0af79b85032">iBs</a>[CHY][i][j]), 2);</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;                <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex,</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;                               (uint8_t *) &amp;(sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#ad44d6aaf76570ad374ad7c170175de5a">MagBuffer</a>.<a class="code" href="structMagBuffer.html#a9d168c941699f9628cc9c0af79b85032">iBs</a>[CHZ][i][j]), 2);</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00691"></a><span class="lineno">  691</span>&#160;        }</div><div class="line"><a name="l00692"></a><span class="lineno">  692</span>&#160;</div><div class="line"><a name="l00693"></a><span class="lineno">  693</span>&#160;        <span class="comment">// wrap the variable ID back to zero if necessary</span></div><div class="line"><a name="l00694"></a><span class="lineno">  694</span>&#160;        MagneticPacketID++;</div><div class="line"><a name="l00695"></a><span class="lineno">  695</span>&#160;        <span class="keywordflow">if</span> (MagneticPacketID &gt;= (10 + MAGBUFFSIZEX * <a class="code" href="magnetic_8h.html#a9cda394198fba30f4e7aff9ee06e0677">MAGBUFFSIZEY</a>))</div><div class="line"><a name="l00696"></a><span class="lineno">  696</span>&#160;            MagneticPacketID = 0;</div><div class="line"><a name="l00697"></a><span class="lineno">  697</span>&#160;</div><div class="line"><a name="l00698"></a><span class="lineno">  698</span>&#160;        <span class="comment">// [17]: add the tail byte for the magnetic packet type 6</span></div><div class="line"><a name="l00699"></a><span class="lineno">  699</span>&#160;        <a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>[iIndex++] = 0x7E;</div><div class="line"><a name="l00700"></a><span class="lineno">  700</span>&#160;    }</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    <span class="comment">// *******************************************************************************</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="comment">// Kalman filter packet type 7</span></div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="comment">// total bytes for packet type 7 is range 0 to 41 inclusive = 42 bytes</span></div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="comment">// this packet is only transmitted when a Kalman algorithm is computed</span></div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="comment">// and then non-zero data is transmitted only when a Kalman quaternion is selected</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    <span class="comment">// *******************************************************************************</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="keywordtype">bool</span> kalman = <span class="keyword">false</span>;</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;<span class="preprocessor">#if F_6DOF_GY_KALMAN</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    uint8_t six_axis_kalman = (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#aef4363c6eab965a0a328ee2108572893">iFlags</a> &amp; <a class="code" href="standard__build_8h.html#a3aa2972ee6d1865b5bd7ab4e1914a4c5">F_6DOF_GY_KALMAN</a>) &amp;&amp; (quaternionPacketType == <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa59c8dc55b720396019ef93eb943a3b96">Q6AG</a>);</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;    kalman = six_axis_kalman;</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;<span class="preprocessor">#if F_9DOF_GBY_KALMAN</span></div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;    uint8_t nine_axis_kalman = (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#aef4363c6eab965a0a328ee2108572893">iFlags</a> &amp; <a class="code" href="standard__build_8h.html#a067a973335873757f5ecfda300e9c082">F_9DOF_GBY_KALMAN</a>) &amp;&amp; (quaternionPacketType == <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa9c5ceeb2bc9bf27379c7e72bc4d0ff13">Q9</a>);</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    kalman = kalman | nine_axis_kalman;</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;<span class="preprocessor">#if F_6DOF_GY_KALMAN || F_9DOF_GBY_KALMAN</span></div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;    <span class="keywordflow">if</span> (kalman)</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;    {</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <span class="keywordflow">if</span> ((quaternionPacketType == <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa59c8dc55b720396019ef93eb943a3b96">Q6AG</a>) || (quaternionPacketType == <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa9c5ceeb2bc9bf27379c7e72bc4d0ff13">Q9</a>))</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;        {</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;            <span class="comment">// [0]: packet start byte</span></div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;            <a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>[iIndex++] = 0x7E;</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;            <span class="comment">// [1]: packet type 7 byte</span></div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;            tmpuint8_t = 0x07;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;            <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, &amp;tmpuint8_t, 1);</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;            <span class="comment">// [2]: packet number byte</span></div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;            <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, &amp;iPacketNumber, 1);</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;            iPacketNumber++;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;            <span class="comment">// [4-3]: fzgErr[CHX] resolution scaled by 30000</span></div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;            <span class="comment">// [6-5]: fzgErr[CHY] resolution scaled by 30000</span></div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;            <span class="comment">// [8-7]: fzgErr[CHZ] resolution scaled by 30000</span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;            <span class="keywordflow">for</span> (i = CHX; i &lt;= <a class="code" href="sensor__fusion_8h.html#a76143891435bdd7248857e45b93521ed">CHZ</a>; i++)</div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;            {</div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;<span class="preprocessor">#if F_6DOF_GY_KALMAN</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;                <span class="keywordflow">if</span> (six_axis_kalman)    scratch16 = (int16_t) (sfg-&gt;SV_6DOF_GY_KALMAN.fZErr[i] * 30000.0F);</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;<span class="preprocessor">#if F_9DOF_GBY_KALMAN</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;                <span class="keywordflow">if</span> (nine_axis_kalman)   scratch16 = (int16_t) (sfg-&gt;SV_9DOF_GBY_KALMAN.fZErr[i] * 30000.0F);</div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;                <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16,2);</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;            }</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;            <span class="comment">// [10-9]: fgErrPl[CHX] resolution scaled by 30000</span></div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;            <span class="comment">// [12-11]: fgErrPl[CHY] resolution scaled by 30000</span></div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;            <span class="comment">// [14-13]: fgErrPl[CHZ] resolution scaled by 30000</span></div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;            <span class="keywordflow">for</span> (i = CHX; i &lt;= <a class="code" href="sensor__fusion_8h.html#a76143891435bdd7248857e45b93521ed">CHZ</a>; i++)</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;            {</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;<span class="preprocessor">#if F_6DOF_GY_KALMAN</span></div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;                <span class="keywordflow">if</span> (six_axis_kalman)    scratch16 = (int16_t) (sfg-&gt;SV_6DOF_GY_KALMAN.fqgErrPl[i] * 30000.0F);</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;<span class="preprocessor">#if F_9DOF_GBY_KALMAN</span></div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;                <span class="keywordflow">if</span> (nine_axis_kalman)   scratch16 = (int16_t) (sfg-&gt;SV_9DOF_GBY_KALMAN.fqgErrPl[i] * 30000.0F);</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;                <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16,2);</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;            }</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;            <span class="comment">// [16-15]: fzmErr[CHX] resolution scaled by 30000</span></div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;            <span class="comment">// [18-17]: fzmErr[CHY] resolution scaled by 30000</span></div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;            <span class="comment">// [20-19]: fzmErr[CHZ] resolution scaled by 30000</span></div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;            <span class="keywordflow">for</span> (i = CHX; i &lt;= <a class="code" href="sensor__fusion_8h.html#a76143891435bdd7248857e45b93521ed">CHZ</a>; i++)</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;            {</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;<span class="preprocessor">#if F_6DOF_GY_KALMAN</span></div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;                <span class="keywordflow">if</span> (six_axis_kalman)    scratch16 = 0;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;<span class="preprocessor">#if F_9DOF_GBY_KALMAN</span></div><div class="line"><a name="l00771"></a><span class="lineno">  771</span>&#160;                <span class="keywordflow">if</span> (nine_axis_kalman)   scratch16 = (int16_t) (sfg-&gt;SV_9DOF_GBY_KALMAN.fZErr[i + 3] * 30000.0F);</div><div class="line"><a name="l00772"></a><span class="lineno">  772</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;                <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;            }</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;</div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;            <span class="comment">// [22-21]: fmErrPl[CHX] resolution scaled by 30000</span></div><div class="line"><a name="l00777"></a><span class="lineno">  777</span>&#160;            <span class="comment">// [24-23]: fmErrPl[CHY] resolution scaled by 30000</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;            <span class="comment">// [26-25]: fmErrPl[CHZ] resolution scaled by 30000</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;            <span class="keywordflow">for</span> (i = CHX; i &lt;= <a class="code" href="sensor__fusion_8h.html#a76143891435bdd7248857e45b93521ed">CHZ</a>; i++)</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;            {</div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;<span class="preprocessor">#if F_6DOF_GY_KALMAN</span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;                <span class="keywordflow">if</span> (six_axis_kalman)    scratch16 = 0;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;<span class="preprocessor">#if F_9DOF_GBY_KALMAN</span></div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;                <span class="keywordflow">if</span> (nine_axis_kalman)   scratch16 = (int16_t) (sfg-&gt;SV_9DOF_GBY_KALMAN.fqmErrPl[i] * 30000.0F);</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;            }</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;            <span class="comment">// [28-27]: fbPl[CHX] resolution 0.001 deg/sec</span></div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;            <span class="comment">// [30-29]: fbPl[CHY] resolution 0.001 deg/sec</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;            <span class="comment">// [32-31]: fbPl[CHZ] resolution 0.001 deg/sec</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;            <span class="keywordflow">for</span> (i = CHX; i &lt;= <a class="code" href="sensor__fusion_8h.html#a76143891435bdd7248857e45b93521ed">CHZ</a>; i++)</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;            {</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;<span class="preprocessor">#if F_6DOF_GY_KALMAN</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;                <span class="keywordflow">if</span> (six_axis_kalman)    scratch16 = (int16_t) (sfg-&gt;SV_6DOF_GY_KALMAN.fbPl[i] * 1000.0F);</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;<span class="preprocessor">#if F_9DOF_GBY_KALMAN</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;                <span class="keywordflow">if</span> (nine_axis_kalman)   scratch16 = (int16_t) (sfg-&gt;SV_9DOF_GBY_KALMAN.fbPl[i] * 1000.0F);</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;            }</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;            <span class="comment">// [34-33]: fDeltaPl resolution 0.01deg</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;            scratch16 = 0;</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;<span class="preprocessor">#if F_9DOF_GBY_KALMAN</span></div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;            <span class="keywordflow">if</span> (nine_axis_kalman)       scratch16 = (int16_t) (sfg-&gt;SV_9DOF_GBY_KALMAN.fDeltaPl * 100.0F);</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;            <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;            <span class="comment">// [36-35]: fAccGl[CHX] resolution 1/8192 g</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;            <span class="comment">// [38-37]: fAccGl[CHY] resolution 1/8192 g</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;            <span class="comment">// [40-39]: fAccGl[CHZ] resolution 1/8192 g</span></div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;            <span class="keywordflow">for</span> (i = CHX; i &lt;= <a class="code" href="sensor__fusion_8h.html#a76143891435bdd7248857e45b93521ed">CHZ</a>; i++)</div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;            {</div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;                <span class="comment">// default to zero data</span></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;                ftmp = 0.0F;</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;<span class="preprocessor">#if F_6DOF_GY_KALMAN</span></div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;                <span class="keywordflow">if</span> (six_axis_kalman)    ftmp = sfg-&gt;SV_6DOF_GY_KALMAN.fAccGl[i] * 8192.0F;</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;<span class="preprocessor">#if F_9DOF_GBY_KALMAN</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;                <span class="keywordflow">if</span> (nine_axis_kalman)   ftmp = sfg-&gt;SV_9DOF_GBY_KALMAN.fAccGl[i] * 8192.0F;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;                <span class="comment">// check for clipping</span></div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;                <span class="keywordflow">if</span> (ftmp &gt; 32767.0F)            scratch16 = 32767;</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ftmp &lt; -32768.0F)      scratch16 = -32768;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;                <span class="keywordflow">else</span>                            scratch16 = (int16_t) ftmp;</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;                <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;            }</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;            <span class="comment">// [42-41]: fDisGl[CHX] resolution 0.01m</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;            <span class="comment">// [44-43]: fDisGl[CHY] resolution 0.01m</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;            <span class="comment">// [46-45]: fDisGl[CHZ] resolution 0.01m</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;            <span class="keywordflow">for</span> (i = CHX; i &lt;= <a class="code" href="sensor__fusion_8h.html#a76143891435bdd7248857e45b93521ed">CHZ</a>; i++)</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;            {</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;                <span class="comment">// default to zero data</span></div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;                ftmp = 0.0F;</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;<span class="preprocessor">#if F_9DOF_GBY_KALMAN</span></div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;                <span class="keywordflow">if</span> (nine_axis_kalman)   ftmp = sfg-&gt;SV_9DOF_GBY_KALMAN.fDisGl[i] * 100.0F;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;</div><div class="line"><a name="l00843"></a><span class="lineno">  843</span>&#160;                <span class="comment">// check for clipping</span></div><div class="line"><a name="l00844"></a><span class="lineno">  844</span>&#160;                <span class="keywordflow">if</span> (ftmp &gt; 32767.0F)            scratch16 = 32767;</div><div class="line"><a name="l00845"></a><span class="lineno">  845</span>&#160;                <span class="keywordflow">else</span> <span class="keywordflow">if</span> (ftmp &lt; -32768.0F)      scratch16 = -32768;</div><div class="line"><a name="l00846"></a><span class="lineno">  846</span>&#160;                <span class="keywordflow">else</span>                            scratch16 = (int16_t) ftmp;</div><div class="line"><a name="l00847"></a><span class="lineno">  847</span>&#160;                <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;            }</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;            <span class="comment">// [47]: add the tail byte for the Kalman packet type 7</span></div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;            <a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>[iIndex++] = 0x7E;</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;        }</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    }   <span class="comment">// end of check for Kalman packet</span></div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;<span class="preprocessor">#if F_USING_ACCEL</span></div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;    <span class="comment">// *************************************************************************</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;    <span class="comment">// fixed length packet type 8 transmitted whenever a precision accelerometer</span></div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;    <span class="comment">// measurement has been stored.</span></div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;    <span class="comment">// total size is 0 to 40 equals 41 bytes</span></div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;    <span class="comment">// *************************************************************************</span></div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;    <span class="comment">// check to see which packet (if any) is to be transmitted</span></div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;    <span class="keywordflow">if</span> (AccelCalPacketOn != -1)</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;    {</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;        <span class="comment">// [0]: packet start byte (need a iIndex++ here since not using sBufAppendItem)</span></div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        <a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>[iIndex++] = 0x7E;</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;        <span class="comment">// [1]: packet type 8 byte (iIndex is automatically updated in sBufAppendItem)</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;        tmpuint8_t = 0x08;</div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, &amp;tmpuint8_t, 1);</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;</div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;        <span class="comment">// [2]: packet number byte</span></div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, &amp;iPacketNumber, 1);</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        iPacketNumber++;</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;</div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        <span class="comment">// [3]: AccelCalPacketOn in range 0-11 denotes stored location and MAXORIENTATIONS denotes transmit</span></div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;        <span class="comment">// precision accelerometer calibration on power on before any measurements have been obtained.</span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex,</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;                       (uint8_t *) &amp;(AccelCalPacketOn), 1);</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        <span class="comment">// [9-4]: stored accelerometer measurement fGs (scaled to 8192 counts per g)</span></div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        <span class="keywordflow">if</span> ((AccelCalPacketOn &gt;= 0) &amp;&amp;</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;            (AccelCalPacketOn &lt; <a class="code" href="precisionAccelerometer_8h.html#a5ed11d7ac5361003e06a95d4f7a3fcb7">MAX_ACCEL_CAL_ORIENTATIONS</a>))</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        {</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;            scratch16 = (int16_t) (sfg-&gt;AccelBuffer.fGsStored[AccelCalPacketOn][CHX] * 8192.0F);</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;            <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;            scratch16 = (int16_t) (sfg-&gt;AccelBuffer.fGsStored[AccelCalPacketOn][CHY] * 8192.0F);</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;            <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;            scratch16 = (int16_t) (sfg-&gt;AccelBuffer.fGsStored[AccelCalPacketOn][CHZ] * 8192.0F);</div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;            <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;        }</div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;        {</div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;            <span class="comment">// transmit zero bytes since this is the power on or reset transmission of the precision calibration</span></div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;            <a class="code" href="output__stream_8c.html#a93db92e775dee51c4dbf2dca2aed05b3">sBufAppendZeros</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, 3);</div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;        }</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;        <span class="comment">// [15-10]: precision accelerometer offset vector fV (g scaled by 32768.0)</span></div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;        scratch16 = (int16_t) (sfg-&gt;AccelCal.fV[CHX] * 32768.0F);</div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        scratch16 = (int16_t) (sfg-&gt;AccelCal.fV[CHY] * 32768.0F);</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;        scratch16 = (int16_t) (sfg-&gt;AccelCal.fV[CHZ] * 32768.0F);</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        <span class="comment">// [21-16]: precision accelerometer inverse gain matrix diagonal finvW - 1.0 (scaled by 10000.0)</span></div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        scratch16 = (int16_t) ((sfg-&gt;AccelCal.finvW[CHX][CHX] - 1.0F) * 10000.0F);</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;        scratch16 = (int16_t) ((sfg-&gt;AccelCal.finvW[CHY][CHY] - 1.0F) * 10000.0F);</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;        scratch16 = (int16_t) ((sfg-&gt;AccelCal.finvW[CHZ][CHZ] - 1.0F) * 10000.0F);</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;</div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;        <span class="comment">// [27-22]: precision accelerometer inverse gain matrix off-diagonal finvW (scaled by 10000)</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;        scratch16 = (int16_t) (sfg-&gt;AccelCal.finvW[CHX][CHY] * 10000.0F);</div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        scratch16 = (int16_t) (sfg-&gt;AccelCal.finvW[CHX][CHZ] * 10000.0F);</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;        scratch16 = (int16_t) (sfg-&gt;AccelCal.finvW[CHY][CHZ] * 10000.0F);</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        <span class="comment">// [33-28]: precision accelerometer rotation matrix diagonal fR0 (scaled by 10000)</span></div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;        scratch16 = (int16_t) (sfg-&gt;AccelCal.fR0[CHX][CHX] * 10000.0F);</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;        scratch16 = (int16_t) (sfg-&gt;AccelCal.fR0[CHY][CHY] * 10000.0F);</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;        scratch16 = (int16_t) (sfg-&gt;AccelCal.fR0[CHZ][CHZ] * 10000.0F);</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;</div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;        <span class="comment">// [45-34]: precision accelerometer inverse rotation matrix off-diagonal fR0 (scaled by 10000)</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;        scratch16 = (int16_t) (sfg-&gt;AccelCal.fR0[CHX][CHY] * 10000.0F);</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;        scratch16 = (int16_t) (sfg-&gt;AccelCal.fR0[CHX][CHZ] * 10000.0F);</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;        scratch16 = (int16_t) (sfg-&gt;AccelCal.fR0[CHY][CHX] * 10000.0F);</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;        scratch16 = (int16_t) (sfg-&gt;AccelCal.fR0[CHY][CHZ] * 10000.0F);</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;        scratch16 = (int16_t) (sfg-&gt;AccelCal.fR0[CHZ][CHX] * 10000.0F);</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;        scratch16 = (int16_t) (sfg-&gt;AccelCal.fR0[CHZ][CHY] * 10000.0F);</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;        <a class="code" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a>(<a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, &amp;iIndex, (uint8_t *) &amp;scratch16, 2);</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;        <span class="comment">// [46]: add the tail byte for the packet type 8</span></div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;        <a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>[iIndex++] = 0x7E;</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;        <span class="comment">// disable future packets of this type until a new measurement has been obtained</span></div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;        sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a51cbe943cdee0fd0a2ff72d2a04fad9a">pControlSubsystem</a>-&gt;<a class="code" href="structControlSubsystem.html#aa62f07fac570bf67c0832d4bf7d38e76">AccelCalPacketOn</a> = -1;</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;    }</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;<span class="preprocessor">#endif  // F_USING_ACCEL</span></div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;    <span class="comment">// ********************************************************************************</span></div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    <span class="comment">// all packets have now been constructed in the output buffer so now transmit.</span></div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;    <span class="comment">// The final iIndex++ gives the number of bytes to transmit which is one more than</span></div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;    <span class="comment">// the last index in the buffer. this function is non-blocking</span></div><div class="line"><a name="l00954"></a><span class="lineno">  954</span>&#160;    <span class="comment">// ********************************************************************************</span></div><div class="line"><a name="l00955"></a><span class="lineno">  955</span>&#160;    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a51cbe943cdee0fd0a2ff72d2a04fad9a">pControlSubsystem</a>-&gt;<a class="code" href="structControlSubsystem.html#a8c91c6fe2a5725abe8944b06e46041a5">write</a>(sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a51cbe943cdee0fd0a2ff72d2a04fad9a">pControlSubsystem</a>, <a class="code" href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a>, iIndex);</div><div class="line"><a name="l00956"></a><span class="lineno">  956</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00957"></a><span class="lineno">  957</span>&#160;}</div><div class="ttc" id="sensor__fusion_8h_html_ad1d4d649bfa88f655f8f2d1ee5ae5ace"><div class="ttname"><a href="sensor__fusion_8h.html#ad1d4d649bfa88f655f8f2d1ee5ae5ace">quaternion_type</a></div><div class="ttdeci">enum quaternion quaternion_type</div><div class="ttdoc">the quaternion type to be transmitted </div></div>
<div class="ttc" id="sensor__fusion_8h_html_a5f469312b3865f2d3efea2edd6f8afaaa9c5ceeb2bc9bf27379c7e72bc4d0ff13"><div class="ttname"><a href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa9c5ceeb2bc9bf27379c7e72bc4d0ff13">Q9</a></div><div class="ttdoc">Quaternion derived from full 9-axis sensor fusion. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00070">sensor_fusion.h:70</a></div></div>
<div class="ttc" id="magnetic_8h_html_a1b70272c1471e11b0484ffa27f815e17"><div class="ttname"><a href="magnetic_8h.html#a1b70272c1471e11b0484ffa27f815e17">MAGBUFFSIZEX</a></div><div class="ttdeci">#define MAGBUFFSIZEX</div><div class="ttdoc">x dimension in magnetometer buffer (12x24 equals 288 elements) </div><div class="ttdef"><b>Definition:</b> <a href="magnetic_8h_source.html#l00044">magnetic.h:44</a></div></div>
<div class="ttc" id="standard__build_8h_html_aecf1505d7dbaa2569dd3f36bf05ab5a0"><div class="ttname"><a href="standard__build_8h.html#aecf1505d7dbaa2569dd3f36bf05ab5a0">F_USING_GYRO</a></div><div class="ttdeci">#define F_USING_GYRO</div><div class="ttdoc">nominally 0x0004 if a gyro is to be used, 0x0000 otherwise </div><div class="ttdef"><b>Definition:</b> <a href="standard__build_8h_source.html#l00057">standard_build.h:57</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_a6a25024f52cc6bea13d19f8b68456cea"><div class="ttname"><a href="sensor__fusion_8h.html#a6a25024f52cc6bea13d19f8b68456cea">CHY</a></div><div class="ttdeci">#define CHY</div><div class="ttdoc">Used to access Y-channel entries in various data data structures. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00077">sensor_fusion.h:77</a></div></div>
<div class="ttc" id="output__stream_8c_html_a96da70ac128170ff0d03feffa05ef769"><div class="ttname"><a href="output__stream_8c.html#a96da70ac128170ff0d03feffa05ef769">readCommon</a></div><div class="ttdeci">void readCommon(SV_ptr data, Quaternion *fq, int16_t *iPhi, int16_t *iThe, int16_t *iRho, int16_t iOmega[], uint16_t *isystick)</div><div class="ttdef"><b>Definition:</b> <a href="output__stream_8c_source.html#l00100">output_stream.c:100</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_aef4363c6eab965a0a328ee2108572893"><div class="ttname"><a href="structSensorFusionGlobals.html#aef4363c6eab965a0a328ee2108572893">SensorFusionGlobals::iFlags</a></div><div class="ttdeci">uint32_t iFlags</div><div class="ttdoc">a bit-field of sensors and algorithms used </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00480">sensor_fusion.h:480</a></div></div>
<div class="ttc" id="structQuaternion_html_a27b8f713c4a449fb2fbb1cbdb3a1e149"><div class="ttname"><a href="structQuaternion.html#a27b8f713c4a449fb2fbb1cbdb3a1e149">Quaternion::q0</a></div><div class="ttdeci">float q0</div><div class="ttdoc">scalar component </div><div class="ttdef"><b>Definition:</b> <a href="orientation_8h_source.html#l00039">orientation.h:39</a></div></div>
<div class="ttc" id="structControlSubsystem_html_af46ef3a1af714f7d40707053964db4a8"><div class="ttname"><a href="structControlSubsystem.html#af46ef3a1af714f7d40707053964db4a8">ControlSubsystem::AltPacketOn</a></div><div class="ttdeci">volatile uint8_t AltPacketOn</div><div class="ttdoc">flag to enable altitude packet </div><div class="ttdef"><b>Definition:</b> <a href="control_8h_source.html#l00070">control.h:70</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_a5f469312b3865f2d3efea2edd6f8afaaada2dae63d5865a8446caa7938c73c5dc"><div class="ttname"><a href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaada2dae63d5865a8446caa7938c73c5dc">Q3M</a></div><div class="ttdoc">Quaternion derived from 3-axis mag only (auto compass algorithm) </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00066">sensor_fusion.h:66</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_acf241c1ff86d307d296f560449acc2a4"><div class="ttname"><a href="structSensorFusionGlobals.html#acf241c1ff86d307d296f560449acc2a4">SensorFusionGlobals::MagCal</a></div><div class="ttdeci">MagCalibration MagCal</div><div class="ttdoc">mag cal storage </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00503">sensor_fusion.h:503</a></div></div>
<div class="ttc" id="structControlSubsystem_html_aa62f07fac570bf67c0832d4bf7d38e76"><div class="ttname"><a href="structControlSubsystem.html#aa62f07fac570bf67c0832d4bf7d38e76">ControlSubsystem::AccelCalPacketOn</a></div><div class="ttdeci">volatile int8_t AccelCalPacketOn</div><div class="ttdoc">variable used to coordinate accelerometer calibration </div><div class="ttdef"><b>Definition:</b> <a href="control_8h_source.html#l00071">control.h:71</a></div></div>
<div class="ttc" id="structQuaternion_html_aa92940755b1370321ed489e6f2448ad9"><div class="ttname"><a href="structQuaternion.html#aa92940755b1370321ed489e6f2448ad9">Quaternion::q3</a></div><div class="ttdeci">float q3</div><div class="ttdoc">z vector component </div><div class="ttdef"><b>Definition:</b> <a href="orientation_8h_source.html#l00042">orientation.h:42</a></div></div>
<div class="ttc" id="structMagBuffer_html_a3cf587e6fce57898d9d4977239462406"><div class="ttname"><a href="structMagBuffer.html#a3cf587e6fce57898d9d4977239462406">MagBuffer::iMagBufferCount</a></div><div class="ttdeci">int16_t iMagBufferCount</div><div class="ttdoc">number of magnetometer readings </div><div class="ttdef"><b>Definition:</b> <a href="magnetic_8h_source.html#l00068">magnetic.h:68</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_a5f469312b3865f2d3efea2edd6f8afaaaf63c9f6fec59717499a84048f682cf8a"><div class="ttname"><a href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaaf63c9f6fec59717499a84048f682cf8a">Q3G</a></div><div class="ttdoc">Quaternion derived from 3-axis gyro only (rotation) </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00067">sensor_fusion.h:67</a></div></div>
<div class="ttc" id="structMagSensor_html_a8d14850aea4f6f78343db74f3208f5d0"><div class="ttname"><a href="structMagSensor.html#a8d14850aea4f6f78343db74f3208f5d0">MagSensor::iCountsPeruT</a></div><div class="ttdeci">int16_t iCountsPeruT</div><div class="ttdoc">counts per uT </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00241">sensor_fusion.h:241</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_a5f469312b3865f2d3efea2edd6f8afaaa0cf62dda224dcbac09ae26cd46ccce01"><div class="ttname"><a href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa0cf62dda224dcbac09ae26cd46ccce01">Q6MA</a></div><div class="ttdoc">Quaternion derived from 3-axis accel + 3 axis mag (eCompass) </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00068">sensor_fusion.h:68</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_a5f469312b3865f2d3efea2edd6f8afaaa59c8dc55b720396019ef93eb943a3b96"><div class="ttname"><a href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa59c8dc55b720396019ef93eb943a3b96">Q6AG</a></div><div class="ttdoc">Quaternion derived from 3-axis accel + 3-axis gyro (gaming) </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00069">sensor_fusion.h:69</a></div></div>
<div class="ttc" id="output__stream_8c_html_a16d1508470294835d76682195104898e"><div class="ttname"><a href="output__stream_8c.html#a16d1508470294835d76682195104898e">throttle</a></div><div class="ttdeci">uint16_t throttle()</div><div class="ttdoc">(OVERSAMPLE_RATIO * MAXPACKETRATEHZ) / SENSORFS </div><div class="ttdef"><b>Definition:</b> <a href="output__stream_8c_source.html#l00119">output_stream.c:119</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_a51cbe943cdee0fd0a2ff72d2a04fad9a"><div class="ttname"><a href="structSensorFusionGlobals.html#a51cbe943cdee0fd0a2ff72d2a04fad9a">SensorFusionGlobals::pControlSubsystem</a></div><div class="ttdeci">struct ControlSubsystem * pControlSubsystem</div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00475">sensor_fusion.h:475</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_a876af8fddc05153d04bda2d8a8107819"><div class="ttname"><a href="structSensorFusionGlobals.html#a876af8fddc05153d04bda2d8a8107819">SensorFusionGlobals::Mag</a></div><div class="ttdeci">MagSensor Mag</div><div class="ttdoc">magnetometer storage </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00492">sensor_fusion.h:492</a></div></div>
<div class="ttc" id="structQuaternion_html"><div class="ttname"><a href="structQuaternion.html">Quaternion</a></div><div class="ttdoc">quaternion structure definition </div><div class="ttdef"><b>Definition:</b> <a href="orientation_8h_source.html#l00037">orientation.h:37</a></div></div>
<div class="ttc" id="standard__build_8h_html_a69b745acfd24d1873d47c67aca06df26"><div class="ttname"><a href="standard__build_8h.html#a69b745acfd24d1873d47c67aca06df26">F_1DOF_P_BASIC</a></div><div class="ttdeci">#define F_1DOF_P_BASIC</div><div class="ttdoc">1DOF pressure (altitude) and temperature algorithm selector - 0x0100 to include, 0x0000 otherwise ...</div><div class="ttdef"><b>Definition:</b> <a href="standard__build_8h_source.html#l00067">standard_build.h:67</a></div></div>
<div class="ttc" id="standard__build_8h_html_a067a973335873757f5ecfda300e9c082"><div class="ttname"><a href="standard__build_8h.html#a067a973335873757f5ecfda300e9c082">F_9DOF_GBY_KALMAN</a></div><div class="ttdeci">#define F_9DOF_GBY_KALMAN</div></div>
<div class="ttc" id="output__stream_8c_html_a7ad6e53b35d6fc860a1299ceff40a299"><div class="ttname"><a href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299">sBufAppendItem</a></div><div class="ttdeci">void sBufAppendItem(uint8_t *pDest, uint16_t *pIndex, uint8_t *pSource, uint16_t iBytesToCopy)</div><div class="ttdoc">Utility function used to place data in output buffer about to be transmitted via UART. </div><div class="ttdef"><b>Definition:</b> <a href="output__stream_8c_source.html#l00059">output_stream.c:59</a></div></div>
<div class="ttc" id="structMagCalibration_html_aa6507fceb0291baedb7aaf19d84a73d6"><div class="ttname"><a href="structMagCalibration.html#aa6507fceb0291baedb7aaf19d84a73d6">MagCalibration::finvW</a></div><div class="ttdeci">float finvW[3][3]</div><div class="ttdoc">current inverse soft iron matrix </div><div class="ttdef"><b>Definition:</b> <a href="magnetic_8h_source.html#l00076">magnetic.h:76</a></div></div>
<div class="ttc" id="standard__build_8h_html_a37b68379c938c8404e8e8b0572e7a530"><div class="ttname"><a href="standard__build_8h.html#a37b68379c938c8404e8e8b0572e7a530">THISBUILD</a></div><div class="ttdeci">#define THISBUILD</div><div class="ttdoc">define build number sent in debug packet for display purposes only </div><div class="ttdef"><b>Definition:</b> <a href="standard__build_8h_source.html#l00038">standard_build.h:38</a></div></div>
<div class="ttc" id="structMagCalibration_html_a549982ae4ede950388c65e2f945cc372"><div class="ttname"><a href="structMagCalibration.html#a549982ae4ede950388c65e2f945cc372">MagCalibration::fV</a></div><div class="ttdeci">float fV[3]</div><div class="ttdoc">current hard iron offset x, y, z, (uT) </div><div class="ttdef"><b>Definition:</b> <a href="magnetic_8h_source.html#l00075">magnetic.h:75</a></div></div>
<div class="ttc" id="standard__build_8h_html_a3aa2972ee6d1865b5bd7ab4e1914a4c5"><div class="ttname"><a href="standard__build_8h.html#a3aa2972ee6d1865b5bd7ab4e1914a4c5">F_6DOF_GY_KALMAN</a></div><div class="ttdeci">#define F_6DOF_GY_KALMAN</div><div class="ttdoc">6DOF accel and gyro (Kalman) algorithm selector - 0x2000 to include, 0x0000 otherwise ...</div><div class="ttdef"><b>Definition:</b> <a href="standard__build_8h_source.html#l00072">standard_build.h:72</a></div></div>
<div class="ttc" id="standard__build_8h_html_adb79fa7eb529c4cae2619ef22af3211e"><div class="ttname"><a href="standard__build_8h.html#adb79fa7eb529c4cae2619ef22af3211e">F_3DOF_G_BASIC</a></div><div class="ttdeci">#define F_3DOF_G_BASIC</div><div class="ttdoc">3DOF accel tilt (accel) algorithm selector - 0x0200 to include, 0x0000 otherwise </div><div class="ttdef"><b>Definition:</b> <a href="standard__build_8h_source.html#l00068">standard_build.h:68</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_a76143891435bdd7248857e45b93521ed"><div class="ttname"><a href="sensor__fusion_8h.html#a76143891435bdd7248857e45b93521ed">CHZ</a></div><div class="ttdeci">#define CHZ</div></div>
<div class="ttc" id="control_8c_html_a3b6c71dda245dccb73352c7264176527"><div class="ttname"><a href="control_8c.html#a3b6c71dda245dccb73352c7264176527">sUARTOutputBuffer</a></div><div class="ttdeci">uint8_t sUARTOutputBuffer[256]</div><div class="ttdoc">main output buffer defined in control.c </div><div class="ttdef"><b>Definition:</b> <a href="control_8c_source.html#l00059">control.c:59</a></div></div>
<div class="ttc" id="structControlSubsystem_html_a41ad90f99ac3c14b2bdce3967df14f1b"><div class="ttname"><a href="structControlSubsystem.html#a41ad90f99ac3c14b2bdce3967df14f1b">ControlSubsystem::DebugPacketOn</a></div><div class="ttdeci">volatile uint8_t DebugPacketOn</div><div class="ttdoc">flag to enable debug packet </div><div class="ttdef"><b>Definition:</b> <a href="control_8h_source.html#l00068">control.h:68</a></div></div>
<div class="ttc" id="precisionAccelerometer_8h_html_a5ed11d7ac5361003e06a95d4f7a3fcb7"><div class="ttname"><a href="precisionAccelerometer_8h.html#a5ed11d7ac5361003e06a95d4f7a3fcb7">MAX_ACCEL_CAL_ORIENTATIONS</a></div><div class="ttdeci">#define MAX_ACCEL_CAL_ORIENTATIONS</div><div class="ttdoc">number of stored precision accelerometer measurements </div><div class="ttdef"><b>Definition:</b> <a href="precisionAccelerometer_8h_source.html#l00035">precisionAccelerometer.h:35</a></div></div>
<div class="ttc" id="structMagSensor_html_a8a3b181bc80ba70aa8e9741c6a4b8320"><div class="ttname"><a href="structMagSensor.html#a8a3b181bc80ba70aa8e9741c6a4b8320">MagSensor::iBc</a></div><div class="ttdeci">int16_t iBc[3]</div><div class="ttdoc">averaged calibrated measurement (counts) </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00240">sensor_fusion.h:240</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_a48bbd27e913de8d7749dff9dec2fe816"><div class="ttname"><a href="sensor__fusion_8h.html#a48bbd27e913de8d7749dff9dec2fe816">CHX</a></div><div class="ttdeci">#define CHX</div><div class="ttdoc">Used to access X-channel entries in various data data structures. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00076">sensor_fusion.h:76</a></div></div>
<div class="ttc" id="structMagCalibration_html_aed673fe73dd32922ee873849472dfe71"><div class="ttname"><a href="structMagCalibration.html#aed673fe73dd32922ee873849472dfe71">MagCalibration::fFitErrorpc</a></div><div class="ttdeci">float fFitErrorpc</div><div class="ttdoc">current fit error % </div><div class="ttdef"><b>Definition:</b> <a href="magnetic_8h_source.html#l00079">magnetic.h:79</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_ad44d6aaf76570ad374ad7c170175de5a"><div class="ttname"><a href="structSensorFusionGlobals.html#ad44d6aaf76570ad374ad7c170175de5a">SensorFusionGlobals::MagBuffer</a></div><div class="ttdeci">MagBuffer MagBuffer</div><div class="ttdoc">mag cal constellation points </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00504">sensor_fusion.h:504</a></div></div>
<div class="ttc" id="structControlSubsystem_html_a8c91c6fe2a5725abe8944b06e46041a5"><div class="ttname"><a href="structControlSubsystem.html#a8c91c6fe2a5725abe8944b06e46041a5">ControlSubsystem::write</a></div><div class="ttdeci">writePort_t * write</div><div class="ttdoc">low level function to write a char buffer to the serial stream </div><div class="ttdef"><b>Definition:</b> <a href="control_8h_source.html#l00072">control.h:72</a></div></div>
<div class="ttc" id="structControlSubsystem_html_a6c5365ebe170e2ee207212da7531ccea"><div class="ttname"><a href="structControlSubsystem.html#a6c5365ebe170e2ee207212da7531ccea">ControlSubsystem::RPCPacketOn</a></div><div class="ttdeci">volatile uint8_t RPCPacketOn</div><div class="ttdoc">flag to enable roll, pitch, compass packet </div><div class="ttdef"><b>Definition:</b> <a href="control_8h_source.html#l00069">control.h:69</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_a5f469312b3865f2d3efea2edd6f8afaaa19bd87b11e82b9047ad750fb62711ba8"><div class="ttname"><a href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa19bd87b11e82b9047ad750fb62711ba8">Q3</a></div><div class="ttdoc">Quaternion derived from 3-axis accel (tilt) </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00065">sensor_fusion.h:65</a></div></div>
<div class="ttc" id="standard__build_8h_html_a990887d9ed9f03bcaffcd4abae429265"><div class="ttname"><a href="standard__build_8h.html#a990887d9ed9f03bcaffcd4abae429265">F_3DOF_Y_BASIC</a></div><div class="ttdeci">#define F_3DOF_Y_BASIC</div><div class="ttdoc">3DOF gyro integration algorithm selector - 0x0800 to include, 0x0000 otherwise </div><div class="ttdef"><b>Definition:</b> <a href="standard__build_8h_source.html#l00070">standard_build.h:70</a></div></div>
<div class="ttc" id="standard__build_8h_html_a9b0aadad0b960783ff2ecd5174a57905"><div class="ttname"><a href="standard__build_8h.html#a9b0aadad0b960783ff2ecd5174a57905">F_6DOF_GB_BASIC</a></div><div class="ttdeci">#define F_6DOF_GB_BASIC</div><div class="ttdoc">6DOF accel and mag eCompass algorithm selector - 0x1000 to include, 0x0000 otherwise ...</div><div class="ttdef"><b>Definition:</b> <a href="standard__build_8h_source.html#l00071">standard_build.h:71</a></div></div>
<div class="ttc" id="standard__build_8h_html_a470d8d33fe0efafcc0c0835fbea14f5e"><div class="ttname"><a href="standard__build_8h.html#a470d8d33fe0efafcc0c0835fbea14f5e">FUSION_HZ</a></div><div class="ttdeci">#define FUSION_HZ</div><div class="ttdoc">(int) actual rate of fusion algorithm execution and sensor FIFO reads </div><div class="ttdef"><b>Definition:</b> <a href="standard__build_8h_source.html#l00085">standard_build.h:85</a></div></div>
<div class="ttc" id="structMagBuffer_html_a516ccae5ac2dac76ae40f1a3818bd853"><div class="ttname"><a href="structMagBuffer.html#a516ccae5ac2dac76ae40f1a3818bd853">MagBuffer::index</a></div><div class="ttdeci">int32_t index[MAGBUFFSIZEX][MAGBUFFSIZEY]</div><div class="ttdoc">array of time indices </div><div class="ttdef"><b>Definition:</b> <a href="magnetic_8h_source.html#l00066">magnetic.h:66</a></div></div>
<div class="ttc" id="output__stream_8c_html_a93db92e775dee51c4dbf2dca2aed05b3"><div class="ttname"><a href="output__stream_8c.html#a93db92e775dee51c4dbf2dca2aed05b3">sBufAppendZeros</a></div><div class="ttdeci">void sBufAppendZeros(uint8_t *pDest, uint16_t *pIndex, uint16_t numZeros)</div><div class="ttdef"><b>Definition:</b> <a href="output__stream_8c_source.html#l00092">output_stream.c:92</a></div></div>
<div class="ttc" id="structMagCalibration_html_a70d5d3dc1013e238e1d623e67332d87c"><div class="ttname"><a href="structMagCalibration.html#a70d5d3dc1013e238e1d623e67332d87c">MagCalibration::fB</a></div><div class="ttdeci">float fB</div><div class="ttdoc">current geomagnetic field magnitude (uT) </div><div class="ttdef"><b>Definition:</b> <a href="magnetic_8h_source.html#l00077">magnetic.h:77</a></div></div>
<div class="ttc" id="standard__build_8h_html_a8f284d04ec459633d30dc85cf0a32a0d"><div class="ttname"><a href="standard__build_8h.html#a8f284d04ec459633d30dc85cf0a32a0d">F_USING_ACCEL</a></div><div class="ttdeci">#define F_USING_ACCEL</div><div class="ttdoc">nominally 0x0001 if an accelerometer is to be used, 0x0000 otherwise </div><div class="ttdef"><b>Definition:</b> <a href="standard__build_8h_source.html#l00055">standard_build.h:55</a></div></div>
<div class="ttc" id="magnetic_8h_html_a9cda394198fba30f4e7aff9ee06e0677"><div class="ttname"><a href="magnetic_8h.html#a9cda394198fba30f4e7aff9ee06e0677">MAGBUFFSIZEY</a></div><div class="ttdeci">#define MAGBUFFSIZEY</div><div class="ttdoc">y dimension in magnetometer buffer (12x24 equals 288 elements) </div><div class="ttdef"><b>Definition:</b> <a href="magnetic_8h_source.html#l00045">magnetic.h:45</a></div></div>
<div class="ttc" id="structQuaternion_html_afddca3451c589f7b5928b6dccf8c88ba"><div class="ttname"><a href="structQuaternion.html#afddca3451c589f7b5928b6dccf8c88ba">Quaternion::q2</a></div><div class="ttdeci">float q2</div><div class="ttdoc">y vector component </div><div class="ttdef"><b>Definition:</b> <a href="orientation_8h_source.html#l00041">orientation.h:41</a></div></div>
<div class="ttc" id="standard__build_8h_html_aed8da52c8d0d14325445b139876492b4"><div class="ttname"><a href="standard__build_8h.html#aed8da52c8d0d14325445b139876492b4">F_3DOF_B_BASIC</a></div><div class="ttdeci">#define F_3DOF_B_BASIC</div><div class="ttdoc">3DOF mag eCompass (vehicle/mag) algorithm selector - 0x0400 to include, 0x0000 otherwise ...</div><div class="ttdef"><b>Definition:</b> <a href="standard__build_8h_source.html#l00069">standard_build.h:69</a></div></div>
<div class="ttc" id="structSV__COMMON_html"><div class="ttname"><a href="structSV__COMMON.html">SV_COMMON</a></div><div class="ttdoc">Excluding SV_1DOF_P_BASIC, Any of the SV_ fusion structures above could be cast to type SV_COMMON for...</div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00448">sensor_fusion.h:448</a></div></div>
<div class="ttc" id="magnetic_8h_html_a78765407e471fe0b9119e5ff41aa7d16"><div class="ttname"><a href="magnetic_8h.html#a78765407e471fe0b9119e5ff41aa7d16">F_USING_MAG</a></div><div class="ttdeci">#define F_USING_MAG</div><div class="ttdef"><b>Definition:</b> <a href="magnetic_8h_source.html#l00038">magnetic.h:38</a></div></div>
<div class="ttc" id="structQuaternion_html_a209c65446ca302d32cbb908c4d75f616"><div class="ttname"><a href="structQuaternion.html#a209c65446ca302d32cbb908c4d75f616">Quaternion::q1</a></div><div class="ttdeci">float q1</div><div class="ttdoc">x vector component </div><div class="ttdef"><b>Definition:</b> <a href="orientation_8h_source.html#l00040">orientation.h:40</a></div></div>
<div class="ttc" id="structMagBuffer_html_a9d168c941699f9628cc9c0af79b85032"><div class="ttname"><a href="structMagBuffer.html#a9d168c941699f9628cc9c0af79b85032">MagBuffer::iBs</a></div><div class="ttdeci">int16_t iBs[3][MAGBUFFSIZEX][MAGBUFFSIZEY]</div><div class="ttdoc">uncalibrated magnetometer readings </div><div class="ttdef"><b>Definition:</b> <a href="magnetic_8h_source.html#l00065">magnetic.h:65</a></div></div>
<div class="ttc" id="structControlSubsystem_html_a560615429c69fcefa85de0624fa6d83e"><div class="ttname"><a href="structControlSubsystem.html#a560615429c69fcefa85de0624fa6d83e">ControlSubsystem::QuaternionPacketType</a></div><div class="ttdeci">volatile quaternion_type QuaternionPacketType</div><div class="ttdoc">quaternion type transmitted over UART </div><div class="ttdef"><b>Definition:</b> <a href="control_8h_source.html#l00066">control.h:66</a></div></div>
<div class="ttc" id="structControlSubsystem_html_a527b159143188ef9b66bd4c8a6aefcdf"><div class="ttname"><a href="structControlSubsystem.html#a527b159143188ef9b66bd4c8a6aefcdf">ControlSubsystem::AngularVelocityPacketOn</a></div><div class="ttdeci">volatile uint8_t AngularVelocityPacketOn</div><div class="ttdoc">flag to enable angular velocity packet </div><div class="ttdef"><b>Definition:</b> <a href="control_8h_source.html#l00067">control.h:67</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="control_8h_adbb4129e795ca534e4bb1649bb81b559_cgraph.png" border="0" usemap="#control_8h_adbb4129e795ca534e4bb1649bb81b559_cgraph" alt=""/></div>
<map name="control_8h_adbb4129e795ca534e4bb1649bb81b559_cgraph" id="control_8h_adbb4129e795ca534e4bb1649bb81b559_cgraph">
<area shape="rect" id="node2" href="output__stream_8c.html#a16d1508470294835d76682195104898e" title="(OVERSAMPLE_RATIO * MAXPACKETRATEHZ) / SENSORFS " alt="" coords="245,5,308,32"/>
<area shape="rect" id="node3" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299" title="Utility function used to place data in output buffer about to be transmitted via UART. " alt="" coords="387,81,504,108"/>
<area shape="rect" id="node4" href="output__stream_8c.html#a93db92e775dee51c4dbf2dca2aed05b3" title="sBufAppendZeros" alt="" coords="215,107,339,133"/>
<area shape="rect" id="node5" href="output__stream_8c.html#a96da70ac128170ff0d03feffa05ef769" title="readCommon" alt="" coords="227,157,326,184"/>
</map>
</div>
</p>

<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="control_8h_adbb4129e795ca534e4bb1649bb81b559_icgraph.png" border="0" usemap="#control_8h_adbb4129e795ca534e4bb1649bb81b559_icgraph" alt=""/></div>
<map name="control_8h_adbb4129e795ca534e4bb1649bb81b559_icgraph" id="control_8h_adbb4129e795ca534e4bb1649bb81b559_icgraph">
<area shape="rect" id="node2" href="control_8h.html#a67029acf1be9712c5d30c625132ad958" title="Call this once to initialize structures, ports, etc. " alt="" coords="215,5,349,32"/>
<area shape="rect" id="node3" href="main__agm01__freertos__two__tasks_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="This is a FreeRTOS (dual task) implementation of the NXP sensor fusion demo build. " alt="" coords="397,5,448,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2d80b68d03de87c2d3cce67273f8a165"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void DecodeCommandBytes </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSensorFusionGlobals.html">SensorFusionGlobals</a> *&#160;</td>
          <td class="paramname"><em>sfg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">char&#160;</td>
          <td class="paramname"><em>iCommandBuffer</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sensor__fusion_8h.html#a33a5e996e7a90acefb8b1c0bea47e365">uint8</a>&#160;</td>
          <td class="paramname"><em>sUART_InputBuffer</em>[], </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sensor__fusion_8h.html#ac2a9e79eb120216f855626495b7bd18a">uint16</a>&#160;</td>
          <td class="paramname"><em>nbytes</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is responsible for decoding commands sent by the NXP Sensor Fusion Toolbox and setting the appropriate flags in the <a class="el" href="structControlSubsystem.html" title="he ControlSubsystem encapsulates command and data streaming functions. ">ControlSubsystem</a> data structure. Packet protocols are defined in the NXP Sensor Fusion for Kinetis Product Development Kit User Guide. </p>

<p>Definition at line <a class="el" href="DecodeCommandBytes_8c_source.html#l00090">90</a> of file <a class="el" href="DecodeCommandBytes_8c_source.html">DecodeCommandBytes.c</a>.</p>

<p>Referenced by <a class="el" href="control_8c_source.html#l00158">WIRED_UART_IRQHandler()</a>, and <a class="el" href="control_8c_source.html#l00110">WIRELESS_UART_IRQHandler()</a>.</p>
<div class="fragment"><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;{</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    <a class="code" href="sensor__fusion_8h.html#ab7903878916593daecbeb95b98115ab0">int32</a> isum;     <span class="comment">// 32 bit command identifier</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <a class="code" href="sensor__fusion_8h.html#aa0d0fdc87fd135ef2bedb030901cdb9c">int16</a> i, j;     <span class="comment">// loop counters</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    <span class="comment">// parse all received bytes in sUARTInputBuf into the iCommandBuffer delay line</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; nbytes; i++) {</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;        <span class="comment">// shuffle the iCommandBuffer delay line and add the new command byte</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;        <span class="keywordflow">for</span> (j = 0; j &lt; 3; j++)</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;            iCommandBuffer[j] = iCommandBuffer[j + 1];</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;        iCommandBuffer[3] = sUART_InputBuffer[i];</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;        <span class="comment">// check if we have a valid command yet</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        isum = ((((((<a class="code" href="sensor__fusion_8h.html#ab7903878916593daecbeb95b98115ab0">int32</a>)iCommandBuffer[0] &lt;&lt; 8) | iCommandBuffer[1]) &lt;&lt; 8) | iCommandBuffer[2]) &lt;&lt; 8) | iCommandBuffer[3];</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;        <span class="keywordflow">switch</span> (isum)       {</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#ae90e11c13d62e92a87653100abbae5f6">cmd_VGplus</a>: <span class="comment">// &quot;VG+ &quot; = enable angular velocity packet transmission</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;                    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a51cbe943cdee0fd0a2ff72d2a04fad9a">pControlSubsystem</a>-&gt;<a class="code" href="structControlSubsystem.html#a527b159143188ef9b66bd4c8a6aefcdf">AngularVelocityPacketOn</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#a8575115e8a73d926b79c784e257c6b80">cmd_VGminus</a>: <span class="comment">// &quot;VG- &quot; = disable angular velocity packet transmission</span></div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;                    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a51cbe943cdee0fd0a2ff72d2a04fad9a">pControlSubsystem</a>-&gt;<a class="code" href="structControlSubsystem.html#a527b159143188ef9b66bd4c8a6aefcdf">AngularVelocityPacketOn</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#a30baca94d6d21194de5b2e2c5db4f47a">cmd_DBplus</a>: <span class="comment">// &quot;DB+ &quot; = enable debug packet transmission</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;                    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a51cbe943cdee0fd0a2ff72d2a04fad9a">pControlSubsystem</a>-&gt;<a class="code" href="structControlSubsystem.html#a41ad90f99ac3c14b2bdce3967df14f1b">DebugPacketOn</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#a6cbd87a8022fb7f5194e2a915c4ba297">cmd_DBminus</a>: <span class="comment">// &quot;DB- &quot; = disable debug packet transmission</span></div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;                    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a51cbe943cdee0fd0a2ff72d2a04fad9a">pControlSubsystem</a>-&gt;<a class="code" href="structControlSubsystem.html#a41ad90f99ac3c14b2bdce3967df14f1b">DebugPacketOn</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;</div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#ae6181510482b0abbaac4d594b1bf2038">cmd_Q3</a>: <span class="comment">// &quot;Q3  &quot; = transmit 3-axis accelerometer quaternion in standard packet</span></div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;<span class="preprocessor">#if F_3DOF_G_BASIC</span></div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;                    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a51cbe943cdee0fd0a2ff72d2a04fad9a">pControlSubsystem</a>-&gt;<a class="code" href="structControlSubsystem.html#a560615429c69fcefa85de0624fa6d83e">QuaternionPacketType</a> = <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa19bd87b11e82b9047ad750fb62711ba8">Q3</a>;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#a81db55b5fd6648ddbcd12565be5b9e6c">cmd_Q3M</a>:  <span class="comment">// &quot;Q3M &quot; = transmit 3-axis magnetometer quaternion in standard packet</span></div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;<span class="preprocessor">#if F_3DOF_B_BASIC</span></div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;                    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a51cbe943cdee0fd0a2ff72d2a04fad9a">pControlSubsystem</a>-&gt;<a class="code" href="structControlSubsystem.html#a560615429c69fcefa85de0624fa6d83e">QuaternionPacketType</a> = <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaada2dae63d5865a8446caa7938c73c5dc">Q3M</a>;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#ac161c67ce40e2bd748d11aa7d89ef5c0">cmd_Q3G</a>: <span class="comment">// &quot;Q3G &quot; = transmit 3-axis gyro quaternion in standard packet</span></div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;<span class="preprocessor">#if F_3DOF_Y_BASIC</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;                    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a51cbe943cdee0fd0a2ff72d2a04fad9a">pControlSubsystem</a>-&gt;<a class="code" href="structControlSubsystem.html#a560615429c69fcefa85de0624fa6d83e">QuaternionPacketType</a> = <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaaf63c9f6fec59717499a84048f682cf8a">Q3G</a>;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#aa0705e68b33dccd313303c5ca6bfd2c1">cmd_Q6MA</a>: <span class="comment">// &quot;Q6MA&quot; = transmit 6-axis mag/accel quaternion in standard packet</span></div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;<span class="preprocessor">#if F_6DOF_GB_BASIC</span></div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;                    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a51cbe943cdee0fd0a2ff72d2a04fad9a">pControlSubsystem</a>-&gt;<a class="code" href="structControlSubsystem.html#a560615429c69fcefa85de0624fa6d83e">QuaternionPacketType</a> = <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa0cf62dda224dcbac09ae26cd46ccce01">Q6MA</a>;</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#aa3bc6121f421435af64bce070b01dbdc">cmd_Q6AG</a>: <span class="comment">// &quot;Q6AG&quot; = transmit 6-axis accel/gyro quaternion in standard packet</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;<span class="preprocessor">#if F_6DOF_GY_KALMAN</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;                    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a51cbe943cdee0fd0a2ff72d2a04fad9a">pControlSubsystem</a>-&gt;<a class="code" href="structControlSubsystem.html#a560615429c69fcefa85de0624fa6d83e">QuaternionPacketType</a> = <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa59c8dc55b720396019ef93eb943a3b96">Q6AG</a>;</div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#a87d418912514db68d46a19488a880c2f">cmd_Q9</a>: <span class="comment">// &quot;Q9  &quot; = transmit 9-axis quaternion in standard packet (default)</span></div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;<span class="preprocessor">#if F_9DOF_GBY_KALMAN</span></div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;                    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a51cbe943cdee0fd0a2ff72d2a04fad9a">pControlSubsystem</a>-&gt;<a class="code" href="structControlSubsystem.html#a560615429c69fcefa85de0624fa6d83e">QuaternionPacketType</a> = <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa9c5ceeb2bc9bf27379c7e72bc4d0ff13">Q9</a>;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#a953d0fd1fea12cf41524b0a185417f06">cmd_RPCplus</a>: <span class="comment">// &quot;RPC+&quot; = Roll/Pitch/Compass on</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;                    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a51cbe943cdee0fd0a2ff72d2a04fad9a">pControlSubsystem</a>-&gt;<a class="code" href="structControlSubsystem.html#a6c5365ebe170e2ee207212da7531ccea">RPCPacketOn</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#a14df47d70ca8a588e5262fbb47b17f2d">cmd_RPCminus</a>: <span class="comment">// &quot;RPC-&quot; = Roll/Pitch/Compass off</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;                    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a51cbe943cdee0fd0a2ff72d2a04fad9a">pControlSubsystem</a>-&gt;<a class="code" href="structControlSubsystem.html#a6c5365ebe170e2ee207212da7531ccea">RPCPacketOn</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#a77aec193d3c012a98fdb4e8a561e5ac0">cmd_ALTplus</a>: <span class="comment">// &quot;ALT+&quot; = Altitude packet on</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;                    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a51cbe943cdee0fd0a2ff72d2a04fad9a">pControlSubsystem</a>-&gt;<a class="code" href="structControlSubsystem.html#af46ef3a1af714f7d40707053964db4a8">AltPacketOn</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;</div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#ac179cba01ef1197e611985a5ec22cab3">cmd_ALTminus</a>: <span class="comment">// &quot;ALT-&quot; = Altitude packet off</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;                    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a51cbe943cdee0fd0a2ff72d2a04fad9a">pControlSubsystem</a>-&gt;<a class="code" href="structControlSubsystem.html#af46ef3a1af714f7d40707053964db4a8">AltPacketOn</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#a50e5ea9fc776358f895a2968208bd03b">cmd_RST</a>: <span class="comment">// &quot;RST &quot; = Soft reset</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;                    <span class="comment">// reset sensor fusion</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;                    <a class="code" href="fusion_8c.html#ad9cb3659204ae7a30109ceaf4d94ecec">fInitializeFusion</a>(sfg);</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;                    <span class="comment">// reset magnetic calibration and magnetometer data buffer</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="preprocessor">#if F_USING_MAG</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;                    <a class="code" href="magnetic_8c.html#a793003e431e2705d081b5073144cb2c0">fInitializeMagCalibration</a>(&amp;sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#acf241c1ff86d307d296f560449acc2a4">MagCal</a>, &amp;sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#ad44d6aaf76570ad374ad7c170175de5a">MagBuffer</a>);</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;                    <span class="comment">// reset precision accelerometer calibration and accelerometer measurements</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="preprocessor">#if F_USING_ACCEL</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;                    <a class="code" href="precisionAccelerometer_8c.html#ab8572ce21837538a984e62035db4d89e">fInitializeAccelCalibration</a>(&amp;sfg-&gt;AccelCal, &amp;sfg-&gt;AccelBuffer, &amp;(sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a51cbe943cdee0fd0a2ff72d2a04fad9a">pControlSubsystem</a>-&gt;<a class="code" href="structControlSubsystem.html#aa62f07fac570bf67c0832d4bf7d38e76">AccelCalPacketOn</a>)) ;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#ab7d2798980bde69b87a1a81fde8a6f67">cmd_RINS</a>: <span class="comment">// &quot;RINS&quot; = Reset INS inertial navigation velocity and position</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="preprocessor">#if F_9DOF_GBY_KALMAN</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;                    <span class="keywordflow">for</span> (i = <a class="code" href="sensor__fusion_8h.html#a48bbd27e913de8d7749dff9dec2fe816">CHX</a>; i &lt;= <a class="code" href="sensor__fusion_8h.html#a76143891435bdd7248857e45b93521ed">CHZ</a>; i++) {</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;            sfg-&gt;SV_9DOF_GBY_KALMAN.fVelGl[i] = 0.0F;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;            sfg-&gt;SV_9DOF_GBY_KALMAN.fDisGl[i] = 0.0F;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                    }</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#a3cc848ec4b05581fe6ce5d8e6f56dc81">cmd_SVAC</a>: <span class="comment">// &quot;SVAC&quot; = save all calibrations to Kinetis flash</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;                    <a class="code" href="calibration__storage_8c.html#ad08799ac63701e755fe2414b32f69b50">SaveMagCalibrationToNVM</a>(sfg);</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                    <a class="code" href="calibration__storage_8c.html#aa5684d700f135264e542f33071ed6a45">SaveGyroCalibrationToNVM</a>(sfg);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;                    <a class="code" href="calibration__storage_8c.html#a6cbf0fc4417e3a411a9685e2a92f1816">SaveAccelCalibrationToNVM</a>(sfg);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#a3a405d845cef7219b70ffda126a81628">cmd_SVMC</a>: <span class="comment">// &quot;SVMC&quot; = save magnetic calibration to Kinetis flash</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;                    <a class="code" href="calibration__storage_8c.html#ad08799ac63701e755fe2414b32f69b50">SaveMagCalibrationToNVM</a>(sfg);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#a3ff024f45923953ec5a745a5531a321c">cmd_SVYC</a>: <span class="comment">// &quot;SVYC&quot; = save gyroscope calibration to Kinetis flash</span></div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;                    <a class="code" href="calibration__storage_8c.html#aa5684d700f135264e542f33071ed6a45">SaveGyroCalibrationToNVM</a>(sfg);</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#a3e8753c5d2c241fa11641aed410e4f8c">cmd_SVGC</a>: <span class="comment">// &quot;SVGC&quot; = save precision accelerometer calibration to Kinetis flash</span></div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                    <a class="code" href="calibration__storage_8c.html#a6cbf0fc4417e3a411a9685e2a92f1816">SaveAccelCalibrationToNVM</a>(sfg);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#ae8e28a3f46f0d3ef5adb7d63e4088069">cmd_ERAC</a>: <span class="comment">// &quot;ERAC&quot; = erase all calibrations from Kinetis flash</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                    <a class="code" href="calibration__storage_8c.html#a5004646fd5b485a74892b17e4a3af15b">EraseMagCalibrationFromNVM</a>();</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;                    <a class="code" href="calibration__storage_8c.html#a98044dd5ba8a80f7e92b4567725e5193">EraseGyroCalibrationFromNVM</a>();</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;                    <a class="code" href="calibration__storage_8c.html#a3b4a1193ece3947c38651156293a7623">EraseAccelCalibrationFromNVM</a>();</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#a6efbc8ec1703837c7adfa0811a2b161e">cmd_ERMC</a>: <span class="comment">// &quot;ERMC&quot; = erase magnetic calibration offset 0 bytes from Kinetis flash</span></div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;                    <a class="code" href="calibration__storage_8c.html#a5004646fd5b485a74892b17e4a3af15b">EraseMagCalibrationFromNVM</a>();</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#acfa5e01345e04a72281328adee65ab90">cmd_ERYC</a>: <span class="comment">// &quot;ERYC&quot; = erase gyro offset calibrationoffset 128 bytes from Kinetis flash</span></div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;                    <a class="code" href="calibration__storage_8c.html#a98044dd5ba8a80f7e92b4567725e5193">EraseGyroCalibrationFromNVM</a>();</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#a36bd60163958f225c8f069d209fbe4be">cmd_ERGC</a>: <span class="comment">// &quot;ERGC&quot; = erase precision accelerometer calibration offset 192 bytesfrom Kinetis flash</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                    <a class="code" href="calibration__storage_8c.html#a3b4a1193ece3947c38651156293a7623">EraseAccelCalibrationFromNVM</a>();</div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#ad033b9f4b4e5b8be0287ae3c40276dbc">cmd_180X</a>: <span class="comment">// &quot;180X&quot; perturbation</span></div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a571184d82a99a987a2ca72b53e2fa100">iPerturbation</a> = 1;</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#a52de366ecfe399da8ba3326fedf2f134">cmd_180Y</a>: <span class="comment">// &quot;180Y&quot; perturbation</span></div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a571184d82a99a987a2ca72b53e2fa100">iPerturbation</a> = 2;</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#a7e4a1d4a077dd963999e128207315013">cmd_180Z</a>: <span class="comment">// &quot;180Z&quot; perturbation</span></div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;                    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a571184d82a99a987a2ca72b53e2fa100">iPerturbation</a> = 3;</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;                  iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#a587d3e585fef780d1e9797700bf167a1">cmd_M90X</a>: <span class="comment">// &quot;M90X&quot; perturbation</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a571184d82a99a987a2ca72b53e2fa100">iPerturbation</a> = 4;</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;</div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#acabfcfb0cdc412a7ce2a27741190b641">cmd_P90X</a>: <span class="comment">// &quot;P90X&quot; perturbation</span></div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a571184d82a99a987a2ca72b53e2fa100">iPerturbation</a> = 5;</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#ac6da8c3ac3abee673486071cea68ce3b">cmd_M90Y</a>: <span class="comment">// &quot;M90Y&quot; perturbation</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a571184d82a99a987a2ca72b53e2fa100">iPerturbation</a> = 6;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#aa4ae8da7bfe2f6071b3ea9cf2daf7fce">cmd_P90Y</a>: <span class="comment">// &quot;P90Y&quot; perturbation</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a571184d82a99a987a2ca72b53e2fa100">iPerturbation</a> = 7;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#aa01c75cd9d2ed3ec5acec36d0cdfd945">cmd_M90Z</a>: <span class="comment">// &quot;M90Z&quot; perturbation</span></div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a571184d82a99a987a2ca72b53e2fa100">iPerturbation</a> = 8;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#a95bc67aca1714fa6770555292aab7c92">cmd_P90Z</a>: <span class="comment">// &quot;P90Z&quot; perturbation</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a571184d82a99a987a2ca72b53e2fa100">iPerturbation</a> = 9;</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;<span class="preprocessor">#if F_USING_ACCEL</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#a6bb3c28d40d2b6aa9823b6756343dd26">cmd_PA00</a>: <span class="comment">// &quot;PA00&quot; average precision accelerometer location 0</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                    sfg-&gt;AccelBuffer.iStoreLocation = 0;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                    sfg-&gt;AccelBuffer.iStoreCounter = (<a class="code" href="precisionAccelerometer_8h.html#a2b9b9bab44fce8ba83b6da0bc9edb21c">ACCEL_CAL_AVERAGING_SECS</a> * <a class="code" href="standard__build_8h.html#a470d8d33fe0efafcc0c0835fbea14f5e">FUSION_HZ</a>);</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#a0e9e74197631e89642cbf30fd5ed24d1">cmd_PA01</a>: <span class="comment">// &quot;PA01&quot; average precision accelerometer location 1</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                    sfg-&gt;AccelBuffer.iStoreLocation = 1;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                    sfg-&gt;AccelBuffer.iStoreCounter = (<a class="code" href="precisionAccelerometer_8h.html#a2b9b9bab44fce8ba83b6da0bc9edb21c">ACCEL_CAL_AVERAGING_SECS</a> * <a class="code" href="standard__build_8h.html#a470d8d33fe0efafcc0c0835fbea14f5e">FUSION_HZ</a>);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#ad85f9c00a94b924326f16034579b9039">cmd_PA02</a>: <span class="comment">// &quot;PA02&quot; average precision accelerometer location 2</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                    sfg-&gt;AccelBuffer.iStoreLocation = 2;</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                    sfg-&gt;AccelBuffer.iStoreCounter = (<a class="code" href="precisionAccelerometer_8h.html#a2b9b9bab44fce8ba83b6da0bc9edb21c">ACCEL_CAL_AVERAGING_SECS</a> * <a class="code" href="standard__build_8h.html#a470d8d33fe0efafcc0c0835fbea14f5e">FUSION_HZ</a>);</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#af84fa2d4c0e6d418fdf1f1dfff441bfe">cmd_PA03</a>: <span class="comment">// &quot;PA03&quot; average precision accelerometer location 3</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                    sfg-&gt;AccelBuffer.iStoreLocation = 3;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                    sfg-&gt;AccelBuffer.iStoreCounter = (<a class="code" href="precisionAccelerometer_8h.html#a2b9b9bab44fce8ba83b6da0bc9edb21c">ACCEL_CAL_AVERAGING_SECS</a> * <a class="code" href="standard__build_8h.html#a470d8d33fe0efafcc0c0835fbea14f5e">FUSION_HZ</a>);</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#abb76efa2b507e0da516441a705efc24b">cmd_PA04</a>: <span class="comment">// &quot;PA04&quot; average precision accelerometer location 4</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                    sfg-&gt;AccelBuffer.iStoreLocation = 4;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;                    sfg-&gt;AccelBuffer.iStoreCounter = (<a class="code" href="precisionAccelerometer_8h.html#a2b9b9bab44fce8ba83b6da0bc9edb21c">ACCEL_CAL_AVERAGING_SECS</a> * <a class="code" href="standard__build_8h.html#a470d8d33fe0efafcc0c0835fbea14f5e">FUSION_HZ</a>);</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#afc3b6aaa4ee5424ea531d9e783b7b69f">cmd_PA05</a>: <span class="comment">// &quot;PA05&quot; average precision accelerometer location 5</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                    sfg-&gt;AccelBuffer.iStoreLocation = 5;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                    sfg-&gt;AccelBuffer.iStoreCounter = (<a class="code" href="precisionAccelerometer_8h.html#a2b9b9bab44fce8ba83b6da0bc9edb21c">ACCEL_CAL_AVERAGING_SECS</a> * <a class="code" href="standard__build_8h.html#a470d8d33fe0efafcc0c0835fbea14f5e">FUSION_HZ</a>);</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#a5959c5ca910013194a971227e6ac7d57">cmd_PA06</a>: <span class="comment">// &quot;PA06&quot; average precision accelerometer location 6</span></div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                    sfg-&gt;AccelBuffer.iStoreLocation = 6;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                    sfg-&gt;AccelBuffer.iStoreCounter = (<a class="code" href="precisionAccelerometer_8h.html#a2b9b9bab44fce8ba83b6da0bc9edb21c">ACCEL_CAL_AVERAGING_SECS</a> * <a class="code" href="standard__build_8h.html#a470d8d33fe0efafcc0c0835fbea14f5e">FUSION_HZ</a>);</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#ab8f562d6e310fcc50b3437b9c844d950">cmd_PA07</a>: <span class="comment">// &quot;PA07&quot; average precision accelerometer location 7</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                    sfg-&gt;AccelBuffer.iStoreLocation = 7;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                    sfg-&gt;AccelBuffer.iStoreCounter = (<a class="code" href="precisionAccelerometer_8h.html#a2b9b9bab44fce8ba83b6da0bc9edb21c">ACCEL_CAL_AVERAGING_SECS</a> * <a class="code" href="standard__build_8h.html#a470d8d33fe0efafcc0c0835fbea14f5e">FUSION_HZ</a>);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#a5de3645a828c5df60ef915fb28c5882b">cmd_PA08</a>: <span class="comment">// &quot;PA08&quot; average precision accelerometer location 8</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                    sfg-&gt;AccelBuffer.iStoreLocation = 8;</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                    sfg-&gt;AccelBuffer.iStoreCounter = (<a class="code" href="precisionAccelerometer_8h.html#a2b9b9bab44fce8ba83b6da0bc9edb21c">ACCEL_CAL_AVERAGING_SECS</a> * <a class="code" href="standard__build_8h.html#a470d8d33fe0efafcc0c0835fbea14f5e">FUSION_HZ</a>);</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#a59c9ff7a3b6b88513e8ece6ebaa0390b">cmd_PA09</a>: <span class="comment">// &quot;PA09&quot; average precision accelerometer location 9</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                    sfg-&gt;AccelBuffer.iStoreLocation = 9;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                    sfg-&gt;AccelBuffer.iStoreCounter = (<a class="code" href="precisionAccelerometer_8h.html#a2b9b9bab44fce8ba83b6da0bc9edb21c">ACCEL_CAL_AVERAGING_SECS</a> * <a class="code" href="standard__build_8h.html#a470d8d33fe0efafcc0c0835fbea14f5e">FUSION_HZ</a>);</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#aaf59580bf7ec60ec94973212786a1126">cmd_PA10</a>: <span class="comment">// &quot;PA10&quot; average precision accelerometer location 10</span></div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                    sfg-&gt;AccelBuffer.iStoreLocation = 10;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                    sfg-&gt;AccelBuffer.iStoreCounter = (<a class="code" href="precisionAccelerometer_8h.html#a2b9b9bab44fce8ba83b6da0bc9edb21c">ACCEL_CAL_AVERAGING_SECS</a> * <a class="code" href="standard__build_8h.html#a470d8d33fe0efafcc0c0835fbea14f5e">FUSION_HZ</a>);</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="DecodeCommandBytes_8c.html#a2b71412b44a575e0733a1a43a266b15a">cmd_PA11</a>: <span class="comment">// &quot;PA11&quot; average precision accelerometer location 11</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;                    sfg-&gt;AccelBuffer.iStoreLocation = 11;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;                    sfg-&gt;AccelBuffer.iStoreCounter = (<a class="code" href="precisionAccelerometer_8h.html#a2b9b9bab44fce8ba83b6da0bc9edb21c">ACCEL_CAL_AVERAGING_SECS</a> * <a class="code" href="standard__build_8h.html#a470d8d33fe0efafcc0c0835fbea14f5e">FUSION_HZ</a>);</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                    iCommandBuffer[3] = <span class="charliteral">&#39;~&#39;</span>;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;<span class="preprocessor">#endif // precision accelerometer calibration</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <span class="keywordflow">default</span>:</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;            <span class="comment">// no action</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;        }</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;    } <span class="comment">// end of loop over received characters</span></div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;}</div><div class="ttc" id="DecodeCommandBytes_8c_html_abb76efa2b507e0da516441a705efc24b"><div class="ttname"><a href="DecodeCommandBytes_8c.html#abb76efa2b507e0da516441a705efc24b">cmd_PA04</a></div><div class="ttdeci">#define cmd_PA04</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00081">DecodeCommandBytes.c:81</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_a5f469312b3865f2d3efea2edd6f8afaaa9c5ceeb2bc9bf27379c7e72bc4d0ff13"><div class="ttname"><a href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa9c5ceeb2bc9bf27379c7e72bc4d0ff13">Q9</a></div><div class="ttdoc">Quaternion derived from full 9-axis sensor fusion. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00070">sensor_fusion.h:70</a></div></div>
<div class="ttc" id="calibration__storage_8c_html_a98044dd5ba8a80f7e92b4567725e5193"><div class="ttname"><a href="calibration__storage_8c.html#a98044dd5ba8a80f7e92b4567725e5193">EraseGyroCalibrationFromNVM</a></div><div class="ttdeci">void EraseGyroCalibrationFromNVM(void)</div><div class="ttdef"><b>Definition:</b> <a href="calibration__storage_8c_source.html#l00167">calibration_storage.c:167</a></div></div>
<div class="ttc" id="fusion_8c_html_ad9cb3659204ae7a30109ceaf4d94ecec"><div class="ttname"><a href="fusion_8c.html#ad9cb3659204ae7a30109ceaf4d94ecec">fInitializeFusion</a></div><div class="ttdeci">void fInitializeFusion(SensorFusionGlobals *sfg)</div><div class="ttdef"><b>Definition:</b> <a href="fusion_8c_source.html#l00051">fusion.c:51</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_a3e8753c5d2c241fa11641aed410e4f8c"><div class="ttname"><a href="DecodeCommandBytes_8c.html#a3e8753c5d2c241fa11641aed410e4f8c">cmd_SVGC</a></div><div class="ttdeci">#define cmd_SVGC</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00063">DecodeCommandBytes.c:63</a></div></div>
<div class="ttc" id="calibration__storage_8c_html_ad08799ac63701e755fe2414b32f69b50"><div class="ttname"><a href="calibration__storage_8c.html#ad08799ac63701e755fe2414b32f69b50">SaveMagCalibrationToNVM</a></div><div class="ttdeci">void SaveMagCalibrationToNVM(SensorFusionGlobals *sfg)</div><div class="ttdef"><b>Definition:</b> <a href="calibration__storage_8c_source.html#l00039">calibration_storage.c:39</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_a3ff024f45923953ec5a745a5531a321c"><div class="ttname"><a href="DecodeCommandBytes_8c.html#a3ff024f45923953ec5a745a5531a321c">cmd_SVYC</a></div><div class="ttdeci">#define cmd_SVYC</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00062">DecodeCommandBytes.c:62</a></div></div>
<div class="ttc" id="magnetic_8c_html_a793003e431e2705d081b5073144cb2c0"><div class="ttname"><a href="magnetic_8c.html#a793003e431e2705d081b5073144cb2c0">fInitializeMagCalibration</a></div><div class="ttdeci">void fInitializeMagCalibration(MagCalibration *pthisMagCal, MagBuffer *pthisMagBuffer)</div><div class="ttdef"><b>Definition:</b> <a href="magnetic_8c_source.html#l00041">magnetic.c:41</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_ac6da8c3ac3abee673486071cea68ce3b"><div class="ttname"><a href="DecodeCommandBytes_8c.html#ac6da8c3ac3abee673486071cea68ce3b">cmd_M90Y</a></div><div class="ttdeci">#define cmd_M90Y</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00073">DecodeCommandBytes.c:73</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_a5de3645a828c5df60ef915fb28c5882b"><div class="ttname"><a href="DecodeCommandBytes_8c.html#a5de3645a828c5df60ef915fb28c5882b">cmd_PA08</a></div><div class="ttdeci">#define cmd_PA08</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00085">DecodeCommandBytes.c:85</a></div></div>
<div class="ttc" id="calibration__storage_8c_html_a6cbf0fc4417e3a411a9685e2a92f1816"><div class="ttname"><a href="calibration__storage_8c.html#a6cbf0fc4417e3a411a9685e2a92f1816">SaveAccelCalibrationToNVM</a></div><div class="ttdeci">void SaveAccelCalibrationToNVM(SensorFusionGlobals *sfg)</div><div class="ttdef"><b>Definition:</b> <a href="calibration__storage_8c_source.html#l00112">calibration_storage.c:112</a></div></div>
<div class="ttc" id="calibration__storage_8c_html_a5004646fd5b485a74892b17e4a3af15b"><div class="ttname"><a href="calibration__storage_8c.html#a5004646fd5b485a74892b17e4a3af15b">EraseMagCalibrationFromNVM</a></div><div class="ttdeci">void EraseMagCalibrationFromNVM(void)</div><div class="ttdef"><b>Definition:</b> <a href="calibration__storage_8c_source.html#l00146">calibration_storage.c:146</a></div></div>
<div class="ttc" id="structControlSubsystem_html_af46ef3a1af714f7d40707053964db4a8"><div class="ttname"><a href="structControlSubsystem.html#af46ef3a1af714f7d40707053964db4a8">ControlSubsystem::AltPacketOn</a></div><div class="ttdeci">volatile uint8_t AltPacketOn</div><div class="ttdoc">flag to enable altitude packet </div><div class="ttdef"><b>Definition:</b> <a href="control_8h_source.html#l00070">control.h:70</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_aa4ae8da7bfe2f6071b3ea9cf2daf7fce"><div class="ttname"><a href="DecodeCommandBytes_8c.html#aa4ae8da7bfe2f6071b3ea9cf2daf7fce">cmd_P90Y</a></div><div class="ttdeci">#define cmd_P90Y</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00074">DecodeCommandBytes.c:74</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_a5f469312b3865f2d3efea2edd6f8afaaada2dae63d5865a8446caa7938c73c5dc"><div class="ttname"><a href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaada2dae63d5865a8446caa7938c73c5dc">Q3M</a></div><div class="ttdoc">Quaternion derived from 3-axis mag only (auto compass algorithm) </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00066">sensor_fusion.h:66</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_a50e5ea9fc776358f895a2968208bd03b"><div class="ttname"><a href="DecodeCommandBytes_8c.html#a50e5ea9fc776358f895a2968208bd03b">cmd_RST</a></div><div class="ttdeci">#define cmd_RST</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00058">DecodeCommandBytes.c:58</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_acf241c1ff86d307d296f560449acc2a4"><div class="ttname"><a href="structSensorFusionGlobals.html#acf241c1ff86d307d296f560449acc2a4">SensorFusionGlobals::MagCal</a></div><div class="ttdeci">MagCalibration MagCal</div><div class="ttdoc">mag cal storage </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00503">sensor_fusion.h:503</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_a36bd60163958f225c8f069d209fbe4be"><div class="ttname"><a href="DecodeCommandBytes_8c.html#a36bd60163958f225c8f069d209fbe4be">cmd_ERGC</a></div><div class="ttdeci">#define cmd_ERGC</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00067">DecodeCommandBytes.c:67</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_a8575115e8a73d926b79c784e257c6b80"><div class="ttname"><a href="DecodeCommandBytes_8c.html#a8575115e8a73d926b79c784e257c6b80">cmd_VGminus</a></div><div class="ttdeci">#define cmd_VGminus</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00045">DecodeCommandBytes.c:45</a></div></div>
<div class="ttc" id="structControlSubsystem_html_aa62f07fac570bf67c0832d4bf7d38e76"><div class="ttname"><a href="structControlSubsystem.html#aa62f07fac570bf67c0832d4bf7d38e76">ControlSubsystem::AccelCalPacketOn</a></div><div class="ttdeci">volatile int8_t AccelCalPacketOn</div><div class="ttdoc">variable used to coordinate accelerometer calibration </div><div class="ttdef"><b>Definition:</b> <a href="control_8h_source.html#l00071">control.h:71</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_a3cc848ec4b05581fe6ce5d8e6f56dc81"><div class="ttname"><a href="DecodeCommandBytes_8c.html#a3cc848ec4b05581fe6ce5d8e6f56dc81">cmd_SVAC</a></div><div class="ttdeci">#define cmd_SVAC</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00060">DecodeCommandBytes.c:60</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_aaf59580bf7ec60ec94973212786a1126"><div class="ttname"><a href="DecodeCommandBytes_8c.html#aaf59580bf7ec60ec94973212786a1126">cmd_PA10</a></div><div class="ttdeci">#define cmd_PA10</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00087">DecodeCommandBytes.c:87</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_a5f469312b3865f2d3efea2edd6f8afaaaf63c9f6fec59717499a84048f682cf8a"><div class="ttname"><a href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaaf63c9f6fec59717499a84048f682cf8a">Q3G</a></div><div class="ttdoc">Quaternion derived from 3-axis gyro only (rotation) </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00067">sensor_fusion.h:67</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_a5f469312b3865f2d3efea2edd6f8afaaa0cf62dda224dcbac09ae26cd46ccce01"><div class="ttname"><a href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa0cf62dda224dcbac09ae26cd46ccce01">Q6MA</a></div><div class="ttdoc">Quaternion derived from 3-axis accel + 3 axis mag (eCompass) </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00068">sensor_fusion.h:68</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="sensor__fusion_8h.html#ab7903878916593daecbeb95b98115ab0">int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00057">sensor_fusion.h:57</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_a5f469312b3865f2d3efea2edd6f8afaaa59c8dc55b720396019ef93eb943a3b96"><div class="ttname"><a href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa59c8dc55b720396019ef93eb943a3b96">Q6AG</a></div><div class="ttdoc">Quaternion derived from 3-axis accel + 3-axis gyro (gaming) </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00069">sensor_fusion.h:69</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_a6cbd87a8022fb7f5194e2a915c4ba297"><div class="ttname"><a href="DecodeCommandBytes_8c.html#a6cbd87a8022fb7f5194e2a915c4ba297">cmd_DBminus</a></div><div class="ttdeci">#define cmd_DBminus</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00047">DecodeCommandBytes.c:47</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_a51cbe943cdee0fd0a2ff72d2a04fad9a"><div class="ttname"><a href="structSensorFusionGlobals.html#a51cbe943cdee0fd0a2ff72d2a04fad9a">SensorFusionGlobals::pControlSubsystem</a></div><div class="ttdeci">struct ControlSubsystem * pControlSubsystem</div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00475">sensor_fusion.h:475</a></div></div>
<div class="ttc" id="calibration__storage_8c_html_aa5684d700f135264e542f33071ed6a45"><div class="ttname"><a href="calibration__storage_8c.html#aa5684d700f135264e542f33071ed6a45">SaveGyroCalibrationToNVM</a></div><div class="ttdeci">void SaveGyroCalibrationToNVM(SensorFusionGlobals *sfg)</div><div class="ttdef"><b>Definition:</b> <a href="calibration__storage_8c_source.html#l00073">calibration_storage.c:73</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_afc3b6aaa4ee5424ea531d9e783b7b69f"><div class="ttname"><a href="DecodeCommandBytes_8c.html#afc3b6aaa4ee5424ea531d9e783b7b69f">cmd_PA05</a></div><div class="ttdeci">#define cmd_PA05</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00082">DecodeCommandBytes.c:82</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_a0e9e74197631e89642cbf30fd5ed24d1"><div class="ttname"><a href="DecodeCommandBytes_8c.html#a0e9e74197631e89642cbf30fd5ed24d1">cmd_PA01</a></div><div class="ttdeci">#define cmd_PA01</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00078">DecodeCommandBytes.c:78</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_acabfcfb0cdc412a7ce2a27741190b641"><div class="ttname"><a href="DecodeCommandBytes_8c.html#acabfcfb0cdc412a7ce2a27741190b641">cmd_P90X</a></div><div class="ttdeci">#define cmd_P90X</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00072">DecodeCommandBytes.c:72</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_a6bb3c28d40d2b6aa9823b6756343dd26"><div class="ttname"><a href="DecodeCommandBytes_8c.html#a6bb3c28d40d2b6aa9823b6756343dd26">cmd_PA00</a></div><div class="ttdeci">#define cmd_PA00</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00077">DecodeCommandBytes.c:77</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_a76143891435bdd7248857e45b93521ed"><div class="ttname"><a href="sensor__fusion_8h.html#a76143891435bdd7248857e45b93521ed">CHZ</a></div><div class="ttdeci">#define CHZ</div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_a30baca94d6d21194de5b2e2c5db4f47a"><div class="ttname"><a href="DecodeCommandBytes_8c.html#a30baca94d6d21194de5b2e2c5db4f47a">cmd_DBplus</a></div><div class="ttdeci">#define cmd_DBplus</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00046">DecodeCommandBytes.c:46</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_a5959c5ca910013194a971227e6ac7d57"><div class="ttname"><a href="DecodeCommandBytes_8c.html#a5959c5ca910013194a971227e6ac7d57">cmd_PA06</a></div><div class="ttdeci">#define cmd_PA06</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00083">DecodeCommandBytes.c:83</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_af84fa2d4c0e6d418fdf1f1dfff441bfe"><div class="ttname"><a href="DecodeCommandBytes_8c.html#af84fa2d4c0e6d418fdf1f1dfff441bfe">cmd_PA03</a></div><div class="ttdeci">#define cmd_PA03</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00080">DecodeCommandBytes.c:80</a></div></div>
<div class="ttc" id="structControlSubsystem_html_a41ad90f99ac3c14b2bdce3967df14f1b"><div class="ttname"><a href="structControlSubsystem.html#a41ad90f99ac3c14b2bdce3967df14f1b">ControlSubsystem::DebugPacketOn</a></div><div class="ttdeci">volatile uint8_t DebugPacketOn</div><div class="ttdoc">flag to enable debug packet </div><div class="ttdef"><b>Definition:</b> <a href="control_8h_source.html#l00068">control.h:68</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_a14df47d70ca8a588e5262fbb47b17f2d"><div class="ttname"><a href="DecodeCommandBytes_8c.html#a14df47d70ca8a588e5262fbb47b17f2d">cmd_RPCminus</a></div><div class="ttdeci">#define cmd_RPCminus</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00055">DecodeCommandBytes.c:55</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_ab8f562d6e310fcc50b3437b9c844d950"><div class="ttname"><a href="DecodeCommandBytes_8c.html#ab8f562d6e310fcc50b3437b9c844d950">cmd_PA07</a></div><div class="ttdeci">#define cmd_PA07</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00084">DecodeCommandBytes.c:84</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_a48bbd27e913de8d7749dff9dec2fe816"><div class="ttname"><a href="sensor__fusion_8h.html#a48bbd27e913de8d7749dff9dec2fe816">CHX</a></div><div class="ttdeci">#define CHX</div><div class="ttdoc">Used to access X-channel entries in various data data structures. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00076">sensor_fusion.h:76</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_a81db55b5fd6648ddbcd12565be5b9e6c"><div class="ttname"><a href="DecodeCommandBytes_8c.html#a81db55b5fd6648ddbcd12565be5b9e6c">cmd_Q3M</a></div><div class="ttdeci">#define cmd_Q3M</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00049">DecodeCommandBytes.c:49</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_a95bc67aca1714fa6770555292aab7c92"><div class="ttname"><a href="DecodeCommandBytes_8c.html#a95bc67aca1714fa6770555292aab7c92">cmd_P90Z</a></div><div class="ttdeci">#define cmd_P90Z</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00076">DecodeCommandBytes.c:76</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_ad44d6aaf76570ad374ad7c170175de5a"><div class="ttname"><a href="structSensorFusionGlobals.html#ad44d6aaf76570ad374ad7c170175de5a">SensorFusionGlobals::MagBuffer</a></div><div class="ttdeci">MagBuffer MagBuffer</div><div class="ttdoc">mag cal constellation points </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00504">sensor_fusion.h:504</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_a3a405d845cef7219b70ffda126a81628"><div class="ttname"><a href="DecodeCommandBytes_8c.html#a3a405d845cef7219b70ffda126a81628">cmd_SVMC</a></div><div class="ttdeci">#define cmd_SVMC</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00061">DecodeCommandBytes.c:61</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_a52de366ecfe399da8ba3326fedf2f134"><div class="ttname"><a href="DecodeCommandBytes_8c.html#a52de366ecfe399da8ba3326fedf2f134">cmd_180Y</a></div><div class="ttdeci">#define cmd_180Y</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00069">DecodeCommandBytes.c:69</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_a77aec193d3c012a98fdb4e8a561e5ac0"><div class="ttname"><a href="DecodeCommandBytes_8c.html#a77aec193d3c012a98fdb4e8a561e5ac0">cmd_ALTplus</a></div><div class="ttdeci">#define cmd_ALTplus</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00056">DecodeCommandBytes.c:56</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_a2b71412b44a575e0733a1a43a266b15a"><div class="ttname"><a href="DecodeCommandBytes_8c.html#a2b71412b44a575e0733a1a43a266b15a">cmd_PA11</a></div><div class="ttdeci">#define cmd_PA11</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00088">DecodeCommandBytes.c:88</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_ae6181510482b0abbaac4d594b1bf2038"><div class="ttname"><a href="DecodeCommandBytes_8c.html#ae6181510482b0abbaac4d594b1bf2038">cmd_Q3</a></div><div class="ttdeci">#define cmd_Q3</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00048">DecodeCommandBytes.c:48</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_ac179cba01ef1197e611985a5ec22cab3"><div class="ttname"><a href="DecodeCommandBytes_8c.html#ac179cba01ef1197e611985a5ec22cab3">cmd_ALTminus</a></div><div class="ttdeci">#define cmd_ALTminus</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00057">DecodeCommandBytes.c:57</a></div></div>
<div class="ttc" id="structControlSubsystem_html_a6c5365ebe170e2ee207212da7531ccea"><div class="ttname"><a href="structControlSubsystem.html#a6c5365ebe170e2ee207212da7531ccea">ControlSubsystem::RPCPacketOn</a></div><div class="ttdeci">volatile uint8_t RPCPacketOn</div><div class="ttdoc">flag to enable roll, pitch, compass packet </div><div class="ttdef"><b>Definition:</b> <a href="control_8h_source.html#l00069">control.h:69</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_a5f469312b3865f2d3efea2edd6f8afaaa19bd87b11e82b9047ad750fb62711ba8"><div class="ttname"><a href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa19bd87b11e82b9047ad750fb62711ba8">Q3</a></div><div class="ttdoc">Quaternion derived from 3-axis accel (tilt) </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00065">sensor_fusion.h:65</a></div></div>
<div class="ttc" id="calibration__storage_8c_html_a3b4a1193ece3947c38651156293a7623"><div class="ttname"><a href="calibration__storage_8c.html#a3b4a1193ece3947c38651156293a7623">EraseAccelCalibrationFromNVM</a></div><div class="ttdeci">void EraseAccelCalibrationFromNVM(void)</div><div class="ttdef"><b>Definition:</b> <a href="calibration__storage_8c_source.html#l00188">calibration_storage.c:188</a></div></div>
<div class="ttc" id="standard__build_8h_html_a470d8d33fe0efafcc0c0835fbea14f5e"><div class="ttname"><a href="standard__build_8h.html#a470d8d33fe0efafcc0c0835fbea14f5e">FUSION_HZ</a></div><div class="ttdeci">#define FUSION_HZ</div><div class="ttdoc">(int) actual rate of fusion algorithm execution and sensor FIFO reads </div><div class="ttdef"><b>Definition:</b> <a href="standard__build_8h_source.html#l00085">standard_build.h:85</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_aa3bc6121f421435af64bce070b01dbdc"><div class="ttname"><a href="DecodeCommandBytes_8c.html#aa3bc6121f421435af64bce070b01dbdc">cmd_Q6AG</a></div><div class="ttdeci">#define cmd_Q6AG</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00052">DecodeCommandBytes.c:52</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_aa0705e68b33dccd313303c5ca6bfd2c1"><div class="ttname"><a href="DecodeCommandBytes_8c.html#aa0705e68b33dccd313303c5ca6bfd2c1">cmd_Q6MA</a></div><div class="ttdeci">#define cmd_Q6MA</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00051">DecodeCommandBytes.c:51</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_a953d0fd1fea12cf41524b0a185417f06"><div class="ttname"><a href="DecodeCommandBytes_8c.html#a953d0fd1fea12cf41524b0a185417f06">cmd_RPCplus</a></div><div class="ttdeci">#define cmd_RPCplus</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00054">DecodeCommandBytes.c:54</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_ab7d2798980bde69b87a1a81fde8a6f67"><div class="ttname"><a href="DecodeCommandBytes_8c.html#ab7d2798980bde69b87a1a81fde8a6f67">cmd_RINS</a></div><div class="ttdeci">#define cmd_RINS</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00059">DecodeCommandBytes.c:59</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_a6efbc8ec1703837c7adfa0811a2b161e"><div class="ttname"><a href="DecodeCommandBytes_8c.html#a6efbc8ec1703837c7adfa0811a2b161e">cmd_ERMC</a></div><div class="ttdeci">#define cmd_ERMC</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00065">DecodeCommandBytes.c:65</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_ae90e11c13d62e92a87653100abbae5f6"><div class="ttname"><a href="DecodeCommandBytes_8c.html#ae90e11c13d62e92a87653100abbae5f6">cmd_VGplus</a></div><div class="ttdeci">#define cmd_VGplus</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00044">DecodeCommandBytes.c:44</a></div></div>
<div class="ttc" id="precisionAccelerometer_8c_html_ab8572ce21837538a984e62035db4d89e"><div class="ttname"><a href="precisionAccelerometer_8c.html#ab8572ce21837538a984e62035db4d89e">fInitializeAccelCalibration</a></div><div class="ttdeci">void fInitializeAccelCalibration(struct AccelCalibration *pthisAccelCal, struct AccelBuffer *pthisAccelBuffer, volatile int8 *AccelCalPacketOn)</div><div class="ttdoc">Initialize the accelerometer calibration functions. </div><div class="ttdef"><b>Definition:</b> <a href="precisionAccelerometer_8c_source.html#l00034">precisionAccelerometer.c:34</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_ad85f9c00a94b924326f16034579b9039"><div class="ttname"><a href="DecodeCommandBytes_8c.html#ad85f9c00a94b924326f16034579b9039">cmd_PA02</a></div><div class="ttdeci">#define cmd_PA02</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00079">DecodeCommandBytes.c:79</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_aa0d0fdc87fd135ef2bedb030901cdb9c"><div class="ttname"><a href="sensor__fusion_8h.html#aa0d0fdc87fd135ef2bedb030901cdb9c">int16</a></div><div class="ttdeci">int16_t int16</div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00056">sensor_fusion.h:56</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_a59c9ff7a3b6b88513e8ece6ebaa0390b"><div class="ttname"><a href="DecodeCommandBytes_8c.html#a59c9ff7a3b6b88513e8ece6ebaa0390b">cmd_PA09</a></div><div class="ttdeci">#define cmd_PA09</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00086">DecodeCommandBytes.c:86</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_ad033b9f4b4e5b8be0287ae3c40276dbc"><div class="ttname"><a href="DecodeCommandBytes_8c.html#ad033b9f4b4e5b8be0287ae3c40276dbc">cmd_180X</a></div><div class="ttdeci">#define cmd_180X</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00068">DecodeCommandBytes.c:68</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_ae8e28a3f46f0d3ef5adb7d63e4088069"><div class="ttname"><a href="DecodeCommandBytes_8c.html#ae8e28a3f46f0d3ef5adb7d63e4088069">cmd_ERAC</a></div><div class="ttdeci">#define cmd_ERAC</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00064">DecodeCommandBytes.c:64</a></div></div>
<div class="ttc" id="precisionAccelerometer_8h_html_a2b9b9bab44fce8ba83b6da0bc9edb21c"><div class="ttname"><a href="precisionAccelerometer_8h.html#a2b9b9bab44fce8ba83b6da0bc9edb21c">ACCEL_CAL_AVERAGING_SECS</a></div><div class="ttdeci">#define ACCEL_CAL_AVERAGING_SECS</div><div class="ttdoc">calibration constants </div><div class="ttdef"><b>Definition:</b> <a href="precisionAccelerometer_8h_source.html#l00034">precisionAccelerometer.h:34</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_a7e4a1d4a077dd963999e128207315013"><div class="ttname"><a href="DecodeCommandBytes_8c.html#a7e4a1d4a077dd963999e128207315013">cmd_180Z</a></div><div class="ttdeci">#define cmd_180Z</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00070">DecodeCommandBytes.c:70</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_a587d3e585fef780d1e9797700bf167a1"><div class="ttname"><a href="DecodeCommandBytes_8c.html#a587d3e585fef780d1e9797700bf167a1">cmd_M90X</a></div><div class="ttdeci">#define cmd_M90X</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00071">DecodeCommandBytes.c:71</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_a571184d82a99a987a2ca72b53e2fa100"><div class="ttname"><a href="structSensorFusionGlobals.html#a571184d82a99a987a2ca72b53e2fa100">SensorFusionGlobals::iPerturbation</a></div><div class="ttdeci">volatile uint8_t iPerturbation</div><div class="ttdoc">test perturbation to be applied </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00482">sensor_fusion.h:482</a></div></div>
<div class="ttc" id="structControlSubsystem_html_a560615429c69fcefa85de0624fa6d83e"><div class="ttname"><a href="structControlSubsystem.html#a560615429c69fcefa85de0624fa6d83e">ControlSubsystem::QuaternionPacketType</a></div><div class="ttdeci">volatile quaternion_type QuaternionPacketType</div><div class="ttdoc">quaternion type transmitted over UART </div><div class="ttdef"><b>Definition:</b> <a href="control_8h_source.html#l00066">control.h:66</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_aa01c75cd9d2ed3ec5acec36d0cdfd945"><div class="ttname"><a href="DecodeCommandBytes_8c.html#aa01c75cd9d2ed3ec5acec36d0cdfd945">cmd_M90Z</a></div><div class="ttdeci">#define cmd_M90Z</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00075">DecodeCommandBytes.c:75</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_ac161c67ce40e2bd748d11aa7d89ef5c0"><div class="ttname"><a href="DecodeCommandBytes_8c.html#ac161c67ce40e2bd748d11aa7d89ef5c0">cmd_Q3G</a></div><div class="ttdeci">#define cmd_Q3G</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00050">DecodeCommandBytes.c:50</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_a87d418912514db68d46a19488a880c2f"><div class="ttname"><a href="DecodeCommandBytes_8c.html#a87d418912514db68d46a19488a880c2f">cmd_Q9</a></div><div class="ttdeci">#define cmd_Q9</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00053">DecodeCommandBytes.c:53</a></div></div>
<div class="ttc" id="structControlSubsystem_html_a527b159143188ef9b66bd4c8a6aefcdf"><div class="ttname"><a href="structControlSubsystem.html#a527b159143188ef9b66bd4c8a6aefcdf">ControlSubsystem::AngularVelocityPacketOn</a></div><div class="ttdeci">volatile uint8_t AngularVelocityPacketOn</div><div class="ttdoc">flag to enable angular velocity packet </div><div class="ttdef"><b>Definition:</b> <a href="control_8h_source.html#l00067">control.h:67</a></div></div>
<div class="ttc" id="DecodeCommandBytes_8c_html_acfa5e01345e04a72281328adee65ab90"><div class="ttname"><a href="DecodeCommandBytes_8c.html#acfa5e01345e04a72281328adee65ab90">cmd_ERYC</a></div><div class="ttdeci">#define cmd_ERYC</div><div class="ttdef"><b>Definition:</b> <a href="DecodeCommandBytes_8c_source.html#l00066">DecodeCommandBytes.c:66</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="control_8h_a2d80b68d03de87c2d3cce67273f8a165_cgraph.png" border="0" usemap="#control_8h_a2d80b68d03de87c2d3cce67273f8a165_cgraph" alt=""/></div>
<map name="control_8h_a2d80b68d03de87c2d3cce67273f8a165_cgraph" id="control_8h_a2d80b68d03de87c2d3cce67273f8a165_cgraph">
<area shape="rect" id="node2" href="fusion_8c.html#ad9cb3659204ae7a30109ceaf4d94ecec" title="fInitializeFusion" alt="" coords="261,5,372,32"/>
<area shape="rect" id="node3" href="magnetic_8c.html#a793003e431e2705d081b5073144cb2c0" title="fInitializeMagCalibration" alt="" coords="237,56,396,83"/>
<area shape="rect" id="node5" href="precisionAccelerometer_8c.html#ab8572ce21837538a984e62035db4d89e" title="Initialize the accelerometer calibration functions. " alt="" coords="233,107,400,133"/>
<area shape="rect" id="node6" href="calibration__storage_8c.html#ad08799ac63701e755fe2414b32f69b50" title="SaveMagCalibrationToNVM" alt="" coords="227,157,406,184"/>
<area shape="rect" id="node8" href="calibration__storage_8c.html#aa5684d700f135264e542f33071ed6a45" title="SaveGyroCalibrationToNVM" alt="" coords="225,208,408,235"/>
<area shape="rect" id="node9" href="calibration__storage_8c.html#a6cbf0fc4417e3a411a9685e2a92f1816" title="SaveAccelCalibrationToNVM" alt="" coords="223,259,410,285"/>
<area shape="rect" id="node10" href="calibration__storage_8c.html#a5004646fd5b485a74892b17e4a3af15b" title="EraseMagCalibrationFromNVM" alt="" coords="216,309,417,336"/>
<area shape="rect" id="node11" href="calibration__storage_8c.html#a98044dd5ba8a80f7e92b4567725e5193" title="EraseGyroCalibrationFromNVM" alt="" coords="215,360,419,387"/>
<area shape="rect" id="node12" href="calibration__storage_8c.html#a3b4a1193ece3947c38651156293a7623" title="EraseAccelCalibrationFromNVM" alt="" coords="212,411,421,437"/>
<area shape="rect" id="node4" href="matrix_8c.html#a54f510d9d257d6063412a9ed5adddd6f" title="function sets the 3x3 matrix A to the identity matrix " alt="" coords="487,81,595,108"/>
<area shape="rect" id="node7" href="driver__KSDK__NVM_8c.html#ac226b4393abef43297aa13addf70f2f1" title="NVM_SetBlockFlash" alt="" coords="469,284,612,311"/>
</map>
</div>
</p>

<p><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="control_8h_a2d80b68d03de87c2d3cce67273f8a165_icgraph.png" border="0" usemap="#control_8h_a2d80b68d03de87c2d3cce67273f8a165_icgraph" alt=""/></div>
<map name="control_8h_a2d80b68d03de87c2d3cce67273f8a165_icgraph" id="control_8h_a2d80b68d03de87c2d3cce67273f8a165_icgraph">
<area shape="rect" id="node2" href="control_8c.html#a3dc36d292be101ea1070be615293d692" title="WIRED_UART_IRQHandler" alt="" coords="225,5,403,32"/>
<area shape="rect" id="node3" href="control_8c.html#a4954d90ce002a3c089f4d19a4c862692" title="WIRELESS_UART_IRQHandler" alt="" coords="212,56,416,83"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a67029acf1be9712c5d30c625132ad958"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int8_t initializeControlPort </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structControlSubsystem.html">ControlSubsystem</a> *&#160;</td>
          <td class="paramname"><em>pComm</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Call this once to initialize structures, ports, etc. </p>
<p>Call this once to initialize structures, ports, etc. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pComm</td><td>pointer to the control subystem structure </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="control_8c_source.html#l00182">182</a> of file <a class="el" href="control_8c_source.html">control.c</a>.</p>

<p>Referenced by <a class="el" href="main__agm01__freertos__two__tasks_8c_source.html#l00072">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;{</div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;    uart_config_t   config;</div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;    <span class="keywordflow">if</span> (pComm)</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    {</div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        pComm-&gt;<a class="code" href="structControlSubsystem.html#a38d07087f0ce6da58043233d470c8c79">DefaultQuaternionPacketType</a> = <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa19bd87b11e82b9047ad750fb62711ba8">Q3</a>;    <span class="comment">// default to simplest algorithm</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        pComm-&gt;<a class="code" href="structControlSubsystem.html#a560615429c69fcefa85de0624fa6d83e">QuaternionPacketType</a> = <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa19bd87b11e82b9047ad750fb62711ba8">Q3</a>;           <span class="comment">// default to simplest algorithm</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        pComm-&gt;<a class="code" href="structControlSubsystem.html#a527b159143188ef9b66bd4c8a6aefcdf">AngularVelocityPacketOn</a> = <span class="keyword">true</span>;      <span class="comment">// transmit angular velocity packet</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        pComm-&gt;<a class="code" href="structControlSubsystem.html#a41ad90f99ac3c14b2bdce3967df14f1b">DebugPacketOn</a> = <span class="keyword">true</span>;                <span class="comment">// transmit debug packet</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;        pComm-&gt;<a class="code" href="structControlSubsystem.html#a6c5365ebe170e2ee207212da7531ccea">RPCPacketOn</a> = <span class="keyword">true</span>;                  <span class="comment">// transmit roll, pitch, compass packet</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;        pComm-&gt;<a class="code" href="structControlSubsystem.html#af46ef3a1af714f7d40707053964db4a8">AltPacketOn</a> = <span class="keyword">true</span>;                 <span class="comment">// Altitude packet</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;        pComm-&gt;<a class="code" href="structControlSubsystem.html#aa62f07fac570bf67c0832d4bf7d38e76">AccelCalPacketOn</a> = 0;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;        pComm-&gt;<a class="code" href="structControlSubsystem.html#a8c91c6fe2a5725abe8944b06e46041a5">write</a> = <a class="code" href="control_8c.html#a6d4965cc969559b94475da397011f314">writeControlPort</a>;</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;        pComm-&gt;<a class="code" href="structControlSubsystem.html#a2fc3f3736130dec532bf7f12d4091e55">stream</a> = <a class="code" href="control_8h.html#adbb4129e795ca534e4bb1649bb81b559">CreateAndSendPackets</a>;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="preprocessor">#if F_USE_WIRED_UART</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;        <span class="comment">/* Initialize WIRED UART pins below - currently duplicates code in pin_mux.c */</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;        CLOCK_EnableClock(WIRED_UART_PORT_CLKEN);</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;        PORT_SetPinMux(WIRED_UART_PORT, WIRED_UART_RX_PIN, WIRED_UART_MUX);</div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;        PORT_SetPinMux(WIRED_UART_PORT, WIRED_UART_TX_PIN, WIRED_UART_MUX);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;        UART_GetDefaultConfig(&amp;config);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;        config.baudRate_Bps = <a class="code" href="control_8c.html#a5afb52015d48cfccdedfa29349b44834">CONTROL_BAUDRATE</a>;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;        config.enableTx = <span class="keyword">true</span>;</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;        config.enableRx = <span class="keyword">true</span>;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;        config.rxFifoWatermark = 1;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;        UART_Init(WIRED_UART, &amp;config, CLOCK_GetFreq(WIRED_UART_CLKSRC));</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;        <span class="comment">/* Enable RX interrupt. */</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;        UART_EnableInterrupts(WIRED_UART, kUART_RxDataRegFullInterruptEnable |</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;                              kUART_RxOverrunInterruptEnable);</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;        EnableIRQ(WIRED_UART_IRQn);</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;<span class="preprocessor">#if F_USE_WIRELESS_UART</span></div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <span class="comment">/* Initialize WIRELESS UART pins below */</span></div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        CLOCK_EnableClock(WIRELESS_UART_PORT_CLKEN);</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        PORT_SetPinMux(WIRELESS_UART_PORT, WIRELESS_UART_RX_PIN,</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;                       WIRELESS_UART_MUX);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;        PORT_SetPinMux(WIRELESS_UART_PORT, WIRELESS_UART_TX_PIN,</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;                       WIRELESS_UART_MUX);</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;        UART_Init(WIRELESS_UART, &amp;config, CLOCK_GetFreq(WIRELESS_UART_CLKSRC));</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <a class="code" href="control_8c.html#a0022c0c45a3b736ffe21164001662b44">BlueRadios_Init</a>();</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;        <span class="comment">/* Enable RX interrupt. */</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;        UART_EnableInterrupts(WIRELESS_UART, kUART_RxDataRegFullInterruptEnable |</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                              kUART_RxOverrunInterruptEnable);</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        EnableIRQ(WIRELESS_UART_IRQn);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keywordflow">return</span> (0);</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    }</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    {</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <span class="keywordflow">return</span> (1);</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;    }</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;}</div><div class="ttc" id="structControlSubsystem_html_af46ef3a1af714f7d40707053964db4a8"><div class="ttname"><a href="structControlSubsystem.html#af46ef3a1af714f7d40707053964db4a8">ControlSubsystem::AltPacketOn</a></div><div class="ttdeci">volatile uint8_t AltPacketOn</div><div class="ttdoc">flag to enable altitude packet </div><div class="ttdef"><b>Definition:</b> <a href="control_8h_source.html#l00070">control.h:70</a></div></div>
<div class="ttc" id="structControlSubsystem_html_a2fc3f3736130dec532bf7f12d4091e55"><div class="ttname"><a href="structControlSubsystem.html#a2fc3f3736130dec532bf7f12d4091e55">ControlSubsystem::stream</a></div><div class="ttdeci">streamData_t * stream</div><div class="ttdoc">function to create packets for serial stream </div><div class="ttdef"><b>Definition:</b> <a href="control_8h_source.html#l00073">control.h:73</a></div></div>
<div class="ttc" id="structControlSubsystem_html_aa62f07fac570bf67c0832d4bf7d38e76"><div class="ttname"><a href="structControlSubsystem.html#aa62f07fac570bf67c0832d4bf7d38e76">ControlSubsystem::AccelCalPacketOn</a></div><div class="ttdeci">volatile int8_t AccelCalPacketOn</div><div class="ttdoc">variable used to coordinate accelerometer calibration </div><div class="ttdef"><b>Definition:</b> <a href="control_8h_source.html#l00071">control.h:71</a></div></div>
<div class="ttc" id="structControlSubsystem_html_a38d07087f0ce6da58043233d470c8c79"><div class="ttname"><a href="structControlSubsystem.html#a38d07087f0ce6da58043233d470c8c79">ControlSubsystem::DefaultQuaternionPacketType</a></div><div class="ttdeci">quaternion_type DefaultQuaternionPacketType</div><div class="ttdoc">default quaternion transmitted at power on </div><div class="ttdef"><b>Definition:</b> <a href="control_8h_source.html#l00065">control.h:65</a></div></div>
<div class="ttc" id="control_8c_html_a6d4965cc969559b94475da397011f314"><div class="ttname"><a href="control_8c.html#a6d4965cc969559b94475da397011f314">writeControlPort</a></div><div class="ttdeci">int8_t writeControlPort(ControlSubsystem *pComm, uint8_t buffer[], uint16_t nbytes)</div><div class="ttdef"><b>Definition:</b> <a href="control_8c_source.html#l00079">control.c:79</a></div></div>
<div class="ttc" id="control_8h_html_adbb4129e795ca534e4bb1649bb81b559"><div class="ttname"><a href="control_8h.html#adbb4129e795ca534e4bb1649bb81b559">CreateAndSendPackets</a></div><div class="ttdeci">void CreateAndSendPackets(SensorFusionGlobals *sfg, uint8_t *sUARTOutputBuffer)</div><div class="ttdoc">Called once per fusion cycle to stream information required by the NXP Sensor Fusion Toolbox...</div><div class="ttdef"><b>Definition:</b> <a href="output__stream_8c_source.html#l00144">output_stream.c:144</a></div></div>
<div class="ttc" id="structControlSubsystem_html_a41ad90f99ac3c14b2bdce3967df14f1b"><div class="ttname"><a href="structControlSubsystem.html#a41ad90f99ac3c14b2bdce3967df14f1b">ControlSubsystem::DebugPacketOn</a></div><div class="ttdeci">volatile uint8_t DebugPacketOn</div><div class="ttdoc">flag to enable debug packet </div><div class="ttdef"><b>Definition:</b> <a href="control_8h_source.html#l00068">control.h:68</a></div></div>
<div class="ttc" id="structControlSubsystem_html_a8c91c6fe2a5725abe8944b06e46041a5"><div class="ttname"><a href="structControlSubsystem.html#a8c91c6fe2a5725abe8944b06e46041a5">ControlSubsystem::write</a></div><div class="ttdeci">writePort_t * write</div><div class="ttdoc">low level function to write a char buffer to the serial stream </div><div class="ttdef"><b>Definition:</b> <a href="control_8h_source.html#l00072">control.h:72</a></div></div>
<div class="ttc" id="control_8c_html_a0022c0c45a3b736ffe21164001662b44"><div class="ttname"><a href="control_8c.html#a0022c0c45a3b736ffe21164001662b44">BlueRadios_Init</a></div><div class="ttdeci">void BlueRadios_Init(void)</div><div class="ttdoc">Used to initialize the Blue Radios Bluetooth module found on the FRDM-FXS-MULT2-B sensor shield from ...</div><div class="ttdef"><b>Definition:</b> <a href="control_8c_source.html#l00132">control.c:132</a></div></div>
<div class="ttc" id="structControlSubsystem_html_a6c5365ebe170e2ee207212da7531ccea"><div class="ttname"><a href="structControlSubsystem.html#a6c5365ebe170e2ee207212da7531ccea">ControlSubsystem::RPCPacketOn</a></div><div class="ttdeci">volatile uint8_t RPCPacketOn</div><div class="ttdoc">flag to enable roll, pitch, compass packet </div><div class="ttdef"><b>Definition:</b> <a href="control_8h_source.html#l00069">control.h:69</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_a5f469312b3865f2d3efea2edd6f8afaaa19bd87b11e82b9047ad750fb62711ba8"><div class="ttname"><a href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa19bd87b11e82b9047ad750fb62711ba8">Q3</a></div><div class="ttdoc">Quaternion derived from 3-axis accel (tilt) </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00065">sensor_fusion.h:65</a></div></div>
<div class="ttc" id="control_8c_html_a5afb52015d48cfccdedfa29349b44834"><div class="ttname"><a href="control_8c.html#a5afb52015d48cfccdedfa29349b44834">CONTROL_BAUDRATE</a></div><div class="ttdeci">#define CONTROL_BAUDRATE</div><div class="ttdoc">Baudrate to be used for serial communications. </div><div class="ttdef"><b>Definition:</b> <a href="control_8c_source.html#l00053">control.c:53</a></div></div>
<div class="ttc" id="structControlSubsystem_html_a560615429c69fcefa85de0624fa6d83e"><div class="ttname"><a href="structControlSubsystem.html#a560615429c69fcefa85de0624fa6d83e">ControlSubsystem::QuaternionPacketType</a></div><div class="ttdeci">volatile quaternion_type QuaternionPacketType</div><div class="ttdoc">quaternion type transmitted over UART </div><div class="ttdef"><b>Definition:</b> <a href="control_8h_source.html#l00066">control.h:66</a></div></div>
<div class="ttc" id="structControlSubsystem_html_a527b159143188ef9b66bd4c8a6aefcdf"><div class="ttname"><a href="structControlSubsystem.html#a527b159143188ef9b66bd4c8a6aefcdf">ControlSubsystem::AngularVelocityPacketOn</a></div><div class="ttdeci">volatile uint8_t AngularVelocityPacketOn</div><div class="ttdoc">flag to enable angular velocity packet </div><div class="ttdef"><b>Definition:</b> <a href="control_8h_source.html#l00067">control.h:67</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><img src="control_8h_a67029acf1be9712c5d30c625132ad958_cgraph.png" border="0" usemap="#control_8h_a67029acf1be9712c5d30c625132ad958_cgraph" alt=""/></div>
<map name="control_8h_a67029acf1be9712c5d30c625132ad958_cgraph" id="control_8h_a67029acf1be9712c5d30c625132ad958_cgraph">
<area shape="rect" id="node2" href="control_8c.html#a6d4965cc969559b94475da397011f314" title="writeControlPort" alt="" coords="211,5,326,32"/>
<area shape="rect" id="node4" href="control_8h.html#adbb4129e795ca534e4bb1649bb81b559" title="Called once per fusion cycle to stream information required by the NXP Sensor Fusion Toolbox..." alt="" coords="188,157,349,184"/>
<area shape="rect" id="node9" href="control_8c.html#a0022c0c45a3b736ffe21164001662b44" title="Used to initialize the Blue Radios Bluetooth module found on the FRDM&#45;FXS&#45;MULT2&#45;B sensor shield from ..." alt="" coords="213,56,325,83"/>
<area shape="rect" id="node3" href="control_8c.html#a9f548c7fc2a3dce2f1c2b0c044dbd2c8" title="myUART_WriteByte" alt="" coords="569,31,708,57"/>
<area shape="rect" id="node5" href="output__stream_8c.html#a16d1508470294835d76682195104898e" title="(OVERSAMPLE_RATIO * MAXPACKETRATEHZ) / SENSORFS " alt="" coords="428,157,491,184"/>
<area shape="rect" id="node6" href="output__stream_8c.html#a7ad6e53b35d6fc860a1299ceff40a299" title="Utility function used to place data in output buffer about to be transmitted via UART. " alt="" coords="580,233,697,260"/>
<area shape="rect" id="node7" href="output__stream_8c.html#a93db92e775dee51c4dbf2dca2aed05b3" title="sBufAppendZeros" alt="" coords="397,259,521,285"/>
<area shape="rect" id="node8" href="output__stream_8c.html#a96da70ac128170ff0d03feffa05ef769" title="readCommon" alt="" coords="410,107,509,133"/>
<area shape="rect" id="node10" href="control_8c.html#acb3383fd1d5fe2678879bb01266e7701" title="writeWirelessPort" alt="" coords="397,56,521,83"/>
</map>
</div>
</p>

<p><div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><img src="control_8h_a67029acf1be9712c5d30c625132ad958_icgraph.png" border="0" usemap="#control_8h_a67029acf1be9712c5d30c625132ad958_icgraph" alt=""/></div>
<map name="control_8h_a67029acf1be9712c5d30c625132ad958_icgraph" id="control_8h_a67029acf1be9712c5d30c625132ad958_icgraph">
<area shape="rect" id="node2" href="main__agm01__freertos__two__tasks_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="This is a FreeRTOS (dual task) implementation of the NXP sensor fusion demo build. " alt="" coords="188,5,239,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a7ad6e53b35d6fc860a1299ceff40a299"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void sBufAppendItem </td>
          <td>(</td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pDest</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t *&#160;</td>
          <td class="paramname"><em>pIndex</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t *&#160;</td>
          <td class="paramname"><em>pSource</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>iBytesToCopy</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Utility function used to place data in output buffer about to be transmitted via UART. </p>

<p>Definition at line <a class="el" href="output__stream_8c_source.html#l00059">59</a> of file <a class="el" href="output__stream_8c_source.html">output_stream.c</a>.</p>

<p>Referenced by <a class="el" href="output__stream_8c_source.html#l00144">CreateAndSendPackets()</a>, and <a class="el" href="output__stream_8c_source.html#l00092">sBufAppendZeros()</a>.</p>
<div class="fragment"><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;{</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;    uint16_t    i;  <span class="comment">// loop counter</span></div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    <span class="comment">// loop over number of bytes to add to the destination buffer</span></div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; iBytesToCopy; i++)</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    {</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;        <span class="keywordflow">switch</span> (pSource[i])</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        {</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;            <span class="keywordflow">case</span> 0x7E:</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;                <span class="comment">// special case 1: replace 0x7E (start and end byte) with 0x7D and 0x5E</span></div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;                pDest[(*pIndex)++] = 0x7D;</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;                pDest[(*pIndex)++] = 0x5E;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;            <span class="keywordflow">case</span> 0x7D:</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                <span class="comment">// special case 2: replace 0x7D with 0x7D and 0x5D</span></div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                pDest[(*pIndex)++] = 0x7D;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                pDest[(*pIndex)++] = 0x5D;</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;            <span class="keywordflow">default</span>:</div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                <span class="comment">// general case, simply add this byte without change</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                pDest[(*pIndex)++] = pSource[i];</div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;        }</div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;    }</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;}</div></div><!-- fragment -->
<p><div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><img src="control_8h_a7ad6e53b35d6fc860a1299ceff40a299_icgraph.png" border="0" usemap="#control_8h_a7ad6e53b35d6fc860a1299ceff40a299_icgraph" alt=""/></div>
<map name="control_8h_a7ad6e53b35d6fc860a1299ceff40a299_icgraph" id="control_8h_a7ad6e53b35d6fc860a1299ceff40a299_icgraph">
<area shape="rect" id="node2" href="output__stream_8c.html#adbb4129e795ca534e4bb1649bb81b559" title="Called once per fusion cycle to stream information required by the NXP Sensor Fusion Toolbox..." alt="" coords="343,5,504,32"/>
<area shape="rect" id="node5" href="output__stream_8c.html#a93db92e775dee51c4dbf2dca2aed05b3" title="sBufAppendZeros" alt="" coords="171,31,295,57"/>
<area shape="rect" id="node3" href="control_8h.html#a67029acf1be9712c5d30c625132ad958" title="Call this once to initialize structures, ports, etc. " alt="" coords="552,5,687,32"/>
<area shape="rect" id="node4" href="main__agm01__freertos__two__tasks_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="This is a FreeRTOS (dual task) implementation of the NXP sensor fusion demo build. " alt="" coords="735,5,785,32"/>
</map>
</div>
</p>

</div>
</div>
<h2 class="groupheader">Variable Documentation</h2>
<a class="anchor" id="a3b6c71dda245dccb73352c7264176527"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">uint8_t sUARTOutputBuffer[256]</td>
        </tr>
      </table>
</div><div class="memdoc">

<p>main output buffer defined in <a class="el" href="control_8c.html" title="Defines control sub-system. ">control.c</a> </p>

<p>Definition at line <a class="el" href="control_8c_source.html#l00059">59</a> of file <a class="el" href="control_8c_source.html">control.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.5-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul class="foot">
<!--    <li class="footer"> &copy; 2016 Freescale Semiconductor, Inc. All rights reserved. 
    </li> -->
	    <li class="footer"> &copy; 2016 NXP B.V. 
    </li>
  </ul>
</div>
</body>
</html>
