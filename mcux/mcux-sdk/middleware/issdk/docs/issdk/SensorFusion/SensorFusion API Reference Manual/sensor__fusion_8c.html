<!-- HTML header for doxygen 1.8.5-->
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.11"/>
<title>sensor_fusion.c File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<script src="http://www.nxp.com/files/abstract/misc/COLLATERALTEMPLATE_infocenter.js" type="text/javascript" xml:space="preserve"><!-- --></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { init_search(); });
</script>
<link href="html_custom.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="NXP_FullColor_RGB_wrapped.png"/></td>
    <td style="padding-left: 0.5em;">
    <div id="projectbrief">Sensor Fusion for Kinetis MCUs (ISSDK/KSDK version)</div>
    </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.11 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>API</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('sensor__fusion_8c.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">sensor_fusion.c File Reference</div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><div id="dynsection-0" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-0-trigger" src="closed.png" alt="+"/> Include dependency graph for sensor_fusion.c:</div>
<div id="dynsection-0-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-0-content" class="dyncontent" style="display:none;">
<div class="center"><img src="sensor__fusion_8c__incl.png" border="0" usemap="#sensor__fusion_8c" alt=""/></div>
<map name="sensor__fusion_8c" id="sensor__fusion_8c">
<area shape="rect" id="node3" href="sensor__fusion_8h.html" title="The sensor_fusion.h file implements the top level programming interface. " alt="" coords="514,155,627,181"/>
<area shape="rect" id="node10" href="magnetic_8h.html" title="Lower level magnetic calibration interface. " alt="" coords="1129,229,1215,256"/>
<area shape="rect" id="node14" href="drivers_8h.html" title="Provides function prototypes for driver level interfaces. " alt="" coords="726,80,797,107"/>
<area shape="rect" id="node18" href="status_8h.html" title="Application&#45;specific status subsystem. " alt="" coords="953,80,1023,107"/>
<area shape="rect" id="node19" href="control_8h.html" title="Defines control sub&#45;system. " alt="" coords="1047,80,1119,107"/>
<area shape="rect" id="node20" href="fusion_8h.html" title="Lower level sensor fusion interface. " alt="" coords="584,80,651,107"/>
<area shape="rect" id="node11" href="precisionAccelerometer_8h.html" title="Implements accelerometer calibration routines. " alt="" coords="723,229,893,256"/>
<area shape="rect" id="node12" href="orientation_8h.html" title="Functions to convert between various orientation representations. " alt="" coords="917,229,1011,256"/>
<area shape="rect" id="node13" href="matrix_8h.html" title="Matrix manipulation functions. " alt="" coords="1035,229,1104,256"/>
</map>
</div>
</div>
<p><a href="sensor__fusion_8c_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a741fd2193cc58c09b692d1ae2b7a81e8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sensor__fusion_8c.html#a741fd2193cc58c09b692d1ae2b7a81e8">setStatus</a> (<a class="el" href="structSensorFusionGlobals.html">SensorFusionGlobals</a> *<a class="el" href="main__freertos__two__tasks_8c.html#afa81c629d378fe700f351a1bce411ad5">sfg</a>, <a class="el" href="sensor__fusion_8h.html#a69ee883e1c22b117df163c0bd83f66dd">fusion_status_t</a> status)</td></tr>
<tr class="separator:a741fd2193cc58c09b692d1ae2b7a81e8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae96e36747e6a1aabbec1381f15132ec6"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sensor__fusion_8c.html#ae96e36747e6a1aabbec1381f15132ec6">queueStatus</a> (<a class="el" href="structSensorFusionGlobals.html">SensorFusionGlobals</a> *<a class="el" href="main__freertos__two__tasks_8c.html#afa81c629d378fe700f351a1bce411ad5">sfg</a>, <a class="el" href="sensor__fusion_8h.html#a69ee883e1c22b117df163c0bd83f66dd">fusion_status_t</a> status)</td></tr>
<tr class="separator:ae96e36747e6a1aabbec1381f15132ec6"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aa13c4a9f07f3a2abfdb2e0808e5752d4"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sensor__fusion_8c.html#aa13c4a9f07f3a2abfdb2e0808e5752d4">updateStatus</a> (<a class="el" href="structSensorFusionGlobals.html">SensorFusionGlobals</a> *<a class="el" href="main__freertos__two__tasks_8c.html#afa81c629d378fe700f351a1bce411ad5">sfg</a>)</td></tr>
<tr class="separator:aa13c4a9f07f3a2abfdb2e0808e5752d4"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a142a0a30c123f8acf79a3e8e5072cad8"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sensor__fusion_8c.html#a142a0a30c123f8acf79a3e8e5072cad8">testStatus</a> (<a class="el" href="structSensorFusionGlobals.html">SensorFusionGlobals</a> *<a class="el" href="main__freertos__two__tasks_8c.html#afa81c629d378fe700f351a1bce411ad5">sfg</a>)</td></tr>
<tr class="separator:a142a0a30c123f8acf79a3e8e5072cad8"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a43b44018042fabb5179c2e62277cc942"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sensor__fusion_8c.html#a43b44018042fabb5179c2e62277cc942">initSensorFusionGlobals</a> (<a class="el" href="structSensorFusionGlobals.html">SensorFusionGlobals</a> *<a class="el" href="main__freertos__two__tasks_8c.html#afa81c629d378fe700f351a1bce411ad5">sfg</a>, <a class="el" href="structStatusSubsystem.html">StatusSubsystem</a> *pStatusSubsystem, <a class="el" href="structControlSubsystem.html">ControlSubsystem</a> *pControlSubsystem)</td></tr>
<tr class="separator:a43b44018042fabb5179c2e62277cc942"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a45ee1600720deae228f488e6246a747b"><td class="memItemLeft" align="right" valign="top">int8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sensor__fusion_8c.html#a45ee1600720deae228f488e6246a747b">installSensor</a> (<a class="el" href="structSensorFusionGlobals.html">SensorFusionGlobals</a> *<a class="el" href="main__freertos__two__tasks_8c.html#afa81c629d378fe700f351a1bce411ad5">sfg</a>, <a class="el" href="structPhysicalSensor.html">PhysicalSensor</a> *pSensor, uint16_t addr, uint16_t schedule, void *bus_driver, <a class="el" href="sensor__fusion_8h.html#a94a511080fe3acc46bcee1a85f25432c">initializeSensor_t</a> *initialize, <a class="el" href="sensor__fusion_8h.html#a2c12de378ddfbb05f2f9549b62eddb87">readSensor_t</a> *read)</td></tr>
<tr class="separator:a45ee1600720deae228f488e6246a747b"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ae748e1330b5a94783c6d4ea2ad9e4f28"><td class="memItemLeft" align="right" valign="top">int8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sensor__fusion_8c.html#ae748e1330b5a94783c6d4ea2ad9e4f28">initializeSensors</a> (<a class="el" href="structSensorFusionGlobals.html">SensorFusionGlobals</a> *<a class="el" href="main__freertos__two__tasks_8c.html#afa81c629d378fe700f351a1bce411ad5">sfg</a>)</td></tr>
<tr class="separator:ae748e1330b5a94783c6d4ea2ad9e4f28"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaf8b47198fa614f0b50265addf44a8b0"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sensor__fusion_8c.html#aaf8b47198fa614f0b50265addf44a8b0">processMagData</a> (<a class="el" href="structSensorFusionGlobals.html">SensorFusionGlobals</a> *<a class="el" href="main__freertos__two__tasks_8c.html#afa81c629d378fe700f351a1bce411ad5">sfg</a>)</td></tr>
<tr class="separator:aaf8b47198fa614f0b50265addf44a8b0"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a0d688188b65f43d38ac760a79d9eb116"><td class="memItemLeft" align="right" valign="top">int8_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sensor__fusion_8c.html#a0d688188b65f43d38ac760a79d9eb116">readSensors</a> (<a class="el" href="structSensorFusionGlobals.html">SensorFusionGlobals</a> *<a class="el" href="main__freertos__two__tasks_8c.html#afa81c629d378fe700f351a1bce411ad5">sfg</a>, uint16_t read_loop_counter)</td></tr>
<tr class="separator:a0d688188b65f43d38ac760a79d9eb116"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aef2b1f23f820d2b513bc827f8baffd0d"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sensor__fusion_8c.html#aef2b1f23f820d2b513bc827f8baffd0d">conditionSensorReadings</a> (<a class="el" href="structSensorFusionGlobals.html">SensorFusionGlobals</a> *<a class="el" href="main__freertos__two__tasks_8c.html#afa81c629d378fe700f351a1bce411ad5">sfg</a>)</td></tr>
<tr class="separator:aef2b1f23f820d2b513bc827f8baffd0d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ac57932c39d665755aeee1e62fac763e3"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sensor__fusion_8c.html#ac57932c39d665755aeee1e62fac763e3">zeroArray</a> (<a class="el" href="structStatusSubsystem.html">StatusSubsystem</a> *pStatus, void *data, uint16_t size, uint16_t numElements, uint8_t check)</td></tr>
<tr class="separator:ac57932c39d665755aeee1e62fac763e3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a9af8710b3e87acd2a33e7988b2d75b6c"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sensor__fusion_8c.html#a9af8710b3e87acd2a33e7988b2d75b6c">clearFIFOs</a> (<a class="el" href="structSensorFusionGlobals.html">SensorFusionGlobals</a> *<a class="el" href="main__freertos__two__tasks_8c.html#afa81c629d378fe700f351a1bce411ad5">sfg</a>)</td></tr>
<tr class="separator:a9af8710b3e87acd2a33e7988b2d75b6c"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a8b90119fee979d0309cc923bf1fad543"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sensor__fusion_8c.html#a8b90119fee979d0309cc923bf1fad543">runFusion</a> (<a class="el" href="structSensorFusionGlobals.html">SensorFusionGlobals</a> *<a class="el" href="main__freertos__two__tasks_8c.html#afa81c629d378fe700f351a1bce411ad5">sfg</a>)</td></tr>
<tr class="separator:a8b90119fee979d0309cc923bf1fad543"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab088da7731ffdf25710a364a7f88b224"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sensor__fusion_8c.html#ab088da7731ffdf25710a364a7f88b224">initializeFusionEngine</a> (<a class="el" href="structSensorFusionGlobals.html">SensorFusionGlobals</a> *<a class="el" href="main__freertos__two__tasks_8c.html#afa81c629d378fe700f351a1bce411ad5">sfg</a>)</td></tr>
<tr class="separator:ab088da7731ffdf25710a364a7f88b224"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a2686eeb8ae44e588362478db1f757a0e"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sensor__fusion_8c.html#a2686eeb8ae44e588362478db1f757a0e">conditionSample</a> (int16_t sample[3])</td></tr>
<tr class="separator:a2686eeb8ae44e588362478db1f757a0e"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:aaed8e08f6d3e766cdf1314193f6b124a"><td class="memItemLeft" align="right" valign="top">void&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="sensor__fusion_8c.html#aaed8e08f6d3e766cdf1314193f6b124a">addToFifo</a> (<a class="el" href="unionFifoSensor.html">FifoSensor</a> *sensor, uint16_t maxFifoSize, int16_t sample[3])</td></tr>
<tr class="separator:aaed8e08f6d3e766cdf1314193f6b124a"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="aaed8e08f6d3e766cdf1314193f6b124a"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void addToFifo </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="unionFifoSensor.html">FifoSensor</a> *&#160;</td>
          <td class="paramname"><em>sensor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>maxFifoSize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">int16_t&#160;</td>
          <td class="paramname"><em>sample</em>[3]&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>addToFifo is called from within sensor driver read functions </p>
<p>addToFifo is called from within sensor driver read functions to transfer new readings into the sensor structure corresponding to accel, gyro or mag. This function ensures that the software FIFOs are not overrun.</p>
<p>example usage: if (status==SENSOR_ERROR_NONE) addToFifo((FifoSensor*) &amp;(sfg-&gt;Mag), MAG_FIFO_SIZE, sample); </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sensor</td><td>pointer to structure of type <a class="el" href="structAccelSensor.html" title="The AccelSensor structure stores raw and processed measurements for a 3-axis accelerometer. ">AccelSensor</a>, <a class="el" href="structMagSensor.html" title="The MagSensor structure stores raw and processed measurements for a 3-axis magnetic sensor...">MagSensor</a> or <a class="el" href="structGyroSensor.html" title="The GyroSensor structure stores raw and processed measurements for a 3-axis gyroscope. ">GyroSensor</a> </td></tr>
    <tr><td class="paramname">maxFifoSize</td><td>the size of the software (not hardware) FIFO </td></tr>
    <tr><td class="paramname">sample</td><td>the sample to add </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="sensor__fusion_8c_source.html#l00531">531</a> of file <a class="el" href="sensor__fusion_8c_source.html">sensor_fusion.c</a>.</p>

<p>Referenced by <a class="el" href="driver__FXLS8471Q_8c_source.html#l00177">FXLS8471Q_Read()</a>, <a class="el" href="driver__FXOS8700_8c_source.html#l00151">FXOS8700_Init()</a>, <a class="el" href="driver__FXOS8700_8c_source.html#l00236">FXOS8700_ReadMagData()</a>, and <a class="el" href="driver__MAG3110_8c_source.html#l00134">MAG3110_Read()</a>.</p>
<div class="fragment"><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;{</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;  <span class="comment">// Note that FifoSensor is a union of GyroSensor, MagSensor and AccelSensor.</span></div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;  <span class="comment">// All contain FIFO structures in the same location.  We use the Accel</span></div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;  <span class="comment">// structure to index here.</span></div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;  <span class="comment">// example usage: if (status==SENSOR_ERROR_NONE) addToFifo((FifoSensor*) &amp;(sfg-&gt;Mag), MAG_FIFO_SIZE, sample);</span></div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;    uint8_t fifoCount = sensor-&gt;<a class="code" href="unionFifoSensor.html#a161d2e1357adc38f1f239b6c63032031">Accel</a>.<a class="code" href="structAccelSensor.html#ae67083bb4e11d18f8d4c50cc43392e38">iFIFOCount</a>;</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keywordflow">if</span> (fifoCount &lt; maxFifoSize) {</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;        <span class="comment">// we have room for the new sample</span></div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;        sensor-&gt;<a class="code" href="unionFifoSensor.html#a161d2e1357adc38f1f239b6c63032031">Accel</a>.<a class="code" href="structAccelSensor.html#aaec99643952f6e70fa8a09f1211ec3ee">iGsFIFO</a>[fifoCount][<a class="code" href="sensor__fusion_8h.html#a48bbd27e913de8d7749dff9dec2fe816">CHX</a>] = sample[<a class="code" href="sensor__fusion_8h.html#a48bbd27e913de8d7749dff9dec2fe816">CHX</a>];</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;        sensor-&gt;<a class="code" href="unionFifoSensor.html#a161d2e1357adc38f1f239b6c63032031">Accel</a>.<a class="code" href="structAccelSensor.html#aaec99643952f6e70fa8a09f1211ec3ee">iGsFIFO</a>[fifoCount][<a class="code" href="sensor__fusion_8h.html#a6a25024f52cc6bea13d19f8b68456cea">CHY</a>] = sample[<a class="code" href="sensor__fusion_8h.html#a6a25024f52cc6bea13d19f8b68456cea">CHY</a>];</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;        sensor-&gt;<a class="code" href="unionFifoSensor.html#a161d2e1357adc38f1f239b6c63032031">Accel</a>.<a class="code" href="structAccelSensor.html#aaec99643952f6e70fa8a09f1211ec3ee">iGsFIFO</a>[fifoCount][<a class="code" href="sensor__fusion_8h.html#a76143891435bdd7248857e45b93521ed">CHZ</a>] = sample[<a class="code" href="sensor__fusion_8h.html#a76143891435bdd7248857e45b93521ed">CHZ</a>];</div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        sensor-&gt;<a class="code" href="unionFifoSensor.html#a161d2e1357adc38f1f239b6c63032031">Accel</a>.<a class="code" href="structAccelSensor.html#ae67083bb4e11d18f8d4c50cc43392e38">iFIFOCount</a> += 1;</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;        sensor-&gt;<a class="code" href="unionFifoSensor.html#a161d2e1357adc38f1f239b6c63032031">Accel</a>.<a class="code" href="structAccelSensor.html#a5bd93348c4a2cb5a2891879388b08f12">iFIFOExceeded</a> = 0;</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;        <span class="comment">//there is no room for a new sample</span></div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;        sensor-&gt;<a class="code" href="unionFifoSensor.html#a161d2e1357adc38f1f239b6c63032031">Accel</a>.<a class="code" href="structAccelSensor.html#a5bd93348c4a2cb5a2891879388b08f12">iFIFOExceeded</a> += 1;</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;    }</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;}</div><div class="ttc" id="structAccelSensor_html_aaec99643952f6e70fa8a09f1211ec3ee"><div class="ttname"><a href="structAccelSensor.html#aaec99643952f6e70fa8a09f1211ec3ee">AccelSensor::iGsFIFO</a></div><div class="ttdeci">int16_t iGsFIFO[ACCEL_FIFO_SIZE][3]</div><div class="ttdoc">FIFO measurements (counts) </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00211">sensor_fusion.h:211</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_a6a25024f52cc6bea13d19f8b68456cea"><div class="ttname"><a href="sensor__fusion_8h.html#a6a25024f52cc6bea13d19f8b68456cea">CHY</a></div><div class="ttdeci">#define CHY</div><div class="ttdoc">Used to access Y-channel entries in various data data structures. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00077">sensor_fusion.h:77</a></div></div>
<div class="ttc" id="structAccelSensor_html_a5bd93348c4a2cb5a2891879388b08f12"><div class="ttname"><a href="structAccelSensor.html#a5bd93348c4a2cb5a2891879388b08f12">AccelSensor::iFIFOExceeded</a></div><div class="ttdeci">uint16_t iFIFOExceeded</div><div class="ttdoc">Number of samples received in excess of software FIFO size. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00210">sensor_fusion.h:210</a></div></div>
<div class="ttc" id="unionFifoSensor_html_a161d2e1357adc38f1f239b6c63032031"><div class="ttname"><a href="unionFifoSensor.html#a161d2e1357adc38f1f239b6c63032031">FifoSensor::Accel</a></div><div class="ttdeci">AccelSensor Accel</div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00269">sensor_fusion.h:269</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_a76143891435bdd7248857e45b93521ed"><div class="ttname"><a href="sensor__fusion_8h.html#a76143891435bdd7248857e45b93521ed">CHZ</a></div><div class="ttdeci">#define CHZ</div></div>
<div class="ttc" id="sensor__fusion_8h_html_a48bbd27e913de8d7749dff9dec2fe816"><div class="ttname"><a href="sensor__fusion_8h.html#a48bbd27e913de8d7749dff9dec2fe816">CHX</a></div><div class="ttdeci">#define CHX</div><div class="ttdoc">Used to access X-channel entries in various data data structures. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00076">sensor_fusion.h:76</a></div></div>
<div class="ttc" id="structAccelSensor_html_ae67083bb4e11d18f8d4c50cc43392e38"><div class="ttname"><a href="structAccelSensor.html#ae67083bb4e11d18f8d4c50cc43392e38">AccelSensor::iFIFOCount</a></div><div class="ttdeci">uint8_t iFIFOCount</div><div class="ttdoc">number of measurements read from FIFO </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00209">sensor_fusion.h:209</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-1" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-1-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-1-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-1-content" class="dyncontent" style="display:none;">
<div class="center"><img src="sensor__fusion_8c_aaed8e08f6d3e766cdf1314193f6b124a_icgraph.png" border="0" usemap="#sensor__fusion_8c_aaed8e08f6d3e766cdf1314193f6b124a_icgraph" alt=""/></div>
<map name="sensor__fusion_8c_aaed8e08f6d3e766cdf1314193f6b124a_icgraph" id="sensor__fusion_8c_aaed8e08f6d3e766cdf1314193f6b124a_icgraph">
<area shape="rect" id="node2" href="drivers_8h.html#a33189bcbbd5761f2b9b5032fd499e0ea" title="FXLS8471Q_Read" alt="" coords="155,5,283,32"/>
<area shape="rect" id="node3" href="drivers_8h.html#a905984cc5f2e42228183217f6d071fb8" title="FXOS8700_Init" alt="" coords="360,56,468,83"/>
<area shape="rect" id="node5" href="driver__FXOS8700_8c.html#a426c0f9617cbeffebfeaadd6446c3bc2" title="FXOS8700_ReadMagData" alt="" coords="132,107,305,133"/>
<area shape="rect" id="node7" href="drivers_8h.html#a814ed032bb557dfa5bd0349d06b92d26" title="MAG3110_Read" alt="" coords="160,157,277,184"/>
<area shape="rect" id="node4" href="main__agm01__freertos__two__tasks_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="This is a FreeRTOS (dual task) implementation of the NXP sensor fusion demo build. " alt="" coords="523,81,573,108"/>
<area shape="rect" id="node6" href="drivers_8h.html#a15f78e72d6a7dec25d95d97fa4c8d00e" title="FXOS8700_Read" alt="" coords="353,107,475,133"/>
<area shape="rect" id="node8" href="main__freertos__agm02_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="This is a FreeRTOS (dual task) implementation of the NXP sensor fusion demo build. " alt="" coords="389,157,439,184"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a9af8710b3e87acd2a33e7988b2d75b6c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void clearFIFOs </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSensorFusionGlobals.html">SensorFusionGlobals</a> *&#160;</td>
          <td class="paramname"><em>sfg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Function to clear FIFO at the end of each fusion computation. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sfg</td><td>Global data structure pointer </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="sensor__fusion_8c_source.html#l00363">363</a> of file <a class="el" href="sensor__fusion_8c_source.html">sensor_fusion.c</a>.</p>

<p>Referenced by <a class="el" href="sensor__fusion_8c_source.html#l00471">initializeFusionEngine()</a>, <a class="el" href="sensor__fusion_8c_source.html#l00068">initSensorFusionGlobals()</a>, and <a class="el" href="sensor__fusion_8c_source.html#l00386">runFusion()</a>.</p>
<div class="fragment"><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                                          {</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;  <span class="comment">// We only clear FIFOs if the sensors are enabled.  This allows us</span></div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;  <span class="comment">// to continue to use these values when we&#39;ve shut higher power consumption</span></div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;  <span class="comment">// sensors down during periods of no activity.</span></div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;<span class="preprocessor">#if F_USING_ACCEL</span></div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;    sfg-&gt;Accel.iFIFOCount=0;</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;    sfg-&gt;Accel.iFIFOExceeded = <span class="keyword">false</span>;</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;<span class="preprocessor">#if F_USING_MAG</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a876af8fddc05153d04bda2d8a8107819">Mag</a>.<a class="code" href="structMagSensor.html#ae67083bb4e11d18f8d4c50cc43392e38">iFIFOCount</a>=0;</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a876af8fddc05153d04bda2d8a8107819">Mag</a>.<a class="code" href="structMagSensor.html#a5bd93348c4a2cb5a2891879388b08f12">iFIFOExceeded</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;<span class="preprocessor">#if F_USING_GYRO</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    sfg-&gt;Gyro.iFIFOCount=0;</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;    sfg-&gt;Gyro.iFIFOExceeded = <span class="keyword">false</span>;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;}</div><div class="ttc" id="structSensorFusionGlobals_html_a876af8fddc05153d04bda2d8a8107819"><div class="ttname"><a href="structSensorFusionGlobals.html#a876af8fddc05153d04bda2d8a8107819">SensorFusionGlobals::Mag</a></div><div class="ttdeci">MagSensor Mag</div><div class="ttdoc">magnetometer storage </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00492">sensor_fusion.h:492</a></div></div>
<div class="ttc" id="structMagSensor_html_ae67083bb4e11d18f8d4c50cc43392e38"><div class="ttname"><a href="structMagSensor.html#ae67083bb4e11d18f8d4c50cc43392e38">MagSensor::iFIFOCount</a></div><div class="ttdeci">uint8_t iFIFOCount</div><div class="ttdoc">number of measurements read from FIFO </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00231">sensor_fusion.h:231</a></div></div>
<div class="ttc" id="structMagSensor_html_a5bd93348c4a2cb5a2891879388b08f12"><div class="ttname"><a href="structMagSensor.html#a5bd93348c4a2cb5a2891879388b08f12">MagSensor::iFIFOExceeded</a></div><div class="ttdeci">uint16_t iFIFOExceeded</div><div class="ttdoc">Number of samples received in excess of software FIFO size. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00232">sensor_fusion.h:232</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-2" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-2-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-2-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-2-content" class="dyncontent" style="display:none;">
<div class="center"><img src="sensor__fusion_8c_a9af8710b3e87acd2a33e7988b2d75b6c_icgraph.png" border="0" usemap="#sensor__fusion_8c_a9af8710b3e87acd2a33e7988b2d75b6c_icgraph" alt=""/></div>
<map name="sensor__fusion_8c_a9af8710b3e87acd2a33e7988b2d75b6c_icgraph" id="sensor__fusion_8c_a9af8710b3e87acd2a33e7988b2d75b6c_icgraph">
<area shape="rect" id="node2" href="sensor__fusion_8c.html#ab088da7731ffdf25710a364a7f88b224" title="This function is responsible for initializing the system prior to starting the main fusion loop..." alt="" coords="140,5,288,32"/>
<area shape="rect" id="node3" href="sensor__fusion_8h.html#a367d92b99365a8143700b76439915d65" title="utility function to insert default values in the top level structure " alt="" coords="336,56,499,83"/>
<area shape="rect" id="node5" href="sensor__fusion_8c.html#a8b90119fee979d0309cc923bf1fad543" title="runFusion the top level call that actually runs the sensor fusion. This is a utility function which m..." alt="" coords="175,107,253,133"/>
<area shape="rect" id="node4" href="main__agm01__freertos__two__tasks_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="This is a FreeRTOS (dual task) implementation of the NXP sensor fusion demo build. " alt="" coords="547,56,597,83"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a2686eeb8ae44e588362478db1f757a0e"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void conditionSample </td>
          <td>(</td>
          <td class="paramtype">int16_t&#160;</td>
          <td class="paramname"><em>sample</em>[3]</td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>conditionSample ensures that we never encounter the maximum negative two's complement value for a 16-bit variable (-32768). </p>
<p>conditionSample ensures that we never encounter the maximum negative two's complement value for a 16-bit variable (-32768). This value cannot be negated, because the maximum positive value is +32767. We need the ability to negate to gaurantee that subsequent HAL operations can be run successfully. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sample</td><td>16-bit register value from triaxial sensor read </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="sensor__fusion_8c_source.html#l00519">519</a> of file <a class="el" href="sensor__fusion_8c_source.html">sensor_fusion.c</a>.</p>

<p>Referenced by <a class="el" href="driver__FXLS8471Q_8c_source.html#l00177">FXLS8471Q_Read()</a>, <a class="el" href="driver__FXOS8700_8c_source.html#l00151">FXOS8700_Init()</a>, <a class="el" href="driver__FXOS8700_8c_source.html#l00236">FXOS8700_ReadMagData()</a>, and <a class="el" href="driver__MAG3110_8c_source.html#l00134">MAG3110_Read()</a>.</p>
<div class="fragment"><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;{</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="comment">// This function should be called for every 16 bit sample read from sensor hardware.</span></div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;    <span class="comment">// It is responsible for making sure that we never pass on the value of -32768.</span></div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;    <span class="comment">// That value cannot be properly negated using 16-bit twos complement math.</span></div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    <span class="comment">// The ability to be later negated is required for general compatibility</span></div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="comment">// with possible HAL (Hardware abstraction logic) which is run later in</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;    <span class="comment">// the processing pipeline.</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;    <span class="keywordflow">if</span> (sample[<a class="code" href="sensor__fusion_8h.html#a48bbd27e913de8d7749dff9dec2fe816">CHX</a>] == -32768) sample[<a class="code" href="sensor__fusion_8h.html#a48bbd27e913de8d7749dff9dec2fe816">CHX</a>]++;</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keywordflow">if</span> (sample[<a class="code" href="sensor__fusion_8h.html#a6a25024f52cc6bea13d19f8b68456cea">CHY</a>] == -32768) sample[<a class="code" href="sensor__fusion_8h.html#a6a25024f52cc6bea13d19f8b68456cea">CHY</a>]++;</div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;    <span class="keywordflow">if</span> (sample[<a class="code" href="sensor__fusion_8h.html#a76143891435bdd7248857e45b93521ed">CHZ</a>] == -32768) sample[<a class="code" href="sensor__fusion_8h.html#a76143891435bdd7248857e45b93521ed">CHZ</a>]++;</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;}</div><div class="ttc" id="sensor__fusion_8h_html_a6a25024f52cc6bea13d19f8b68456cea"><div class="ttname"><a href="sensor__fusion_8h.html#a6a25024f52cc6bea13d19f8b68456cea">CHY</a></div><div class="ttdeci">#define CHY</div><div class="ttdoc">Used to access Y-channel entries in various data data structures. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00077">sensor_fusion.h:77</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_a76143891435bdd7248857e45b93521ed"><div class="ttname"><a href="sensor__fusion_8h.html#a76143891435bdd7248857e45b93521ed">CHZ</a></div><div class="ttdeci">#define CHZ</div></div>
<div class="ttc" id="sensor__fusion_8h_html_a48bbd27e913de8d7749dff9dec2fe816"><div class="ttname"><a href="sensor__fusion_8h.html#a48bbd27e913de8d7749dff9dec2fe816">CHX</a></div><div class="ttdeci">#define CHX</div><div class="ttdoc">Used to access X-channel entries in various data data structures. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00076">sensor_fusion.h:76</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-3" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-3-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-3-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-3-content" class="dyncontent" style="display:none;">
<div class="center"><img src="sensor__fusion_8c_a2686eeb8ae44e588362478db1f757a0e_icgraph.png" border="0" usemap="#sensor__fusion_8c_a2686eeb8ae44e588362478db1f757a0e_icgraph" alt=""/></div>
<map name="sensor__fusion_8c_a2686eeb8ae44e588362478db1f757a0e_icgraph" id="sensor__fusion_8c_a2686eeb8ae44e588362478db1f757a0e_icgraph">
<area shape="rect" id="node2" href="drivers_8h.html#a33189bcbbd5761f2b9b5032fd499e0ea" title="FXLS8471Q_Read" alt="" coords="195,5,323,32"/>
<area shape="rect" id="node3" href="drivers_8h.html#a905984cc5f2e42228183217f6d071fb8" title="FXOS8700_Init" alt="" coords="400,56,508,83"/>
<area shape="rect" id="node5" href="driver__FXOS8700_8c.html#a426c0f9617cbeffebfeaadd6446c3bc2" title="FXOS8700_ReadMagData" alt="" coords="172,107,345,133"/>
<area shape="rect" id="node7" href="drivers_8h.html#a814ed032bb557dfa5bd0349d06b92d26" title="MAG3110_Read" alt="" coords="200,157,317,184"/>
<area shape="rect" id="node4" href="main__agm01__freertos__two__tasks_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="This is a FreeRTOS (dual task) implementation of the NXP sensor fusion demo build. " alt="" coords="563,81,613,108"/>
<area shape="rect" id="node6" href="drivers_8h.html#a15f78e72d6a7dec25d95d97fa4c8d00e" title="FXOS8700_Read" alt="" coords="393,107,515,133"/>
<area shape="rect" id="node8" href="main__freertos__agm02_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="This is a FreeRTOS (dual task) implementation of the NXP sensor fusion demo build. " alt="" coords="429,157,479,184"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aef2b1f23f820d2b513bc827f8baffd0d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void conditionSensorReadings </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSensorFusionGlobals.html">SensorFusionGlobals</a> *&#160;</td>
          <td class="paramname"><em>sfg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p><a class="el" href="sensor__fusion_8c.html#aef2b1f23f820d2b513bc827f8baffd0d" title="conditionSensorReadings() transforms raw software FIFO readings into forms that can be consumed by th...">conditionSensorReadings()</a> transforms raw software FIFO readings into forms that can be consumed by the sensor fusion engine. This include sample averaging and (in the case of the gyro) integrations, applying hardware abstraction layers, and calibration functions. This function is normally involved via the "sfg." global pointer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sfg</td><td>Global data structure pointer </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="sensor__fusion_8c_source.html#l00305">305</a> of file <a class="el" href="sensor__fusion_8c_source.html">sensor_fusion.c</a>.</p>

<p>Referenced by <a class="el" href="sensor__fusion_8c_source.html#l00068">initSensorFusionGlobals()</a>.</p>
<div class="fragment"><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                                                       {</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;<span class="preprocessor">#if F_USING_ACCEL</span></div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordflow">if</span> (sfg-&gt;Accel.isEnabled) processAccelData(sfg);</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;<span class="preprocessor">#if F_USING_MAG</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;    <span class="keywordflow">if</span> (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a876af8fddc05153d04bda2d8a8107819">Mag</a>.<a class="code" href="structMagSensor.html#aaa521633aa149ccf8d2eab52b4a2abe0">isEnabled</a>) <a class="code" href="sensor__fusion_8c.html#aaf8b47198fa614f0b50265addf44a8b0">processMagData</a>(sfg);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;<span class="preprocessor">#if F_USING_GYRO</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;    <span class="keywordflow">if</span> (sfg-&gt;Gyro.isEnabled) processGyroData(sfg);</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;}</div><div class="ttc" id="sensor__fusion_8c_html_aaf8b47198fa614f0b50265addf44a8b0"><div class="ttname"><a href="sensor__fusion_8c.html#aaf8b47198fa614f0b50265addf44a8b0">processMagData</a></div><div class="ttdeci">void processMagData(SensorFusionGlobals *sfg)</div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8c_source.html#l00209">sensor_fusion.c:209</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_a876af8fddc05153d04bda2d8a8107819"><div class="ttname"><a href="structSensorFusionGlobals.html#a876af8fddc05153d04bda2d8a8107819">SensorFusionGlobals::Mag</a></div><div class="ttdeci">MagSensor Mag</div><div class="ttdoc">magnetometer storage </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00492">sensor_fusion.h:492</a></div></div>
<div class="ttc" id="structMagSensor_html_aaa521633aa149ccf8d2eab52b4a2abe0"><div class="ttname"><a href="structMagSensor.html#aaa521633aa149ccf8d2eab52b4a2abe0">MagSensor::isEnabled</a></div><div class="ttdeci">bool isEnabled</div><div class="ttdoc">true if the device is sampling </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00230">sensor_fusion.h:230</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-4" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-4-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-4-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-4-content" class="dyncontent" style="display:none;">
<div class="center"><img src="sensor__fusion_8c_aef2b1f23f820d2b513bc827f8baffd0d_cgraph.png" border="0" usemap="#sensor__fusion_8c_aef2b1f23f820d2b513bc827f8baffd0d_cgraph" alt=""/></div>
<map name="sensor__fusion_8c_aef2b1f23f820d2b513bc827f8baffd0d_cgraph" id="sensor__fusion_8c_aef2b1f23f820d2b513bc827f8baffd0d_cgraph">
<area shape="rect" id="node2" href="sensor__fusion_8c.html#aaf8b47198fa614f0b50265addf44a8b0" title="processMagData" alt="" coords="223,107,343,133"/>
<area shape="rect" id="node3" href="hal__frdm__fxs__mult2__b_8c.html#a61ed96ce5838a7f7952539b7d7d944dc" title="Apply the magnetometer Hardware Abstraction Layer. " alt="" coords="405,5,511,32"/>
<area shape="rect" id="node4" href="magnetic_8c.html#a0a0ba578c5de9f06431db84b2b8e3f9a" title="fInvertMagCal" alt="" coords="409,56,507,83"/>
<area shape="rect" id="node5" href="magnetic_8c.html#a3b07f7334d06c86a3e18732a5106a951" title="iUpdateMagBuffer" alt="" coords="396,107,520,133"/>
<area shape="rect" id="node6" href="magnetic_8c.html#a2c2da80362a7b97574c6b60972399b73" title="fRunMagCalibration" alt="" coords="391,157,525,184"/>
<area shape="rect" id="node10" href="hal__frdm__fxs__mult2__b_8c.html#a9b489a682e07db8c11a2121ede929e9e" title="Apply the gyroscope Hardware Abstraction Layer. " alt="" coords="404,208,512,235"/>
<area shape="rect" id="node7" href="magnetic_8c.html#ab6f86b6d28bc71b2ce3afc7c374c462e" title="fUpdateMagCalibration4Slice" alt="" coords="577,107,765,133"/>
<area shape="rect" id="node8" href="magnetic_8c.html#aad08380c7f86edfe8480d6a7555172b8" title="fUpdateMagCalibration7Slice" alt="" coords="577,157,765,184"/>
<area shape="rect" id="node9" href="magnetic_8c.html#a5798cb74fc7f5956db643d09a3750e09" title="fUpdateMagCalibration10Slice" alt="" coords="573,208,768,235"/>
</map>
</div>
</p>

<p><div id="dynsection-5" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-5-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-5-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-5-content" class="dyncontent" style="display:none;">
<div class="center"><img src="sensor__fusion_8c_aef2b1f23f820d2b513bc827f8baffd0d_icgraph.png" border="0" usemap="#sensor__fusion_8c_aef2b1f23f820d2b513bc827f8baffd0d_icgraph" alt=""/></div>
<map name="sensor__fusion_8c_aef2b1f23f820d2b513bc827f8baffd0d_icgraph" id="sensor__fusion_8c_aef2b1f23f820d2b513bc827f8baffd0d_icgraph">
<area shape="rect" id="node2" href="sensor__fusion_8h.html#a367d92b99365a8143700b76439915d65" title="utility function to insert default values in the top level structure " alt="" coords="223,5,385,32"/>
<area shape="rect" id="node3" href="main__agm01__freertos__two__tasks_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="This is a FreeRTOS (dual task) implementation of the NXP sensor fusion demo build. " alt="" coords="433,5,484,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ab088da7731ffdf25710a364a7f88b224"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initializeFusionEngine </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSensorFusionGlobals.html">SensorFusionGlobals</a> *&#160;</td>
          <td class="paramname"><em>sfg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>This function is responsible for initializing the system prior to starting the main fusion loop. This function is normally involved via the "sfg." global pointer. </p>

<p>Definition at line <a class="el" href="sensor__fusion_8c_source.html#l00471">471</a> of file <a class="el" href="sensor__fusion_8c_source.html">sensor_fusion.c</a>.</p>

<p>Referenced by <a class="el" href="sensor__fusion_8c_source.html#l00068">initSensorFusionGlobals()</a>.</p>
<div class="fragment"><div class="line"><a name="l00472"></a><span class="lineno">  472</span>&#160;{</div><div class="line"><a name="l00473"></a><span class="lineno">  473</span>&#160;    int16_t status = 0;</div><div class="line"><a name="l00474"></a><span class="lineno">  474</span>&#160;    <a class="code" href="structControlSubsystem.html">ControlSubsystem</a>    *pComm;</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    pComm = sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a51cbe943cdee0fd0a2ff72d2a04fad9a">pControlSubsystem</a>;</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;    <span class="comment">// configure the 24 bit downwards ARM systick timer and wait 50ms=CORE_SYSTICK_HZ / 20 clock ticks</span></div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;    <span class="comment">// to avoid a race condition between Kinetis and the sensors after power on.</span></div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;    <a class="code" href="driver__systick_8c.html#a12342d97ebedd191c344ea0d5e1e7646">ARM_systick_enable</a>();</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;    <span class="comment">// wait 50ms to avoid a race condition with sensors at power on</span></div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;    <a class="code" href="driver__systick_8c.html#a8075e82d5c7ce23802841551a953e170">ARM_systick_delay_ms</a>(CORE_SYSTICK_HZ, 50);</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#aa22f9fd7adaca53616ef6bfb6cb051b4">setStatus</a>(sfg, <a class="code" href="sensor__fusion_8h.html#a69ee883e1c22b117df163c0bd83f66dda646fa15851d5e9f6784d044a50eef221">INITIALIZING</a>);</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;    status = <a class="code" href="sensor__fusion_8c.html#ae748e1330b5a94783c6d4ea2ad9e4f28">initializeSensors</a>(sfg);</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;    <span class="keywordflow">if</span> (status!=SENSOR_ERROR_NONE) {  <span class="comment">// fault condition found</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#aa22f9fd7adaca53616ef6bfb6cb051b4">setStatus</a>(sfg, <a class="code" href="sensor__fusion_8h.html#a69ee883e1c22b117df163c0bd83f66dda2142c7e506bbaf9dba4175fee014862f">HARD_FAULT</a>);  <span class="comment">// Never returns</span></div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;    }</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="comment">// recall: typedef enum quaternion {Q3, Q3M, Q3G, Q6MA, Q6AG, Q9} quaternion_type;</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;    <span class="comment">// Set the default quaternion to the most sophisticated supported by this build</span></div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;    pComm-&gt;<a class="code" href="structControlSubsystem.html#a38d07087f0ce6da58043233d470c8c79">DefaultQuaternionPacketType</a> = <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa19bd87b11e82b9047ad750fb62711ba8">Q3</a>;</div><div class="line"><a name="l00492"></a><span class="lineno">  492</span>&#160;    <span class="keywordflow">if</span> (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#aef4363c6eab965a0a328ee2108572893">iFlags</a> &amp; <a class="code" href="standard__build_8h.html#aed8da52c8d0d14325445b139876492b4">F_3DOF_B_BASIC</a>) pComm-&gt;<a class="code" href="structControlSubsystem.html#a38d07087f0ce6da58043233d470c8c79">DefaultQuaternionPacketType</a> = <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaada2dae63d5865a8446caa7938c73c5dc">Q3M</a>;</div><div class="line"><a name="l00493"></a><span class="lineno">  493</span>&#160;    <span class="keywordflow">if</span> (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#aef4363c6eab965a0a328ee2108572893">iFlags</a> &amp; <a class="code" href="standard__build_8h.html#a990887d9ed9f03bcaffcd4abae429265">F_3DOF_Y_BASIC</a>) pComm-&gt;<a class="code" href="structControlSubsystem.html#a38d07087f0ce6da58043233d470c8c79">DefaultQuaternionPacketType</a> = <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaaf63c9f6fec59717499a84048f682cf8a">Q3G</a>;</div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;    <span class="keywordflow">if</span> (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#aef4363c6eab965a0a328ee2108572893">iFlags</a> &amp; <a class="code" href="standard__build_8h.html#a9b0aadad0b960783ff2ecd5174a57905">F_6DOF_GB_BASIC</a>) pComm-&gt;<a class="code" href="structControlSubsystem.html#a38d07087f0ce6da58043233d470c8c79">DefaultQuaternionPacketType</a> = <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa0cf62dda224dcbac09ae26cd46ccce01">Q6MA</a>;</div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;    <span class="keywordflow">if</span> (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#aef4363c6eab965a0a328ee2108572893">iFlags</a> &amp; <a class="code" href="standard__build_8h.html#a3aa2972ee6d1865b5bd7ab4e1914a4c5">F_6DOF_GY_KALMAN</a>) pComm-&gt;<a class="code" href="structControlSubsystem.html#a38d07087f0ce6da58043233d470c8c79">DefaultQuaternionPacketType</a> = <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa59c8dc55b720396019ef93eb943a3b96">Q6AG</a>;</div><div class="line"><a name="l00496"></a><span class="lineno">  496</span>&#160;    <span class="keywordflow">if</span> (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#aef4363c6eab965a0a328ee2108572893">iFlags</a> &amp; <a class="code" href="standard__build_8h.html#a067a973335873757f5ecfda300e9c082">F_9DOF_GBY_KALMAN</a>) pComm-&gt;<a class="code" href="structControlSubsystem.html#a38d07087f0ce6da58043233d470c8c79">DefaultQuaternionPacketType</a> = <a class="code" href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa9c5ceeb2bc9bf27379c7e72bc4d0ff13">Q9</a>;</div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;    pComm-&gt;<a class="code" href="structControlSubsystem.html#a560615429c69fcefa85de0624fa6d83e">QuaternionPacketType</a> = pComm-&gt;<a class="code" href="structControlSubsystem.html#a38d07087f0ce6da58043233d470c8c79">DefaultQuaternionPacketType</a> ;</div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div><div class="line"><a name="l00499"></a><span class="lineno">  499</span>&#160;    <span class="comment">// initialize the sensor fusion algorithms</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;    <a class="code" href="fusion_8c.html#ad9cb3659204ae7a30109ceaf4d94ecec">fInitializeFusion</a>(sfg);</div><div class="line"><a name="l00501"></a><span class="lineno">  501</span>&#160;</div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;    <span class="comment">// reset the loop counter to zero for first iteration</span></div><div class="line"><a name="l00503"></a><span class="lineno">  503</span>&#160;    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a0e90feae26cd26ab80bc78cfd9364512">loopcounter</a> = 0;</div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;</div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;    <span class="comment">// initialize the magnetic calibration and magnetometer data buffer</span></div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;<span class="preprocessor">#if F_USING_MAG</span></div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <a class="code" href="magnetic_8c.html#a793003e431e2705d081b5073144cb2c0">fInitializeMagCalibration</a>(&amp;sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#acf241c1ff86d307d296f560449acc2a4">MagCal</a>, &amp;sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#ad44d6aaf76570ad374ad7c170175de5a">MagBuffer</a>);</div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="comment">// initialize the precision accelerometer calibration and accelerometer data buffer</span></div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;<span class="preprocessor">#if F_USING_ACCEL</span></div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <a class="code" href="precisionAccelerometer_8c.html#ab8572ce21837538a984e62035db4d89e">fInitializeAccelCalibration</a>(&amp;sfg-&gt;AccelCal, &amp;sfg-&gt;AccelBuffer, &amp;sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a51cbe943cdee0fd0a2ff72d2a04fad9a">pControlSubsystem</a>-&gt;<a class="code" href="structControlSubsystem.html#aa62f07fac570bf67c0832d4bf7d38e76">AccelCalPacketOn</a> );</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#aa22f9fd7adaca53616ef6bfb6cb051b4">setStatus</a>(sfg, <a class="code" href="sensor__fusion_8h.html#a69ee883e1c22b117df163c0bd83f66dda50d1448013c6f17125caee18aa418af7">NORMAL</a>);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;    <a class="code" href="sensor__fusion_8c.html#a9af8710b3e87acd2a33e7988b2d75b6c">clearFIFOs</a>(sfg);</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;}</div><div class="ttc" id="driver__systick_8c_html_a12342d97ebedd191c344ea0d5e1e7646"><div class="ttname"><a href="driver__systick_8c.html#a12342d97ebedd191c344ea0d5e1e7646">ARM_systick_enable</a></div><div class="ttdeci">void ARM_systick_enable(void)</div><div class="ttdef"><b>Definition:</b> <a href="driver__systick_8c_source.html#l00047">driver_systick.c:47</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_a69ee883e1c22b117df163c0bd83f66dda646fa15851d5e9f6784d044a50eef221"><div class="ttname"><a href="sensor__fusion_8h.html#a69ee883e1c22b117df163c0bd83f66dda646fa15851d5e9f6784d044a50eef221">INITIALIZING</a></div><div class="ttdoc">Initializing sensors and algorithms. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00122">sensor_fusion.h:122</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_a5f469312b3865f2d3efea2edd6f8afaaa9c5ceeb2bc9bf27379c7e72bc4d0ff13"><div class="ttname"><a href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa9c5ceeb2bc9bf27379c7e72bc4d0ff13">Q9</a></div><div class="ttdoc">Quaternion derived from full 9-axis sensor fusion. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00070">sensor_fusion.h:70</a></div></div>
<div class="ttc" id="fusion_8c_html_ad9cb3659204ae7a30109ceaf4d94ecec"><div class="ttname"><a href="fusion_8c.html#ad9cb3659204ae7a30109ceaf4d94ecec">fInitializeFusion</a></div><div class="ttdeci">void fInitializeFusion(SensorFusionGlobals *sfg)</div><div class="ttdef"><b>Definition:</b> <a href="fusion_8c_source.html#l00051">fusion.c:51</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_a0e90feae26cd26ab80bc78cfd9364512"><div class="ttname"><a href="structSensorFusionGlobals.html#a0e90feae26cd26ab80bc78cfd9364512">SensorFusionGlobals::loopcounter</a></div><div class="ttdeci">int32_t loopcounter</div><div class="ttdoc">counter incrementing each iteration of sensor fusion (typically 25Hz) </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00484">sensor_fusion.h:484</a></div></div>
<div class="ttc" id="magnetic_8c_html_a793003e431e2705d081b5073144cb2c0"><div class="ttname"><a href="magnetic_8c.html#a793003e431e2705d081b5073144cb2c0">fInitializeMagCalibration</a></div><div class="ttdeci">void fInitializeMagCalibration(MagCalibration *pthisMagCal, MagBuffer *pthisMagBuffer)</div><div class="ttdef"><b>Definition:</b> <a href="magnetic_8c_source.html#l00041">magnetic.c:41</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_aef4363c6eab965a0a328ee2108572893"><div class="ttname"><a href="structSensorFusionGlobals.html#aef4363c6eab965a0a328ee2108572893">SensorFusionGlobals::iFlags</a></div><div class="ttdeci">uint32_t iFlags</div><div class="ttdoc">a bit-field of sensors and algorithms used </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00480">sensor_fusion.h:480</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_a5f469312b3865f2d3efea2edd6f8afaaada2dae63d5865a8446caa7938c73c5dc"><div class="ttname"><a href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaada2dae63d5865a8446caa7938c73c5dc">Q3M</a></div><div class="ttdoc">Quaternion derived from 3-axis mag only (auto compass algorithm) </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00066">sensor_fusion.h:66</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_acf241c1ff86d307d296f560449acc2a4"><div class="ttname"><a href="structSensorFusionGlobals.html#acf241c1ff86d307d296f560449acc2a4">SensorFusionGlobals::MagCal</a></div><div class="ttdeci">MagCalibration MagCal</div><div class="ttdoc">mag cal storage </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00503">sensor_fusion.h:503</a></div></div>
<div class="ttc" id="structControlSubsystem_html_aa62f07fac570bf67c0832d4bf7d38e76"><div class="ttname"><a href="structControlSubsystem.html#aa62f07fac570bf67c0832d4bf7d38e76">ControlSubsystem::AccelCalPacketOn</a></div><div class="ttdeci">volatile int8_t AccelCalPacketOn</div><div class="ttdoc">variable used to coordinate accelerometer calibration </div><div class="ttdef"><b>Definition:</b> <a href="control_8h_source.html#l00071">control.h:71</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_a5f469312b3865f2d3efea2edd6f8afaaaf63c9f6fec59717499a84048f682cf8a"><div class="ttname"><a href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaaf63c9f6fec59717499a84048f682cf8a">Q3G</a></div><div class="ttdoc">Quaternion derived from 3-axis gyro only (rotation) </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00067">sensor_fusion.h:67</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_a5f469312b3865f2d3efea2edd6f8afaaa0cf62dda224dcbac09ae26cd46ccce01"><div class="ttname"><a href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa0cf62dda224dcbac09ae26cd46ccce01">Q6MA</a></div><div class="ttdoc">Quaternion derived from 3-axis accel + 3 axis mag (eCompass) </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00068">sensor_fusion.h:68</a></div></div>
<div class="ttc" id="structControlSubsystem_html_a38d07087f0ce6da58043233d470c8c79"><div class="ttname"><a href="structControlSubsystem.html#a38d07087f0ce6da58043233d470c8c79">ControlSubsystem::DefaultQuaternionPacketType</a></div><div class="ttdeci">quaternion_type DefaultQuaternionPacketType</div><div class="ttdoc">default quaternion transmitted at power on </div><div class="ttdef"><b>Definition:</b> <a href="control_8h_source.html#l00065">control.h:65</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_a5f469312b3865f2d3efea2edd6f8afaaa59c8dc55b720396019ef93eb943a3b96"><div class="ttname"><a href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa59c8dc55b720396019ef93eb943a3b96">Q6AG</a></div><div class="ttdoc">Quaternion derived from 3-axis accel + 3-axis gyro (gaming) </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00069">sensor_fusion.h:69</a></div></div>
<div class="ttc" id="sensor__fusion_8c_html_a9af8710b3e87acd2a33e7988b2d75b6c"><div class="ttname"><a href="sensor__fusion_8c.html#a9af8710b3e87acd2a33e7988b2d75b6c">clearFIFOs</a></div><div class="ttdeci">void clearFIFOs(SensorFusionGlobals *sfg)</div><div class="ttdoc">Function to clear FIFO at the end of each fusion computation. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8c_source.html#l00363">sensor_fusion.c:363</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_a51cbe943cdee0fd0a2ff72d2a04fad9a"><div class="ttname"><a href="structSensorFusionGlobals.html#a51cbe943cdee0fd0a2ff72d2a04fad9a">SensorFusionGlobals::pControlSubsystem</a></div><div class="ttdeci">struct ControlSubsystem * pControlSubsystem</div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00475">sensor_fusion.h:475</a></div></div>
<div class="ttc" id="standard__build_8h_html_a067a973335873757f5ecfda300e9c082"><div class="ttname"><a href="standard__build_8h.html#a067a973335873757f5ecfda300e9c082">F_9DOF_GBY_KALMAN</a></div><div class="ttdeci">#define F_9DOF_GBY_KALMAN</div></div>
<div class="ttc" id="standard__build_8h_html_a3aa2972ee6d1865b5bd7ab4e1914a4c5"><div class="ttname"><a href="standard__build_8h.html#a3aa2972ee6d1865b5bd7ab4e1914a4c5">F_6DOF_GY_KALMAN</a></div><div class="ttdeci">#define F_6DOF_GY_KALMAN</div><div class="ttdoc">6DOF accel and gyro (Kalman) algorithm selector - 0x2000 to include, 0x0000 otherwise ...</div><div class="ttdef"><b>Definition:</b> <a href="standard__build_8h_source.html#l00072">standard_build.h:72</a></div></div>
<div class="ttc" id="structControlSubsystem_html"><div class="ttname"><a href="structControlSubsystem.html">ControlSubsystem</a></div><div class="ttdoc">he ControlSubsystem encapsulates command and data streaming functions. </div><div class="ttdef"><b>Definition:</b> <a href="control_8h_source.html#l00064">control.h:64</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_ad44d6aaf76570ad374ad7c170175de5a"><div class="ttname"><a href="structSensorFusionGlobals.html#ad44d6aaf76570ad374ad7c170175de5a">SensorFusionGlobals::MagBuffer</a></div><div class="ttdeci">MagBuffer MagBuffer</div><div class="ttdoc">mag cal constellation points </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00504">sensor_fusion.h:504</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_a69ee883e1c22b117df163c0bd83f66dda2142c7e506bbaf9dba4175fee014862f"><div class="ttname"><a href="sensor__fusion_8h.html#a69ee883e1c22b117df163c0bd83f66dda2142c7e506bbaf9dba4175fee014862f">HARD_FAULT</a></div><div class="ttdoc">Non-recoverable FAULT = something went very wrong. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00127">sensor_fusion.h:127</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_a5f469312b3865f2d3efea2edd6f8afaaa19bd87b11e82b9047ad750fb62711ba8"><div class="ttname"><a href="sensor__fusion_8h.html#a5f469312b3865f2d3efea2edd6f8afaaa19bd87b11e82b9047ad750fb62711ba8">Q3</a></div><div class="ttdoc">Quaternion derived from 3-axis accel (tilt) </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00065">sensor_fusion.h:65</a></div></div>
<div class="ttc" id="standard__build_8h_html_a990887d9ed9f03bcaffcd4abae429265"><div class="ttname"><a href="standard__build_8h.html#a990887d9ed9f03bcaffcd4abae429265">F_3DOF_Y_BASIC</a></div><div class="ttdeci">#define F_3DOF_Y_BASIC</div><div class="ttdoc">3DOF gyro integration algorithm selector - 0x0800 to include, 0x0000 otherwise </div><div class="ttdef"><b>Definition:</b> <a href="standard__build_8h_source.html#l00070">standard_build.h:70</a></div></div>
<div class="ttc" id="standard__build_8h_html_a9b0aadad0b960783ff2ecd5174a57905"><div class="ttname"><a href="standard__build_8h.html#a9b0aadad0b960783ff2ecd5174a57905">F_6DOF_GB_BASIC</a></div><div class="ttdeci">#define F_6DOF_GB_BASIC</div><div class="ttdoc">6DOF accel and mag eCompass algorithm selector - 0x1000 to include, 0x0000 otherwise ...</div><div class="ttdef"><b>Definition:</b> <a href="standard__build_8h_source.html#l00071">standard_build.h:71</a></div></div>
<div class="ttc" id="precisionAccelerometer_8c_html_ab8572ce21837538a984e62035db4d89e"><div class="ttname"><a href="precisionAccelerometer_8c.html#ab8572ce21837538a984e62035db4d89e">fInitializeAccelCalibration</a></div><div class="ttdeci">void fInitializeAccelCalibration(struct AccelCalibration *pthisAccelCal, struct AccelBuffer *pthisAccelBuffer, volatile int8 *AccelCalPacketOn)</div><div class="ttdoc">Initialize the accelerometer calibration functions. </div><div class="ttdef"><b>Definition:</b> <a href="precisionAccelerometer_8c_source.html#l00034">precisionAccelerometer.c:34</a></div></div>
<div class="ttc" id="driver__systick_8c_html_a8075e82d5c7ce23802841551a953e170"><div class="ttname"><a href="driver__systick_8c.html#a8075e82d5c7ce23802841551a953e170">ARM_systick_delay_ms</a></div><div class="ttdeci">void ARM_systick_delay_ms(uint32 iSystemCoreClock, uint32 delay_ms)</div><div class="ttdef"><b>Definition:</b> <a href="driver__systick_8c_source.html#l00075">driver_systick.c:75</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_aa22f9fd7adaca53616ef6bfb6cb051b4"><div class="ttname"><a href="structSensorFusionGlobals.html#aa22f9fd7adaca53616ef6bfb6cb051b4">SensorFusionGlobals::setStatus</a></div><div class="ttdeci">setStatus_t * setStatus</div><div class="ttdoc">change status indicator immediately </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00544">sensor_fusion.h:544</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_a69ee883e1c22b117df163c0bd83f66dda50d1448013c6f17125caee18aa418af7"><div class="ttname"><a href="sensor__fusion_8h.html#a69ee883e1c22b117df163c0bd83f66dda50d1448013c6f17125caee18aa418af7">NORMAL</a></div><div class="ttdoc">Operation is Nominal. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00124">sensor_fusion.h:124</a></div></div>
<div class="ttc" id="standard__build_8h_html_aed8da52c8d0d14325445b139876492b4"><div class="ttname"><a href="standard__build_8h.html#aed8da52c8d0d14325445b139876492b4">F_3DOF_B_BASIC</a></div><div class="ttdeci">#define F_3DOF_B_BASIC</div><div class="ttdoc">3DOF mag eCompass (vehicle/mag) algorithm selector - 0x0400 to include, 0x0000 otherwise ...</div><div class="ttdef"><b>Definition:</b> <a href="standard__build_8h_source.html#l00069">standard_build.h:69</a></div></div>
<div class="ttc" id="sensor__fusion_8c_html_ae748e1330b5a94783c6d4ea2ad9e4f28"><div class="ttname"><a href="sensor__fusion_8c.html#ae748e1330b5a94783c6d4ea2ad9e4f28">initializeSensors</a></div><div class="ttdeci">int8_t initializeSensors(SensorFusionGlobals *sfg)</div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8c_source.html#l00157">sensor_fusion.c:157</a></div></div>
<div class="ttc" id="structControlSubsystem_html_a560615429c69fcefa85de0624fa6d83e"><div class="ttname"><a href="structControlSubsystem.html#a560615429c69fcefa85de0624fa6d83e">ControlSubsystem::QuaternionPacketType</a></div><div class="ttdeci">volatile quaternion_type QuaternionPacketType</div><div class="ttdoc">quaternion type transmitted over UART </div><div class="ttdef"><b>Definition:</b> <a href="control_8h_source.html#l00066">control.h:66</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-6" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-6-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-6-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-6-content" class="dyncontent" style="display:none;">
<div class="center"><img src="sensor__fusion_8c_ab088da7731ffdf25710a364a7f88b224_cgraph.png" border="0" usemap="#sensor__fusion_8c_ab088da7731ffdf25710a364a7f88b224_cgraph" alt=""/></div>
<map name="sensor__fusion_8c_ab088da7731ffdf25710a364a7f88b224_cgraph" id="sensor__fusion_8c_ab088da7731ffdf25710a364a7f88b224_cgraph">
<area shape="rect" id="node2" href="driver__systick_8c.html#a12342d97ebedd191c344ea0d5e1e7646" title="ARM_systick_enable" alt="" coords="212,17,357,44"/>
<area shape="rect" id="node3" href="driver__systick_8c.html#a8075e82d5c7ce23802841551a953e170" title="ARM_systick_delay_ms" alt="" coords="203,68,366,95"/>
<area shape="rect" id="node6" href="sensor__fusion_8c.html#ae748e1330b5a94783c6d4ea2ad9e4f28" title="initializeSensors" alt="" coords="226,123,343,149"/>
<area shape="rect" id="node11" href="fusion_8c.html#ad9cb3659204ae7a30109ceaf4d94ecec" title="fInitializeFusion" alt="" coords="229,173,340,200"/>
<area shape="rect" id="node12" href="magnetic_8c.html#a793003e431e2705d081b5073144cb2c0" title="fInitializeMagCalibration" alt="" coords="205,224,364,251"/>
<area shape="rect" id="node14" href="precisionAccelerometer_8c.html#ab8572ce21837538a984e62035db4d89e" title="Initialize the accelerometer calibration functions. " alt="" coords="201,275,368,301"/>
<area shape="rect" id="node15" href="sensor__fusion_8c.html#a9af8710b3e87acd2a33e7988b2d75b6c" title="Function to clear FIFO at the end of each fusion computation. " alt="" coords="241,325,328,352"/>
<area shape="rect" id="node4" href="driver__systick_8c.html#a63b11c5b24615bf03103d7d9e923ba2f" title="ARM_systick_start_ticks" alt="" coords="416,5,584,32"/>
<area shape="rect" id="node5" href="driver__systick_8c.html#a11d2757f060c3c65c1dfe1f7a314bbb3" title="ARM_systick_elapsed\l_ticks" alt="" coords="424,57,576,98"/>
<area shape="rect" id="node7" href="hal__frdm__fxs__mult2__b_8c.html#a6bb19bade42d7adef32375e174de144d" title="Apply the accelerometer Hardware Abstraction Layer. " alt="" coords="443,123,557,149"/>
<area shape="rect" id="node8" href="precisionAccelerometer_8c.html#a3aa550d5d9b592df3fd8b10c97c07d98" title="function maps the accelerometer data fGs (g) onto precision calibrated and de&#45;rotated data fGc (g)..." alt="" coords="447,173,553,200"/>
<area shape="rect" id="node9" href="precisionAccelerometer_8c.html#a012ad7adb564defb7170c246cdb86b04" title="Update the buffer used to store samples used for accelerometer calibration. " alt="" coords="434,224,566,251"/>
<area shape="rect" id="node10" href="precisionAccelerometer_8c.html#a2670a39e8be35e9bad5a75d0ec8ca821" title="function runs the precision accelerometer calibration " alt="" coords="632,224,775,251"/>
<area shape="rect" id="node13" href="matrix_8c.html#a54f510d9d257d6063412a9ed5adddd6f" title="function sets the 3x3 matrix A to the identity matrix " alt="" coords="446,275,554,301"/>
</map>
</div>
</p>

<p><div id="dynsection-7" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-7-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-7-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-7-content" class="dyncontent" style="display:none;">
<div class="center"><img src="sensor__fusion_8c_ab088da7731ffdf25710a364a7f88b224_icgraph.png" border="0" usemap="#sensor__fusion_8c_ab088da7731ffdf25710a364a7f88b224_icgraph" alt=""/></div>
<map name="sensor__fusion_8c_ab088da7731ffdf25710a364a7f88b224_icgraph" id="sensor__fusion_8c_ab088da7731ffdf25710a364a7f88b224_icgraph">
<area shape="rect" id="node2" href="sensor__fusion_8h.html#a367d92b99365a8143700b76439915d65" title="utility function to insert default values in the top level structure " alt="" coords="201,5,364,32"/>
<area shape="rect" id="node3" href="main__agm01__freertos__two__tasks_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="This is a FreeRTOS (dual task) implementation of the NXP sensor fusion demo build. " alt="" coords="412,5,463,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae748e1330b5a94783c6d4ea2ad9e4f28"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int8_t initializeSensors </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSensorFusionGlobals.html">SensorFusionGlobals</a> *&#160;</td>
          <td class="paramname"><em>sfg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sensor__fusion_8c_source.html#l00157">157</a> of file <a class="el" href="sensor__fusion_8c_source.html">sensor_fusion.c</a>.</p>

<p>Referenced by <a class="el" href="sensor__fusion_8c_source.html#l00471">initializeFusionEngine()</a>.</p>
<div class="fragment"><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;{</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <a class="code" href="structPhysicalSensor.html">PhysicalSensor</a>  *pSensor;</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    int8_t          s;</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    int8_t          status = 0;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">for</span> (pSensor = sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a234522d09ba87b3f4177a113b241e573">pSensors</a>; pSensor != NULL; pSensor = pSensor-&gt;<a class="code" href="structPhysicalSensor.html#aa204a2ffb38c3a97a939a72960a63637">next</a>)</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    {</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;        s = pSensor-&gt;<a class="code" href="structPhysicalSensor.html#a73cbbfac7304c294fd5df41d33a7025e">initialize</a>(pSensor, sfg);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;        <span class="keywordflow">if</span> (status == 0) status = s;            <span class="comment">// will return 1st error flag, but try all sensors</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    }</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="keywordflow">return</span> (status);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;}</div><div class="ttc" id="structPhysicalSensor_html_aa204a2ffb38c3a97a939a72960a63637"><div class="ttname"><a href="structPhysicalSensor.html#aa204a2ffb38c3a97a939a72960a63637">PhysicalSensor::next</a></div><div class="ttdeci">struct PhysicalSensor * next</div><div class="ttdoc">pointer to next sensor in this linked list </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00175">sensor_fusion.h:175</a></div></div>
<div class="ttc" id="structPhysicalSensor_html_a73cbbfac7304c294fd5df41d33a7025e"><div class="ttname"><a href="structPhysicalSensor.html#a73cbbfac7304c294fd5df41d33a7025e">PhysicalSensor::initialize</a></div><div class="ttdeci">initializeSensor_t * initialize</div><div class="ttdoc">pointer to function to initialize sensor using the supplied drivers </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00177">sensor_fusion.h:177</a></div></div>
<div class="ttc" id="structPhysicalSensor_html"><div class="ttname"><a href="structPhysicalSensor.html">PhysicalSensor</a></div><div class="ttdoc">An instance of PhysicalSensor structure type should be allocated for each physical sensors (combo dev...</div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00170">sensor_fusion.h:170</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_a234522d09ba87b3f4177a113b241e573"><div class="ttname"><a href="structSensorFusionGlobals.html#a234522d09ba87b3f4177a113b241e573">SensorFusionGlobals::pSensors</a></div><div class="ttdeci">PhysicalSensor * pSensors</div><div class="ttdoc">a linked list of physical sensors </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00481">sensor_fusion.h:481</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-8" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-8-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-8-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-8-content" class="dyncontent" style="display:none;">
<div class="center"><img src="sensor__fusion_8c_ae748e1330b5a94783c6d4ea2ad9e4f28_cgraph.png" border="0" usemap="#sensor__fusion_8c_ae748e1330b5a94783c6d4ea2ad9e4f28_cgraph" alt=""/></div>
<map name="sensor__fusion_8c_ae748e1330b5a94783c6d4ea2ad9e4f28_cgraph" id="sensor__fusion_8c_ae748e1330b5a94783c6d4ea2ad9e4f28_cgraph">
<area shape="rect" id="node2" href="hal__frdm__fxs__mult2__b_8c.html#a6bb19bade42d7adef32375e174de144d" title="Apply the accelerometer Hardware Abstraction Layer. " alt="" coords="180,56,293,83"/>
<area shape="rect" id="node3" href="precisionAccelerometer_8c.html#a3aa550d5d9b592df3fd8b10c97c07d98" title="function maps the accelerometer data fGs (g) onto precision calibrated and de&#45;rotated data fGc (g)..." alt="" coords="183,107,290,133"/>
<area shape="rect" id="node4" href="precisionAccelerometer_8c.html#a012ad7adb564defb7170c246cdb86b04" title="Update the buffer used to store samples used for accelerometer calibration. " alt="" coords="171,157,303,184"/>
<area shape="rect" id="node5" href="precisionAccelerometer_8c.html#a2670a39e8be35e9bad5a75d0ec8ca821" title="function runs the precision accelerometer calibration " alt="" coords="351,157,493,184"/>
<area shape="rect" id="node6" href="precisionAccelerometer_8c.html#a752887e826809837549c391aa3a4cbaf" title="calculate the 10 element calibration from the available measurements " alt="" coords="541,5,727,32"/>
<area shape="rect" id="node7" href="precisionAccelerometer_8c.html#a2f17e091698125acbf0cdb780c2c93da" title="calculate the 7 element calibration from the available measurements " alt="" coords="545,56,723,83"/>
<area shape="rect" id="node8" href="precisionAccelerometer_8c.html#a32c25ed3da9ec249bba57bbb1ab2d091" title="calculate the 4 element calibration from the available measurements " alt="" coords="545,107,723,133"/>
<area shape="rect" id="node9" href="matrix_8c.html#ae6e2a4eb7863e79c5e8146dd27f9d608" title="function multiplies the 3x1 vector V by a 3x3 matrix A " alt="" coords="587,157,681,184"/>
<area shape="rect" id="node10" href="orientation_8h.html#addec350696b9ab89918808b56292bd9a" title="Aerospace NED accelerometer 3DOF tilt function, computing rotation matrix fR. " alt="" coords="583,208,685,235"/>
<area shape="rect" id="node11" href="orientation_8h.html#a480280c72c7243e5c192cab628e0a38d" title="Android accelerometer 3DOF tilt function computing, rotation matrix fR. " alt="" coords="574,259,694,285"/>
<area shape="rect" id="node12" href="orientation_8h.html#a292e27a8f966749f38e5e7936b05e29b" title="Windows 8 accelerometer 3DOF tilt function computing, rotation matrix fR. " alt="" coords="581,309,687,336"/>
</map>
</div>
</p>

<p><div id="dynsection-9" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-9-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-9-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-9-content" class="dyncontent" style="display:none;">
<div class="center"><img src="sensor__fusion_8c_ae748e1330b5a94783c6d4ea2ad9e4f28_icgraph.png" border="0" usemap="#sensor__fusion_8c_ae748e1330b5a94783c6d4ea2ad9e4f28_icgraph" alt=""/></div>
<map name="sensor__fusion_8c_ae748e1330b5a94783c6d4ea2ad9e4f28_icgraph" id="sensor__fusion_8c_ae748e1330b5a94783c6d4ea2ad9e4f28_icgraph">
<area shape="rect" id="node2" href="sensor__fusion_8c.html#ab088da7731ffdf25710a364a7f88b224" title="This function is responsible for initializing the system prior to starting the main fusion loop..." alt="" coords="171,5,319,32"/>
<area shape="rect" id="node3" href="sensor__fusion_8h.html#a367d92b99365a8143700b76439915d65" title="utility function to insert default values in the top level structure " alt="" coords="367,5,529,32"/>
<area shape="rect" id="node4" href="main__agm01__freertos__two__tasks_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="This is a FreeRTOS (dual task) implementation of the NXP sensor fusion demo build. " alt="" coords="577,5,628,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a43b44018042fabb5179c2e62277cc942"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void initSensorFusionGlobals </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSensorFusionGlobals.html">SensorFusionGlobals</a> *&#160;</td>
          <td class="paramname"><em>sfg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structStatusSubsystem.html">StatusSubsystem</a> *&#160;</td>
          <td class="paramname"><em>pStatusSubsystem</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structControlSubsystem.html">ControlSubsystem</a> *&#160;</td>
          <td class="paramname"><em>pControlSubsystem</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>utility function to insert default values in the top level structure </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sfg</td><td>Global data structure pointer </td></tr>
    <tr><td class="paramname">pStatusSubsystem</td><td>Status subsystem pointer </td></tr>
    <tr><td class="paramname">pControlSubsystem</td><td>Control subsystem pointer </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="sensor__fusion_8c_source.html#l00068">68</a> of file <a class="el" href="sensor__fusion_8c_source.html">sensor_fusion.c</a>.</p>

<p>Referenced by <a class="el" href="main__agm01__freertos__two__tasks_8c_source.html#l00072">main()</a>.</p>
<div class="fragment"><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;{</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#aef4363c6eab965a0a328ee2108572893">iFlags</a> = <span class="comment">// all of the following defines are either 0x0000 or a 1-bit value (2, 4, 8 ...) and are defined in build.h</span></div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;                <a class="code" href="standard__build_8h.html#a8f284d04ec459633d30dc85cf0a32a0d">F_USING_ACCEL</a>           |</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;                <a class="code" href="magnetic_8h.html#a78765407e471fe0b9119e5ff41aa7d16">F_USING_MAG</a>             |</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;                <a class="code" href="standard__build_8h.html#aecf1505d7dbaa2569dd3f36bf05ab5a0">F_USING_GYRO</a>            |</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;                <a class="code" href="standard__build_8h.html#a9dc768c1c6cf1af59d2b062324dd8bed">F_USING_PRESSURE</a>        |</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;                <a class="code" href="standard__build_8h.html#a03ea0ea6d4483a4f9a0cf6d66b51c132">F_USING_TEMPERATURE</a>     |</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;                <a class="code" href="standard__build_8h.html#a351371043b1de406eedca9db865fc4b8">F_ALL_SENSORS</a>           |       <span class="comment">// refers to all applicable sensor types for the given physical unit</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;                <a class="code" href="standard__build_8h.html#a69b745acfd24d1873d47c67aca06df26">F_1DOF_P_BASIC</a>          |       <span class="comment">// 1DOF pressure (altitude) and temperature: (pressure)</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;                <a class="code" href="standard__build_8h.html#adb79fa7eb529c4cae2619ef22af3211e">F_3DOF_G_BASIC</a>          |   <span class="comment">// 3DOF accel tilt: (accel)</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;                <a class="code" href="standard__build_8h.html#aed8da52c8d0d14325445b139876492b4">F_3DOF_B_BASIC</a>          |   <span class="comment">// 3DOF mag eCompass (vehicle): (mag)</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;                <a class="code" href="standard__build_8h.html#a990887d9ed9f03bcaffcd4abae429265">F_3DOF_Y_BASIC</a>          |   <span class="comment">// 3DOF gyro integration: (gyro)</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;                <a class="code" href="standard__build_8h.html#a9b0aadad0b960783ff2ecd5174a57905">F_6DOF_GB_BASIC</a>         |   <span class="comment">// 6DOF accel and mag eCompass)</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;                <a class="code" href="standard__build_8h.html#a3aa2972ee6d1865b5bd7ab4e1914a4c5">F_6DOF_GY_KALMAN</a>        |   <span class="comment">// 6DOF accel and gyro (Kalman): (accel + gyro)</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;                <a class="code" href="standard__build_8h.html#a067a973335873757f5ecfda300e9c082">F_9DOF_GBY_KALMAN</a>   ;   <span class="comment">// 9DOF accel, mag and gyro (Kalman): (accel + mag + gyro)</span></div><div class="line"><a name="l00086"></a><span class="lineno">   86</span>&#160;</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a51cbe943cdee0fd0a2ff72d2a04fad9a">pControlSubsystem</a> = pControlSubsystem;</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a8f77cc84b021a9a1d91f6f049029d76d">pStatusSubsystem</a> = pStatusSubsystem;</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a0e90feae26cd26ab80bc78cfd9364512">loopcounter</a> = 0;                     <span class="comment">// counter incrementing each iteration of sensor fusion (typically 25Hz)</span></div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a4f20ea7a38165583d4757c1dae2bd1d3">systick_I2C</a> = 0;                     <span class="comment">// systick counter to benchmark I2C reads</span></div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    sfg-&gt;systick_Spare = 0;                   <span class="comment">// systick counter for counts spare waiting for timing interrupt</span></div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a571184d82a99a987a2ca72b53e2fa100">iPerturbation</a> = 0;                   <span class="comment">// no perturbation to be applied</span></div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a22ddc1cea4daa0d93be0fe7d48365dbb">installSensor</a> = <a class="code" href="sensor__fusion_8c.html#a45ee1600720deae228f488e6246a747b">installSensor</a>;       <span class="comment">// function for installing a new sensor into the structures</span></div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a4c9ce90c92e284691468585f6a55d79e">initializeFusionEngine</a> = <a class="code" href="sensor__fusion_8c.html#ab088da7731ffdf25710a364a7f88b224">initializeFusionEngine</a>;   <span class="comment">// function for installing a new sensor into the structures</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a15e66ae3ad63ad091317ad0aefa53ce7">readSensors</a> = <a class="code" href="sensor__fusion_8c.html#a0d688188b65f43d38ac760a79d9eb116">readSensors</a>;           <span class="comment">// function for installing a new sensor into the structures</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#afc72aca0c3842cde4aa4bb0dcdfb4237">runFusion</a> = <a class="code" href="sensor__fusion_8c.html#a8b90119fee979d0309cc923bf1fad543">runFusion</a>;               <span class="comment">// function for installing a new sensor into the structures</span></div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#ac01270fc7330df24acd1cd888397ef07">applyPerturbation</a> = <a class="code" href="sensor__fusion_8h.html#acf78cd74de357ad4670c6efeea8506cf">ApplyPerturbation</a>; <span class="comment">// function used for step function testing</span></div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a7466779558c661297ca6dc36d829605c">conditionSensorReadings</a> = <a class="code" href="sensor__fusion_8c.html#aef2b1f23f820d2b513bc827f8baffd0d">conditionSensorReadings</a>; <span class="comment">// function does averaging, HAL adjustments, etc.</span></div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a12c0ab8f62e2281359a41bb5d3d64999">clearFIFOs</a> = <a class="code" href="sensor__fusion_8c.html#a9af8710b3e87acd2a33e7988b2d75b6c">clearFIFOs</a>;             <span class="comment">// function to clear FIFO flags    sfg-&gt;applyPerturbation = ApplyPerturbation; // function used for step function testing</span></div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#aa22f9fd7adaca53616ef6bfb6cb051b4">setStatus</a> = <a class="code" href="sensor__fusion_8c.html#a741fd2193cc58c09b692d1ae2b7a81e8">setStatus</a>;               <span class="comment">// function to immediately set status change</span></div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#af6a232c7866a9093f9a5cb51372d4f97">queueStatus</a> = <a class="code" href="sensor__fusion_8c.html#ae96e36747e6a1aabbec1381f15132ec6">queueStatus</a>;           <span class="comment">// function to queue status change</span></div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a186a484bdd7f6c3210a2ee6d2763c6a2">updateStatus</a> = <a class="code" href="sensor__fusion_8c.html#aa13c4a9f07f3a2abfdb2e0808e5752d4">updateStatus</a>;         <span class="comment">// function to promote queued status change</span></div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;    sfg-&gt;testStatus = <a class="code" href="sensor__fusion_8c.html#a142a0a30c123f8acf79a3e8e5072cad8">testStatus</a>;             <span class="comment">// function for unit testing the status subsystem</span></div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a234522d09ba87b3f4177a113b241e573">pSensors</a> = NULL;                     <span class="comment">// pointer to linked list of physical sensors</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;<span class="comment">//  put error value into whoAmI as initial value</span></div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;<span class="preprocessor">#if F_USING_ACCEL</span></div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;    sfg-&gt;Accel.iWhoAmI = 0;</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;<span class="preprocessor">#if F_USING_MAG</span></div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a876af8fddc05153d04bda2d8a8107819">Mag</a>.<a class="code" href="structMagSensor.html#a895f3236864f6fe000df494c55c112fb">iWhoAmI</a> = 0;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;<span class="preprocessor">#if F_USING_GYRO</span></div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    sfg-&gt;Gyro.iWhoAmI = 0;</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;<span class="preprocessor">#if F_USING_PRESSURE</span></div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    sfg-&gt;Pressure.iWhoAmI = 0;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;}</div><div class="ttc" id="standard__build_8h_html_aecf1505d7dbaa2569dd3f36bf05ab5a0"><div class="ttname"><a href="standard__build_8h.html#aecf1505d7dbaa2569dd3f36bf05ab5a0">F_USING_GYRO</a></div><div class="ttdeci">#define F_USING_GYRO</div><div class="ttdoc">nominally 0x0004 if a gyro is to be used, 0x0000 otherwise </div><div class="ttdef"><b>Definition:</b> <a href="standard__build_8h_source.html#l00057">standard_build.h:57</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_a0e90feae26cd26ab80bc78cfd9364512"><div class="ttname"><a href="structSensorFusionGlobals.html#a0e90feae26cd26ab80bc78cfd9364512">SensorFusionGlobals::loopcounter</a></div><div class="ttdeci">int32_t loopcounter</div><div class="ttdoc">counter incrementing each iteration of sensor fusion (typically 25Hz) </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00484">sensor_fusion.h:484</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_a12c0ab8f62e2281359a41bb5d3d64999"><div class="ttname"><a href="structSensorFusionGlobals.html#a12c0ab8f62e2281359a41bb5d3d64999">SensorFusionGlobals::clearFIFOs</a></div><div class="ttdeci">clearFIFOs_t * clearFIFOs</div><div class="ttdoc">clear sensor FIFOs </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00543">sensor_fusion.h:543</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_a4f20ea7a38165583d4757c1dae2bd1d3"><div class="ttname"><a href="structSensorFusionGlobals.html#a4f20ea7a38165583d4757c1dae2bd1d3">SensorFusionGlobals::systick_I2C</a></div><div class="ttdeci">int32_t systick_I2C</div><div class="ttdoc">systick counter to benchmark I2C reads </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00485">sensor_fusion.h:485</a></div></div>
<div class="ttc" id="standard__build_8h_html_a351371043b1de406eedca9db865fc4b8"><div class="ttname"><a href="standard__build_8h.html#a351371043b1de406eedca9db865fc4b8">F_ALL_SENSORS</a></div><div class="ttdeci">#define F_ALL_SENSORS</div></div>
<div class="ttc" id="structSensorFusionGlobals_html_aef4363c6eab965a0a328ee2108572893"><div class="ttname"><a href="structSensorFusionGlobals.html#aef4363c6eab965a0a328ee2108572893">SensorFusionGlobals::iFlags</a></div><div class="ttdeci">uint32_t iFlags</div><div class="ttdoc">a bit-field of sensors and algorithms used </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00480">sensor_fusion.h:480</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_a7466779558c661297ca6dc36d829605c"><div class="ttname"><a href="structSensorFusionGlobals.html#a7466779558c661297ca6dc36d829605c">SensorFusionGlobals::conditionSensorReadings</a></div><div class="ttdeci">conditionSensorReadings_t * conditionSensorReadings</div><div class="ttdoc">preprocessing step for sensor fusion </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00542">sensor_fusion.h:542</a></div></div>
<div class="ttc" id="sensor__fusion_8c_html_a741fd2193cc58c09b692d1ae2b7a81e8"><div class="ttname"><a href="sensor__fusion_8c.html#a741fd2193cc58c09b692d1ae2b7a81e8">setStatus</a></div><div class="ttdeci">void setStatus(SensorFusionGlobals *sfg, fusion_status_t status)</div><div class="ttdoc">Poor man&amp;#39;s inheritance for status subsystem setStatus command This function is normally involved via ...</div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8c_source.html#l00043">sensor_fusion.c:43</a></div></div>
<div class="ttc" id="standard__build_8h_html_a9dc768c1c6cf1af59d2b062324dd8bed"><div class="ttname"><a href="standard__build_8h.html#a9dc768c1c6cf1af59d2b062324dd8bed">F_USING_PRESSURE</a></div><div class="ttdeci">#define F_USING_PRESSURE</div><div class="ttdoc">nominally 0x0008 if altimeter is to be used, 0x0000 otherwise </div><div class="ttdef"><b>Definition:</b> <a href="standard__build_8h_source.html#l00058">standard_build.h:58</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_a22ddc1cea4daa0d93be0fe7d48365dbb"><div class="ttname"><a href="structSensorFusionGlobals.html#a22ddc1cea4daa0d93be0fe7d48365dbb">SensorFusionGlobals::installSensor</a></div><div class="ttdeci">installSensor_t * installSensor</div><div class="ttdoc">function for installing a new sensor into t </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00537">sensor_fusion.h:537</a></div></div>
<div class="ttc" id="sensor__fusion_8c_html_a45ee1600720deae228f488e6246a747b"><div class="ttname"><a href="sensor__fusion_8c.html#a45ee1600720deae228f488e6246a747b">installSensor</a></div><div class="ttdeci">int8_t installSensor(SensorFusionGlobals *sfg, PhysicalSensor *pSensor, uint16_t addr, uint16_t schedule, void *bus_driver, initializeSensor_t *initialize, readSensor_t *read)</div><div class="ttdoc">installSensor is used to instantiate a physical sensor driver into the sensor fusion system...</div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8c_source.html#l00122">sensor_fusion.c:122</a></div></div>
<div class="ttc" id="sensor__fusion_8c_html_a142a0a30c123f8acf79a3e8e5072cad8"><div class="ttname"><a href="sensor__fusion_8c.html#a142a0a30c123f8acf79a3e8e5072cad8">testStatus</a></div><div class="ttdeci">void testStatus(SensorFusionGlobals *sfg)</div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8c_source.html#l00062">sensor_fusion.c:62</a></div></div>
<div class="ttc" id="sensor__fusion_8c_html_ab088da7731ffdf25710a364a7f88b224"><div class="ttname"><a href="sensor__fusion_8c.html#ab088da7731ffdf25710a364a7f88b224">initializeFusionEngine</a></div><div class="ttdeci">void initializeFusionEngine(SensorFusionGlobals *sfg)</div><div class="ttdoc">This function is responsible for initializing the system prior to starting the main fusion loop...</div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8c_source.html#l00471">sensor_fusion.c:471</a></div></div>
<div class="ttc" id="sensor__fusion_8c_html_a9af8710b3e87acd2a33e7988b2d75b6c"><div class="ttname"><a href="sensor__fusion_8c.html#a9af8710b3e87acd2a33e7988b2d75b6c">clearFIFOs</a></div><div class="ttdeci">void clearFIFOs(SensorFusionGlobals *sfg)</div><div class="ttdoc">Function to clear FIFO at the end of each fusion computation. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8c_source.html#l00363">sensor_fusion.c:363</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_a15e66ae3ad63ad091317ad0aefa53ce7"><div class="ttname"><a href="structSensorFusionGlobals.html#a15e66ae3ad63ad091317ad0aefa53ce7">SensorFusionGlobals::readSensors</a></div><div class="ttdeci">readSensors_t * readSensors</div><div class="ttdoc">read all physical sensors </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00540">sensor_fusion.h:540</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_a51cbe943cdee0fd0a2ff72d2a04fad9a"><div class="ttname"><a href="structSensorFusionGlobals.html#a51cbe943cdee0fd0a2ff72d2a04fad9a">SensorFusionGlobals::pControlSubsystem</a></div><div class="ttdeci">struct ControlSubsystem * pControlSubsystem</div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00475">sensor_fusion.h:475</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_a4c9ce90c92e284691468585f6a55d79e"><div class="ttname"><a href="structSensorFusionGlobals.html#a4c9ce90c92e284691468585f6a55d79e">SensorFusionGlobals::initializeFusionEngine</a></div><div class="ttdeci">initializeFusionEngine_t * initializeFusionEngine</div><div class="ttdoc">set sensor fusion structures to initial values </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00538">sensor_fusion.h:538</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_a876af8fddc05153d04bda2d8a8107819"><div class="ttname"><a href="structSensorFusionGlobals.html#a876af8fddc05153d04bda2d8a8107819">SensorFusionGlobals::Mag</a></div><div class="ttdeci">MagSensor Mag</div><div class="ttdoc">magnetometer storage </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00492">sensor_fusion.h:492</a></div></div>
<div class="ttc" id="standard__build_8h_html_a69b745acfd24d1873d47c67aca06df26"><div class="ttname"><a href="standard__build_8h.html#a69b745acfd24d1873d47c67aca06df26">F_1DOF_P_BASIC</a></div><div class="ttdeci">#define F_1DOF_P_BASIC</div><div class="ttdoc">1DOF pressure (altitude) and temperature algorithm selector - 0x0100 to include, 0x0000 otherwise ...</div><div class="ttdef"><b>Definition:</b> <a href="standard__build_8h_source.html#l00067">standard_build.h:67</a></div></div>
<div class="ttc" id="standard__build_8h_html_a067a973335873757f5ecfda300e9c082"><div class="ttname"><a href="standard__build_8h.html#a067a973335873757f5ecfda300e9c082">F_9DOF_GBY_KALMAN</a></div><div class="ttdeci">#define F_9DOF_GBY_KALMAN</div></div>
<div class="ttc" id="structSensorFusionGlobals_html_a186a484bdd7f6c3210a2ee6d2763c6a2"><div class="ttname"><a href="structSensorFusionGlobals.html#a186a484bdd7f6c3210a2ee6d2763c6a2">SensorFusionGlobals::updateStatus</a></div><div class="ttdeci">updateStatus_t * updateStatus</div><div class="ttdoc">status=next status </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00546">sensor_fusion.h:546</a></div></div>
<div class="ttc" id="sensor__fusion_8c_html_a0d688188b65f43d38ac760a79d9eb116"><div class="ttname"><a href="sensor__fusion_8c.html#a0d688188b65f43d38ac760a79d9eb116">readSensors</a></div><div class="ttdeci">int8_t readSensors(SensorFusionGlobals *sfg, uint16_t read_loop_counter)</div><div class="ttdoc">readSensors traverses the linked list of physical sensors, calling the individual read functions one ...</div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8c_source.html#l00276">sensor_fusion.c:276</a></div></div>
<div class="ttc" id="standard__build_8h_html_a3aa2972ee6d1865b5bd7ab4e1914a4c5"><div class="ttname"><a href="standard__build_8h.html#a3aa2972ee6d1865b5bd7ab4e1914a4c5">F_6DOF_GY_KALMAN</a></div><div class="ttdeci">#define F_6DOF_GY_KALMAN</div><div class="ttdoc">6DOF accel and gyro (Kalman) algorithm selector - 0x2000 to include, 0x0000 otherwise ...</div><div class="ttdef"><b>Definition:</b> <a href="standard__build_8h_source.html#l00072">standard_build.h:72</a></div></div>
<div class="ttc" id="sensor__fusion_8c_html_a8b90119fee979d0309cc923bf1fad543"><div class="ttname"><a href="sensor__fusion_8c.html#a8b90119fee979d0309cc923bf1fad543">runFusion</a></div><div class="ttdeci">void runFusion(SensorFusionGlobals *sfg)</div><div class="ttdoc">runFusion the top level call that actually runs the sensor fusion. This is a utility function which m...</div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8c_source.html#l00386">sensor_fusion.c:386</a></div></div>
<div class="ttc" id="standard__build_8h_html_adb79fa7eb529c4cae2619ef22af3211e"><div class="ttname"><a href="standard__build_8h.html#adb79fa7eb529c4cae2619ef22af3211e">F_3DOF_G_BASIC</a></div><div class="ttdeci">#define F_3DOF_G_BASIC</div><div class="ttdoc">3DOF accel tilt (accel) algorithm selector - 0x0200 to include, 0x0000 otherwise </div><div class="ttdef"><b>Definition:</b> <a href="standard__build_8h_source.html#l00068">standard_build.h:68</a></div></div>
<div class="ttc" id="sensor__fusion_8c_html_ae96e36747e6a1aabbec1381f15132ec6"><div class="ttname"><a href="sensor__fusion_8c.html#ae96e36747e6a1aabbec1381f15132ec6">queueStatus</a></div><div class="ttdeci">void queueStatus(SensorFusionGlobals *sfg, fusion_status_t status)</div><div class="ttdoc">Poor man&amp;#39;s inheritance for status subsystem queueStatus command. This function is normally involved v...</div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8c_source.html#l00050">sensor_fusion.c:50</a></div></div>
<div class="ttc" id="standard__build_8h_html_a03ea0ea6d4483a4f9a0cf6d66b51c132"><div class="ttname"><a href="standard__build_8h.html#a03ea0ea6d4483a4f9a0cf6d66b51c132">F_USING_TEMPERATURE</a></div><div class="ttdeci">#define F_USING_TEMPERATURE</div><div class="ttdoc">nominally 0x0010 if temp sensor is to be used, 0x0000 otherwise </div><div class="ttdef"><b>Definition:</b> <a href="standard__build_8h_source.html#l00059">standard_build.h:59</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_afc72aca0c3842cde4aa4bb0dcdfb4237"><div class="ttname"><a href="structSensorFusionGlobals.html#afc72aca0c3842cde4aa4bb0dcdfb4237">SensorFusionGlobals::runFusion</a></div><div class="ttdeci">runFusion_t * runFusion</div><div class="ttdoc">run the fusion routines </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00541">sensor_fusion.h:541</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_a8f77cc84b021a9a1d91f6f049029d76d"><div class="ttname"><a href="structSensorFusionGlobals.html#a8f77cc84b021a9a1d91f6f049029d76d">SensorFusionGlobals::pStatusSubsystem</a></div><div class="ttdeci">struct StatusSubsystem * pStatusSubsystem</div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00476">sensor_fusion.h:476</a></div></div>
<div class="ttc" id="sensor__fusion_8c_html_aef2b1f23f820d2b513bc827f8baffd0d"><div class="ttname"><a href="sensor__fusion_8c.html#aef2b1f23f820d2b513bc827f8baffd0d">conditionSensorReadings</a></div><div class="ttdeci">void conditionSensorReadings(SensorFusionGlobals *sfg)</div><div class="ttdoc">conditionSensorReadings() transforms raw software FIFO readings into forms that can be consumed by th...</div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8c_source.html#l00305">sensor_fusion.c:305</a></div></div>
<div class="ttc" id="structMagSensor_html_a895f3236864f6fe000df494c55c112fb"><div class="ttname"><a href="structMagSensor.html#a895f3236864f6fe000df494c55c112fb">MagSensor::iWhoAmI</a></div><div class="ttdeci">uint8_t iWhoAmI</div><div class="ttdoc">sensor whoami </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00229">sensor_fusion.h:229</a></div></div>
<div class="ttc" id="sensor__fusion_8c_html_aa13c4a9f07f3a2abfdb2e0808e5752d4"><div class="ttname"><a href="sensor__fusion_8c.html#aa13c4a9f07f3a2abfdb2e0808e5752d4">updateStatus</a></div><div class="ttdeci">void updateStatus(SensorFusionGlobals *sfg)</div><div class="ttdoc">Poor man&amp;#39;s inheritance for status subsystem updateStatus command. This function is normally involved ...</div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8c_source.html#l00057">sensor_fusion.c:57</a></div></div>
<div class="ttc" id="standard__build_8h_html_a990887d9ed9f03bcaffcd4abae429265"><div class="ttname"><a href="standard__build_8h.html#a990887d9ed9f03bcaffcd4abae429265">F_3DOF_Y_BASIC</a></div><div class="ttdeci">#define F_3DOF_Y_BASIC</div><div class="ttdoc">3DOF gyro integration algorithm selector - 0x0800 to include, 0x0000 otherwise </div><div class="ttdef"><b>Definition:</b> <a href="standard__build_8h_source.html#l00070">standard_build.h:70</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_af6a232c7866a9093f9a5cb51372d4f97"><div class="ttname"><a href="structSensorFusionGlobals.html#af6a232c7866a9093f9a5cb51372d4f97">SensorFusionGlobals::queueStatus</a></div><div class="ttdeci">setStatus_t * queueStatus</div><div class="ttdoc">queue status change for next regular interval </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00545">sensor_fusion.h:545</a></div></div>
<div class="ttc" id="standard__build_8h_html_a9b0aadad0b960783ff2ecd5174a57905"><div class="ttname"><a href="standard__build_8h.html#a9b0aadad0b960783ff2ecd5174a57905">F_6DOF_GB_BASIC</a></div><div class="ttdeci">#define F_6DOF_GB_BASIC</div><div class="ttdoc">6DOF accel and mag eCompass algorithm selector - 0x1000 to include, 0x0000 otherwise ...</div><div class="ttdef"><b>Definition:</b> <a href="standard__build_8h_source.html#l00071">standard_build.h:71</a></div></div>
<div class="ttc" id="standard__build_8h_html_a8f284d04ec459633d30dc85cf0a32a0d"><div class="ttname"><a href="standard__build_8h.html#a8f284d04ec459633d30dc85cf0a32a0d">F_USING_ACCEL</a></div><div class="ttdeci">#define F_USING_ACCEL</div><div class="ttdoc">nominally 0x0001 if an accelerometer is to be used, 0x0000 otherwise </div><div class="ttdef"><b>Definition:</b> <a href="standard__build_8h_source.html#l00055">standard_build.h:55</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_aa22f9fd7adaca53616ef6bfb6cb051b4"><div class="ttname"><a href="structSensorFusionGlobals.html#aa22f9fd7adaca53616ef6bfb6cb051b4">SensorFusionGlobals::setStatus</a></div><div class="ttdeci">setStatus_t * setStatus</div><div class="ttdoc">change status indicator immediately </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00544">sensor_fusion.h:544</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_ac01270fc7330df24acd1cd888397ef07"><div class="ttname"><a href="structSensorFusionGlobals.html#ac01270fc7330df24acd1cd888397ef07">SensorFusionGlobals::applyPerturbation</a></div><div class="ttdeci">applyPerturbation_t * applyPerturbation</div><div class="ttdoc">apply step function for testing purposes </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00539">sensor_fusion.h:539</a></div></div>
<div class="ttc" id="standard__build_8h_html_aed8da52c8d0d14325445b139876492b4"><div class="ttname"><a href="standard__build_8h.html#aed8da52c8d0d14325445b139876492b4">F_3DOF_B_BASIC</a></div><div class="ttdeci">#define F_3DOF_B_BASIC</div><div class="ttdoc">3DOF mag eCompass (vehicle/mag) algorithm selector - 0x0400 to include, 0x0000 otherwise ...</div><div class="ttdef"><b>Definition:</b> <a href="standard__build_8h_source.html#l00069">standard_build.h:69</a></div></div>
<div class="ttc" id="magnetic_8h_html_a78765407e471fe0b9119e5ff41aa7d16"><div class="ttname"><a href="magnetic_8h.html#a78765407e471fe0b9119e5ff41aa7d16">F_USING_MAG</a></div><div class="ttdeci">#define F_USING_MAG</div><div class="ttdef"><b>Definition:</b> <a href="magnetic_8h_source.html#l00038">magnetic.h:38</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_a571184d82a99a987a2ca72b53e2fa100"><div class="ttname"><a href="structSensorFusionGlobals.html#a571184d82a99a987a2ca72b53e2fa100">SensorFusionGlobals::iPerturbation</a></div><div class="ttdeci">volatile uint8_t iPerturbation</div><div class="ttdoc">test perturbation to be applied </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00482">sensor_fusion.h:482</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_acf78cd74de357ad4670c6efeea8506cf"><div class="ttname"><a href="sensor__fusion_8h.html#acf78cd74de357ad4670c6efeea8506cf">ApplyPerturbation</a></div><div class="ttdeci">applyPerturbation_t ApplyPerturbation</div><div class="ttdoc">ApplyPerturbation is a reverse unit-step test function. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00626">sensor_fusion.h:626</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_a234522d09ba87b3f4177a113b241e573"><div class="ttname"><a href="structSensorFusionGlobals.html#a234522d09ba87b3f4177a113b241e573">SensorFusionGlobals::pSensors</a></div><div class="ttdeci">PhysicalSensor * pSensors</div><div class="ttdoc">a linked list of physical sensors </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00481">sensor_fusion.h:481</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-10" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-10-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-10-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-10-content" class="dyncontent" style="display:none;">
<div class="center"><img src="sensor__fusion_8c_a43b44018042fabb5179c2e62277cc942_cgraph.png" border="0" usemap="#sensor__fusion_8c_a43b44018042fabb5179c2e62277cc942_cgraph" alt=""/></div>
<map name="sensor__fusion_8c_a43b44018042fabb5179c2e62277cc942_cgraph" id="sensor__fusion_8c_a43b44018042fabb5179c2e62277cc942_cgraph">
<area shape="rect" id="node2" href="sensor__fusion_8c.html#a45ee1600720deae228f488e6246a747b" title="installSensor is used to instantiate a physical sensor driver into the sensor fusion system..." alt="" coords="252,275,349,301"/>
<area shape="rect" id="node3" href="sensor__fusion_8c.html#ab088da7731ffdf25710a364a7f88b224" title="This function is responsible for initializing the system prior to starting the main fusion loop..." alt="" coords="227,427,375,453"/>
<area shape="rect" id="node16" href="sensor__fusion_8c.html#a9af8710b3e87acd2a33e7988b2d75b6c" title="Function to clear FIFO at the end of each fusion computation. " alt="" coords="473,325,560,352"/>
<area shape="rect" id="node17" href="sensor__fusion_8c.html#a0d688188b65f43d38ac760a79d9eb116" title="readSensors traverses the linked list of physical sensors, calling the individual read functions one ..." alt="" coords="253,477,348,504"/>
<area shape="rect" id="node18" href="sensor__fusion_8c.html#a8b90119fee979d0309cc923bf1fad543" title="runFusion the top level call that actually runs the sensor fusion. This is a utility function which m..." alt="" coords="261,325,340,352"/>
<area shape="rect" id="node27" href="sensor__fusion_8c.html#aef2b1f23f820d2b513bc827f8baffd0d" title="conditionSensorReadings() transforms raw software FIFO readings into forms that can be consumed by th..." alt="" coords="216,528,385,555"/>
<area shape="rect" id="node34" href="sensor__fusion_8c.html#a741fd2193cc58c09b692d1ae2b7a81e8" title="Poor man&#39;s inheritance for status subsystem setStatus command This function is normally involved via ..." alt="" coords="261,579,340,605"/>
<area shape="rect" id="node35" href="sensor__fusion_8c.html#ae96e36747e6a1aabbec1381f15132ec6" title="Poor man&#39;s inheritance for status subsystem queueStatus command. This function is normally involved v..." alt="" coords="253,629,348,656"/>
<area shape="rect" id="node36" href="sensor__fusion_8c.html#aa13c4a9f07f3a2abfdb2e0808e5752d4" title="Poor man&#39;s inheritance for status subsystem updateStatus command. This function is normally involved ..." alt="" coords="251,680,350,707"/>
<area shape="rect" id="node37" href="sensor__fusion_8c.html#a142a0a30c123f8acf79a3e8e5072cad8" title="testStatus" alt="" coords="259,731,342,757"/>
<area shape="rect" id="node4" href="driver__systick_8c.html#a12342d97ebedd191c344ea0d5e1e7646" title="ARM_systick_enable" alt="" coords="444,427,589,453"/>
<area shape="rect" id="node5" href="driver__systick_8c.html#a8075e82d5c7ce23802841551a953e170" title="ARM_systick_delay_ms" alt="" coords="435,477,598,504"/>
<area shape="rect" id="node8" href="sensor__fusion_8c.html#ae748e1330b5a94783c6d4ea2ad9e4f28" title="initializeSensors" alt="" coords="458,528,575,555"/>
<area shape="rect" id="node12" href="fusion_8c.html#ad9cb3659204ae7a30109ceaf4d94ecec" title="fInitializeFusion" alt="" coords="461,376,572,403"/>
<area shape="rect" id="node13" href="magnetic_8c.html#a793003e431e2705d081b5073144cb2c0" title="fInitializeMagCalibration" alt="" coords="437,629,596,656"/>
<area shape="rect" id="node15" href="precisionAccelerometer_8c.html#ab8572ce21837538a984e62035db4d89e" title="Initialize the accelerometer calibration functions. " alt="" coords="433,579,600,605"/>
<area shape="rect" id="node6" href="driver__systick_8c.html#a63b11c5b24615bf03103d7d9e923ba2f" title="ARM_systick_start_ticks" alt="" coords="652,427,820,453"/>
<area shape="rect" id="node7" href="driver__systick_8c.html#a11d2757f060c3c65c1dfe1f7a314bbb3" title="ARM_systick_elapsed\l_ticks" alt="" coords="660,361,812,402"/>
<area shape="rect" id="node9" href="hal__frdm__fxs__mult2__b_8c.html#a6bb19bade42d7adef32375e174de144d" title="Apply the accelerometer Hardware Abstraction Layer. " alt="" coords="679,579,793,605"/>
<area shape="rect" id="node10" href="precisionAccelerometer_8c.html#a3aa550d5d9b592df3fd8b10c97c07d98" title="function maps the accelerometer data fGs (g) onto precision calibrated and de&#45;rotated data fGc (g)..." alt="" coords="683,477,789,504"/>
<area shape="rect" id="node11" href="precisionAccelerometer_8c.html#a012ad7adb564defb7170c246cdb86b04" title="Update the buffer used to store samples used for accelerometer calibration. " alt="" coords="670,528,802,555"/>
<area shape="rect" id="node14" href="matrix_8c.html#a54f510d9d257d6063412a9ed5adddd6f" title="function sets the 3x3 matrix A to the identity matrix " alt="" coords="682,629,790,656"/>
<area shape="rect" id="node19" href="fusion_8c.html#aeb60375528d75ee9fec67a96916141ca" title="fFuseSensors" alt="" coords="465,233,568,260"/>
<area shape="rect" id="node20" href="fusion_8c.html#a2e2258d4d0cd14011d5b198b8cbdab95" title="fRun_1DOF_P_BASIC" alt="" coords="661,259,811,285"/>
<area shape="rect" id="node21" href="fusion_8c.html#a7b5db1923cfa0dc160016e7d9b45b1c2" title="fRun_3DOF_G_BASIC" alt="" coords="660,309,812,336"/>
<area shape="rect" id="node22" href="fusion_8c.html#a2df5be5795338038774a64b41cf53a8e" title="fRun_3DOF_B_BASIC" alt="" coords="661,5,811,32"/>
<area shape="rect" id="node23" href="fusion_8c.html#a288f51cd39aeb8ace643d844e219e9d3" title="fRun_3DOF_Y_BASIC" alt="" coords="661,56,811,83"/>
<area shape="rect" id="node24" href="fusion_8c.html#a34c550860d0e4e42bf22a2a3527043b9" title="fRun_6DOF_GB_BASIC" alt="" coords="655,107,817,133"/>
<area shape="rect" id="node25" href="fusion_8c.html#a942d619f897d6820d5c148bdc910f962" title="fRun_6DOF_GY_KALMAN" alt="" coords="648,208,824,235"/>
<area shape="rect" id="node26" href="fusion_8h.html#a2288989efddb6c41fd593b2f75b7a844" title="fRun_9DOF_GBY_KALMAN" alt="" coords="872,183,1057,209"/>
<area shape="rect" id="node28" href="sensor__fusion_8c.html#aaf8b47198fa614f0b50265addf44a8b0" title="processMagData" alt="" coords="457,756,577,783"/>
<area shape="rect" id="node29" href="hal__frdm__fxs__mult2__b_8c.html#a61ed96ce5838a7f7952539b7d7d944dc" title="Apply the magnetometer Hardware Abstraction Layer. " alt="" coords="683,883,789,909"/>
<area shape="rect" id="node30" href="magnetic_8c.html#a0a0ba578c5de9f06431db84b2b8e3f9a" title="fInvertMagCal" alt="" coords="687,680,785,707"/>
<area shape="rect" id="node31" href="magnetic_8c.html#a3b07f7334d06c86a3e18732a5106a951" title="iUpdateMagBuffer" alt="" coords="674,731,798,757"/>
<area shape="rect" id="node32" href="magnetic_8c.html#a2c2da80362a7b97574c6b60972399b73" title="fRunMagCalibration" alt="" coords="669,781,803,808"/>
<area shape="rect" id="node33" href="hal__frdm__fxs__mult2__b_8c.html#a9b489a682e07db8c11a2121ede929e9e" title="Apply the gyroscope Hardware Abstraction Layer. " alt="" coords="682,832,790,859"/>
</map>
</div>
</p>

<p><div id="dynsection-11" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-11-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-11-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-11-content" class="dyncontent" style="display:none;">
<div class="center"><img src="sensor__fusion_8c_a43b44018042fabb5179c2e62277cc942_icgraph.png" border="0" usemap="#sensor__fusion_8c_a43b44018042fabb5179c2e62277cc942_icgraph" alt=""/></div>
<map name="sensor__fusion_8c_a43b44018042fabb5179c2e62277cc942_icgraph" id="sensor__fusion_8c_a43b44018042fabb5179c2e62277cc942_icgraph">
<area shape="rect" id="node2" href="main__agm01__freertos__two__tasks_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="This is a FreeRTOS (dual task) implementation of the NXP sensor fusion demo build. " alt="" coords="216,5,267,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a45ee1600720deae228f488e6246a747b"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int8_t installSensor </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSensorFusionGlobals.html">SensorFusionGlobals</a> *&#160;</td>
          <td class="paramname"><em>sfg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="structPhysicalSensor.html">PhysicalSensor</a> *&#160;</td>
          <td class="paramname"><em>pSensor</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>addr</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>schedule</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>bus_driver</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sensor__fusion_8h.html#a94a511080fe3acc46bcee1a85f25432c">initializeSensor_t</a> *&#160;</td>
          <td class="paramname"><em>initialize</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sensor__fusion_8h.html#a2c12de378ddfbb05f2f9549b62eddb87">readSensor_t</a> *&#160;</td>
          <td class="paramname"><em>read</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>installSensor is used to instantiate a physical sensor driver into the sensor fusion system. This function is normally involved via the "sfg." global pointer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sfg</td><td>top level fusion structure </td></tr>
    <tr><td class="paramname">pSensor</td><td>pointer to structure describing physical sensor </td></tr>
    <tr><td class="paramname">addr</td><td>I2C address for sensor (if applicable) </td></tr>
    <tr><td class="paramname">schedule</td><td>Parameter to control sensor sampling rate </td></tr>
    <tr><td class="paramname">bus_driver</td><td>ISSDK sensor bus driver (usually KSDK I2C bus) </td></tr>
    <tr><td class="paramname">initialize</td><td>pointer to sensor initialization function </td></tr>
    <tr><td class="paramname">read</td><td>pointer to sensor read function </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="sensor__fusion_8c_source.html#l00122">122</a> of file <a class="el" href="sensor__fusion_8c_source.html">sensor_fusion.c</a>.</p>

<p>Referenced by <a class="el" href="sensor__fusion_8c_source.html#l00068">initSensorFusionGlobals()</a>.</p>
<div class="fragment"><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;{</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    <span class="keywordflow">if</span> (sfg &amp;&amp; pSensor &amp;&amp; bus_driver &amp;&amp; initialize &amp;&amp; read)</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    {</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;        pSensor-&gt;<a class="code" href="structPhysicalSensor.html#aa7b3c47e2be4d604bc40157d590d09b2">bus_driver</a> = bus_driver;</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;        pSensor-&gt;<a class="code" href="structPhysicalSensor.html#a73cbbfac7304c294fd5df41d33a7025e">initialize</a> = initialize;       <span class="comment">// The initialization function is responsible for putting the sensor</span></div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;                                                <span class="comment">// into the proper mode for sensor fusion.  It is normally KSDK-based.</span></div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;        pSensor-&gt;<a class="code" href="structPhysicalSensor.html#a8dcb713c71ef9c193bd7c17c6bf10cb5">read</a> = read;                   <span class="comment">// The read function is responsible for taking sensor readings and</span></div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;                                                <span class="comment">// loading them into the sensor fusion input structures.  Also KDSK-based.</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;        pSensor-&gt;<a class="code" href="structPhysicalSensor.html#a41a6aad09727eb120338c35535a652a6">addr</a> = addr;                   <span class="comment">// I2C address if applicable</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;        pSensor-&gt;<a class="code" href="structPhysicalSensor.html#a69cae2cbda50f7742cce5b9ad412670b">schedule</a> = schedule;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;        pSensor-&gt;<a class="code" href="structPhysicalSensor.html#a5ac5d34e6fa204911ab8492c20890341">slaveParams</a>.pReadPreprocessFN = NULL;  <span class="comment">// SPI-specific parameters get overwritten later if used</span></div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;        pSensor-&gt;<a class="code" href="structPhysicalSensor.html#a5ac5d34e6fa204911ab8492c20890341">slaveParams</a>.pWritePreprocessFN = NULL;</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;        pSensor-&gt;<a class="code" href="structPhysicalSensor.html#a5ac5d34e6fa204911ab8492c20890341">slaveParams</a>.pTargetSlavePinID = NULL;</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        pSensor-&gt;<a class="code" href="structPhysicalSensor.html#a5ac5d34e6fa204911ab8492c20890341">slaveParams</a>.spiCmdLen = 0;</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;        pSensor-&gt;<a class="code" href="structPhysicalSensor.html#a5ac5d34e6fa204911ab8492c20890341">slaveParams</a>.ssActiveValue = 0;</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;        <span class="comment">// Now add the new sensor at the head of the linked list</span></div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;        pSensor-&gt;<a class="code" href="structPhysicalSensor.html#aa204a2ffb38c3a97a939a72960a63637">next</a> = sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a234522d09ba87b3f4177a113b241e573">pSensors</a>;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;        sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a234522d09ba87b3f4177a113b241e573">pSensors</a> = pSensor;</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;        <span class="keywordflow">return</span> (0);</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;    }</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;    {</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;        <span class="keywordflow">return</span> (1);</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    }</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;}</div><div class="ttc" id="structPhysicalSensor_html_aa7b3c47e2be4d604bc40157d590d09b2"><div class="ttname"><a href="structPhysicalSensor.html#aa7b3c47e2be4d604bc40157d590d09b2">PhysicalSensor::bus_driver</a></div><div class="ttdeci">void * bus_driver</div><div class="ttdoc">should be of type (ARM_DRIVER_I2C* for I2C-based sensors, ARM_DRIVER_SPI* for SPI) ...</div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00171">sensor_fusion.h:171</a></div></div>
<div class="ttc" id="structPhysicalSensor_html_a8dcb713c71ef9c193bd7c17c6bf10cb5"><div class="ttname"><a href="structPhysicalSensor.html#a8dcb713c71ef9c193bd7c17c6bf10cb5">PhysicalSensor::read</a></div><div class="ttdeci">readSensor_t * read</div><div class="ttdoc">pointer to function to read sensor using the supplied drivers </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00178">sensor_fusion.h:178</a></div></div>
<div class="ttc" id="structPhysicalSensor_html_a69cae2cbda50f7742cce5b9ad412670b"><div class="ttname"><a href="structPhysicalSensor.html#a69cae2cbda50f7742cce5b9ad412670b">PhysicalSensor::schedule</a></div><div class="ttdeci">uint16_t schedule</div><div class="ttdoc">Parameter to control sensor sampling rate. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00176">sensor_fusion.h:176</a></div></div>
<div class="ttc" id="structPhysicalSensor_html_aa204a2ffb38c3a97a939a72960a63637"><div class="ttname"><a href="structPhysicalSensor.html#aa204a2ffb38c3a97a939a72960a63637">PhysicalSensor::next</a></div><div class="ttdeci">struct PhysicalSensor * next</div><div class="ttdoc">pointer to next sensor in this linked list </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00175">sensor_fusion.h:175</a></div></div>
<div class="ttc" id="structPhysicalSensor_html_a73cbbfac7304c294fd5df41d33a7025e"><div class="ttname"><a href="structPhysicalSensor.html#a73cbbfac7304c294fd5df41d33a7025e">PhysicalSensor::initialize</a></div><div class="ttdeci">initializeSensor_t * initialize</div><div class="ttdoc">pointer to function to initialize sensor using the supplied drivers </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00177">sensor_fusion.h:177</a></div></div>
<div class="ttc" id="structPhysicalSensor_html_a5ac5d34e6fa204911ab8492c20890341"><div class="ttname"><a href="structPhysicalSensor.html#a5ac5d34e6fa204911ab8492c20890341">PhysicalSensor::slaveParams</a></div><div class="ttdeci">spiSlaveSpecificParams_t slaveParams</div><div class="ttdoc">SPI specific parameters. Not used for I2C. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00174">sensor_fusion.h:174</a></div></div>
<div class="ttc" id="structPhysicalSensor_html_a41a6aad09727eb120338c35535a652a6"><div class="ttname"><a href="structPhysicalSensor.html#a41a6aad09727eb120338c35535a652a6">PhysicalSensor::addr</a></div><div class="ttdeci">uint16_t addr</div><div class="ttdoc">I2C address if applicable. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00172">sensor_fusion.h:172</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_a234522d09ba87b3f4177a113b241e573"><div class="ttname"><a href="structSensorFusionGlobals.html#a234522d09ba87b3f4177a113b241e573">SensorFusionGlobals::pSensors</a></div><div class="ttdeci">PhysicalSensor * pSensors</div><div class="ttdoc">a linked list of physical sensors </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00481">sensor_fusion.h:481</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-12" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-12-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-12-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-12-content" class="dyncontent" style="display:none;">
<div class="center"><img src="sensor__fusion_8c_a45ee1600720deae228f488e6246a747b_icgraph.png" border="0" usemap="#sensor__fusion_8c_a45ee1600720deae228f488e6246a747b_icgraph" alt=""/></div>
<map name="sensor__fusion_8c_a45ee1600720deae228f488e6246a747b_icgraph" id="sensor__fusion_8c_a45ee1600720deae228f488e6246a747b_icgraph">
<area shape="rect" id="node2" href="sensor__fusion_8h.html#a367d92b99365a8143700b76439915d65" title="utility function to insert default values in the top level structure " alt="" coords="151,5,313,32"/>
<area shape="rect" id="node3" href="main__agm01__freertos__two__tasks_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="This is a FreeRTOS (dual task) implementation of the NXP sensor fusion demo build. " alt="" coords="361,5,412,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aaf8b47198fa614f0b50265addf44a8b0"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void processMagData </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSensorFusionGlobals.html">SensorFusionGlobals</a> *&#160;</td>
          <td class="paramname"><em>sfg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sensor__fusion_8c_source.html#l00209">209</a> of file <a class="el" href="sensor__fusion_8c_source.html">sensor_fusion.c</a>.</p>

<p>Referenced by <a class="el" href="sensor__fusion_8c_source.html#l00305">conditionSensorReadings()</a>.</p>
<div class="fragment"><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;{</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <a class="code" href="sensor__fusion_8h.html#ab7903878916593daecbeb95b98115ab0">int32</a> iSum[3];              <span class="comment">// channel sums</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <a class="code" href="sensor__fusion_8h.html#aa0d0fdc87fd135ef2bedb030901cdb9c">int16</a> i, j;                 <span class="comment">// counters</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;    <span class="comment">// printf(&quot;ProcessingMagData()\n&quot;);</span></div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="keywordflow">if</span> (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a876af8fddc05153d04bda2d8a8107819">Mag</a>.<a class="code" href="structMagSensor.html#a5bd93348c4a2cb5a2891879388b08f12">iFIFOExceeded</a> &gt; 0) {</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#aa22f9fd7adaca53616ef6bfb6cb051b4">setStatus</a>(sfg, <a class="code" href="sensor__fusion_8h.html#a69ee883e1c22b117df163c0bd83f66ddaef2af24f93594b49dcdee589a73e1772">SOFT_FAULT</a>);</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    }</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;    <a class="code" href="hal__frdm__fxs__mult2__b_8c.html#a61ed96ce5838a7f7952539b7d7d944dc">ApplyMagHAL</a>(&amp;(sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a876af8fddc05153d04bda2d8a8107819">Mag</a>));         <span class="comment">// This function is board-dependent</span></div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;    <span class="comment">// calculate the average HAL-corrected measurement</span></div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    <span class="keywordflow">for</span> (j = <a class="code" href="sensor__fusion_8h.html#a48bbd27e913de8d7749dff9dec2fe816">CHX</a>; j &lt;= <a class="code" href="sensor__fusion_8h.html#a76143891435bdd7248857e45b93521ed">CHZ</a>; j++) iSum[j] = 0;</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;    <span class="keywordflow">for</span> (i = 0; i &lt; sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a876af8fddc05153d04bda2d8a8107819">Mag</a>.<a class="code" href="structMagSensor.html#ae67083bb4e11d18f8d4c50cc43392e38">iFIFOCount</a>; i++)</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordflow">for</span> (j = <a class="code" href="sensor__fusion_8h.html#a48bbd27e913de8d7749dff9dec2fe816">CHX</a>; j &lt;= <a class="code" href="sensor__fusion_8h.html#a76143891435bdd7248857e45b93521ed">CHZ</a>; j++) iSum[j] += sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a876af8fddc05153d04bda2d8a8107819">Mag</a>.<a class="code" href="structMagSensor.html#aeb648ded2510b1686d85cbccaa5e02c5">iBsFIFO</a>[i][j];</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    if (sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a876af8fddc05153d04bda2d8a8107819">Mag</a>.<a class="code" href="structMagSensor.html#ae67083bb4e11d18f8d4c50cc43392e38">iFIFOCount</a> &gt; 0)</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    {</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;      <span class="keywordflow">for</span> (j = <a class="code" href="sensor__fusion_8h.html#a48bbd27e913de8d7749dff9dec2fe816">CHX</a>; j &lt;= <a class="code" href="sensor__fusion_8h.html#a76143891435bdd7248857e45b93521ed">CHZ</a>; j++)</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      {</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;          sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a876af8fddc05153d04bda2d8a8107819">Mag</a>.<a class="code" href="structMagSensor.html#a57ff184e163b1b96fcb95d4c6d401d8a">iBs</a>[j] = (<a class="code" href="sensor__fusion_8h.html#aa0d0fdc87fd135ef2bedb030901cdb9c">int16</a>)(iSum[j] / (<a class="code" href="sensor__fusion_8h.html#ab7903878916593daecbeb95b98115ab0">int32</a>) sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a876af8fddc05153d04bda2d8a8107819">Mag</a>.<a class="code" href="structMagSensor.html#ae67083bb4e11d18f8d4c50cc43392e38">iFIFOCount</a>);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;          sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a876af8fddc05153d04bda2d8a8107819">Mag</a>.<a class="code" href="structMagSensor.html#a6c8c101f0961f5e086ead540a6a106a1">fBs</a>[j] = (float)sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a876af8fddc05153d04bda2d8a8107819">Mag</a>.<a class="code" href="structMagSensor.html#a57ff184e163b1b96fcb95d4c6d401d8a">iBs</a>[j] * sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a876af8fddc05153d04bda2d8a8107819">Mag</a>.<a class="code" href="structMagSensor.html#a2caa6d9b17dec76fd4b56dc2e81becbd">fuTPerCount</a>;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;      }</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;    }</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;    <span class="comment">// remove hard and soft iron terms from fBs (uT) to get calibrated data fBc (uT), iBc (counts) and</span></div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;    <span class="comment">// update magnetic buffer avoiding a write while a magnetic calibration is in progress.</span></div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;    <span class="comment">// run one iteration of the time sliced magnetic calibration</span></div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;    <a class="code" href="magnetic_8c.html#a0a0ba578c5de9f06431db84b2b8e3f9a">fInvertMagCal</a>(&amp;(sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a876af8fddc05153d04bda2d8a8107819">Mag</a>), &amp;(sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#acf241c1ff86d307d296f560449acc2a4">MagCal</a>));</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;    <span class="keywordflow">if</span> (!sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#acf241c1ff86d307d296f560449acc2a4">MagCal</a>.<a class="code" href="structMagCalibration.html#a6607888b132a7b3392b6ee384165dbc6">iMagBufferReadOnly</a>)</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <a class="code" href="magnetic_8c.html#a3b07f7334d06c86a3e18732a5106a951">iUpdateMagBuffer</a>(&amp;(sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#ad44d6aaf76570ad374ad7c170175de5a">MagBuffer</a>), &amp;(sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a876af8fddc05153d04bda2d8a8107819">Mag</a>), sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a0e90feae26cd26ab80bc78cfd9364512">loopcounter</a>);</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;    <a class="code" href="magnetic_8c.html#a2c2da80362a7b97574c6b60972399b73">fRunMagCalibration</a>(&amp;(sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#acf241c1ff86d307d296f560449acc2a4">MagCal</a>), &amp;(sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#ad44d6aaf76570ad374ad7c170175de5a">MagBuffer</a>), &amp;(sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a876af8fddc05153d04bda2d8a8107819">Mag</a>),</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;                           sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a0e90feae26cd26ab80bc78cfd9364512">loopcounter</a>);</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;}</div><div class="ttc" id="structSensorFusionGlobals_html_a0e90feae26cd26ab80bc78cfd9364512"><div class="ttname"><a href="structSensorFusionGlobals.html#a0e90feae26cd26ab80bc78cfd9364512">SensorFusionGlobals::loopcounter</a></div><div class="ttdeci">int32_t loopcounter</div><div class="ttdoc">counter incrementing each iteration of sensor fusion (typically 25Hz) </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00484">sensor_fusion.h:484</a></div></div>
<div class="ttc" id="structMagSensor_html_a57ff184e163b1b96fcb95d4c6d401d8a"><div class="ttname"><a href="structMagSensor.html#a57ff184e163b1b96fcb95d4c6d401d8a">MagSensor::iBs</a></div><div class="ttdeci">int16_t iBs[3]</div><div class="ttdoc">averaged uncalibrated measurement (counts) </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00239">sensor_fusion.h:239</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_acf241c1ff86d307d296f560449acc2a4"><div class="ttname"><a href="structSensorFusionGlobals.html#acf241c1ff86d307d296f560449acc2a4">SensorFusionGlobals::MagCal</a></div><div class="ttdeci">MagCalibration MagCal</div><div class="ttdoc">mag cal storage </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00503">sensor_fusion.h:503</a></div></div>
<div class="ttc" id="magnetic_8c_html_a3b07f7334d06c86a3e18732a5106a951"><div class="ttname"><a href="magnetic_8c.html#a3b07f7334d06c86a3e18732a5106a951">iUpdateMagBuffer</a></div><div class="ttdeci">void iUpdateMagBuffer(MagBuffer *pthisMagBuffer, MagSensor *pthisMag, int32 loopcounter)</div><div class="ttdef"><b>Definition:</b> <a href="magnetic_8c_source.html#l00103">magnetic.c:103</a></div></div>
<div class="ttc" id="magnetic_8c_html_a0a0ba578c5de9f06431db84b2b8e3f9a"><div class="ttname"><a href="magnetic_8c.html#a0a0ba578c5de9f06431db84b2b8e3f9a">fInvertMagCal</a></div><div class="ttdeci">void fInvertMagCal(MagSensor *pthisMag, MagCalibration *pthisMagCal)</div><div class="ttdef"><b>Definition:</b> <a href="magnetic_8c_source.html#l00297">magnetic.c:297</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_ab7903878916593daecbeb95b98115ab0"><div class="ttname"><a href="sensor__fusion_8h.html#ab7903878916593daecbeb95b98115ab0">int32</a></div><div class="ttdeci">int32_t int32</div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00057">sensor_fusion.h:57</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_a876af8fddc05153d04bda2d8a8107819"><div class="ttname"><a href="structSensorFusionGlobals.html#a876af8fddc05153d04bda2d8a8107819">SensorFusionGlobals::Mag</a></div><div class="ttdeci">MagSensor Mag</div><div class="ttdoc">magnetometer storage </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00492">sensor_fusion.h:492</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_a69ee883e1c22b117df163c0bd83f66ddaef2af24f93594b49dcdee589a73e1772"><div class="ttname"><a href="sensor__fusion_8h.html#a69ee883e1c22b117df163c0bd83f66ddaef2af24f93594b49dcdee589a73e1772">SOFT_FAULT</a></div><div class="ttdoc">Recoverable FAULT = something went wrong, but we can keep going. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00128">sensor_fusion.h:128</a></div></div>
<div class="ttc" id="structMagCalibration_html_a6607888b132a7b3392b6ee384165dbc6"><div class="ttname"><a href="structMagCalibration.html#a6607888b132a7b3392b6ee384165dbc6">MagCalibration::iMagBufferReadOnly</a></div><div class="ttdeci">int8_t iMagBufferReadOnly</div><div class="ttdoc">flag to denote that the magnetic measurement buffer is temporarily read only </div><div class="ttdef"><b>Definition:</b> <a href="magnetic_8h_source.html#l00100">magnetic.h:100</a></div></div>
<div class="ttc" id="structMagSensor_html_a2caa6d9b17dec76fd4b56dc2e81becbd"><div class="ttname"><a href="structMagSensor.html#a2caa6d9b17dec76fd4b56dc2e81becbd">MagSensor::fuTPerCount</a></div><div class="ttdeci">float fuTPerCount</div><div class="ttdoc">uT per count </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00237">sensor_fusion.h:237</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_a76143891435bdd7248857e45b93521ed"><div class="ttname"><a href="sensor__fusion_8h.html#a76143891435bdd7248857e45b93521ed">CHZ</a></div><div class="ttdeci">#define CHZ</div></div>
<div class="ttc" id="magnetic_8c_html_a2c2da80362a7b97574c6b60972399b73"><div class="ttname"><a href="magnetic_8c.html#a2c2da80362a7b97574c6b60972399b73">fRunMagCalibration</a></div><div class="ttdeci">void fRunMagCalibration(MagCalibration *pthisMagCal, MagBuffer *pthisMagBuffer, MagSensor *pthisMag, int32 loopcounter)</div><div class="ttdef"><b>Definition:</b> <a href="magnetic_8c_source.html#l00325">magnetic.c:325</a></div></div>
<div class="ttc" id="structMagSensor_html_ae67083bb4e11d18f8d4c50cc43392e38"><div class="ttname"><a href="structMagSensor.html#ae67083bb4e11d18f8d4c50cc43392e38">MagSensor::iFIFOCount</a></div><div class="ttdeci">uint8_t iFIFOCount</div><div class="ttdoc">number of measurements read from FIFO </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00231">sensor_fusion.h:231</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_a48bbd27e913de8d7749dff9dec2fe816"><div class="ttname"><a href="sensor__fusion_8h.html#a48bbd27e913de8d7749dff9dec2fe816">CHX</a></div><div class="ttdeci">#define CHX</div><div class="ttdoc">Used to access X-channel entries in various data data structures. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00076">sensor_fusion.h:76</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_ad44d6aaf76570ad374ad7c170175de5a"><div class="ttname"><a href="structSensorFusionGlobals.html#ad44d6aaf76570ad374ad7c170175de5a">SensorFusionGlobals::MagBuffer</a></div><div class="ttdeci">MagBuffer MagBuffer</div><div class="ttdoc">mag cal constellation points </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00504">sensor_fusion.h:504</a></div></div>
<div class="ttc" id="structMagSensor_html_a5bd93348c4a2cb5a2891879388b08f12"><div class="ttname"><a href="structMagSensor.html#a5bd93348c4a2cb5a2891879388b08f12">MagSensor::iFIFOExceeded</a></div><div class="ttdeci">uint16_t iFIFOExceeded</div><div class="ttdoc">Number of samples received in excess of software FIFO size. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00232">sensor_fusion.h:232</a></div></div>
<div class="ttc" id="structMagSensor_html_a6c8c101f0961f5e086ead540a6a106a1"><div class="ttname"><a href="structMagSensor.html#a6c8c101f0961f5e086ead540a6a106a1">MagSensor::fBs</a></div><div class="ttdeci">float fBs[3]</div><div class="ttdoc">averaged un-calibrated measurement (uT) </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00235">sensor_fusion.h:235</a></div></div>
<div class="ttc" id="structMagSensor_html_aeb648ded2510b1686d85cbccaa5e02c5"><div class="ttname"><a href="structMagSensor.html#aeb648ded2510b1686d85cbccaa5e02c5">MagSensor::iBsFIFO</a></div><div class="ttdeci">int16_t iBsFIFO[MAG_FIFO_SIZE][3]</div><div class="ttdoc">FIFO measurements (counts) </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00233">sensor_fusion.h:233</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_aa22f9fd7adaca53616ef6bfb6cb051b4"><div class="ttname"><a href="structSensorFusionGlobals.html#aa22f9fd7adaca53616ef6bfb6cb051b4">SensorFusionGlobals::setStatus</a></div><div class="ttdeci">setStatus_t * setStatus</div><div class="ttdoc">change status indicator immediately </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00544">sensor_fusion.h:544</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_aa0d0fdc87fd135ef2bedb030901cdb9c"><div class="ttname"><a href="sensor__fusion_8h.html#aa0d0fdc87fd135ef2bedb030901cdb9c">int16</a></div><div class="ttdeci">int16_t int16</div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00056">sensor_fusion.h:56</a></div></div>
<div class="ttc" id="hal__frdm__fxs__mult2__b_8c_html_a61ed96ce5838a7f7952539b7d7d944dc"><div class="ttname"><a href="hal__frdm__fxs__mult2__b_8c.html#a61ed96ce5838a7f7952539b7d7d944dc">ApplyMagHAL</a></div><div class="ttdeci">void ApplyMagHAL(MagSensor *Mag)</div><div class="ttdoc">Apply the magnetometer Hardware Abstraction Layer. </div><div class="ttdef"><b>Definition:</b> <a href="hal__frdm__fxs__mult2__b_8c_source.html#l00071">hal_frdm_fxs_mult2_b.c:71</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-13" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-13-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-13-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-13-content" class="dyncontent" style="display:none;">
<div class="center"><img src="sensor__fusion_8c_aaf8b47198fa614f0b50265addf44a8b0_cgraph.png" border="0" usemap="#sensor__fusion_8c_aaf8b47198fa614f0b50265addf44a8b0_cgraph" alt=""/></div>
<map name="sensor__fusion_8c_aaf8b47198fa614f0b50265addf44a8b0_cgraph" id="sensor__fusion_8c_aaf8b47198fa614f0b50265addf44a8b0_cgraph">
<area shape="rect" id="node2" href="hal__frdm__fxs__mult2__b_8c.html#a61ed96ce5838a7f7952539b7d7d944dc" title="Apply the magnetometer Hardware Abstraction Layer. " alt="" coords="188,5,293,32"/>
<area shape="rect" id="node3" href="magnetic_8c.html#a0a0ba578c5de9f06431db84b2b8e3f9a" title="fInvertMagCal" alt="" coords="191,56,290,83"/>
<area shape="rect" id="node4" href="magnetic_8c.html#a3b07f7334d06c86a3e18732a5106a951" title="iUpdateMagBuffer" alt="" coords="179,107,303,133"/>
<area shape="rect" id="node5" href="magnetic_8c.html#a2c2da80362a7b97574c6b60972399b73" title="fRunMagCalibration" alt="" coords="173,157,308,184"/>
<area shape="rect" id="node16" href="hal__frdm__fxs__mult2__b_8c.html#a9b489a682e07db8c11a2121ede929e9e" title="Apply the gyroscope Hardware Abstraction Layer. " alt="" coords="187,208,295,235"/>
<area shape="rect" id="node6" href="magnetic_8c.html#ab6f86b6d28bc71b2ce3afc7c374c462e" title="fUpdateMagCalibration4Slice" alt="" coords="359,107,547,133"/>
<area shape="rect" id="node9" href="magnetic_8c.html#aad08380c7f86edfe8480d6a7555172b8" title="fUpdateMagCalibration7Slice" alt="" coords="359,157,547,184"/>
<area shape="rect" id="node11" href="magnetic_8c.html#a5798cb74fc7f5956db643d09a3750e09" title="fUpdateMagCalibration10Slice" alt="" coords="356,233,551,260"/>
<area shape="rect" id="node7" href="matrix_8c.html#a64363bfcc2226e12d1bc28e7382591cc" title="function uses Gauss&#45;Jordan elimination to compute the inverse of matrix A in situ on exit..." alt="" coords="624,56,732,83"/>
<area shape="rect" id="node8" href="matrix_8c.html#a54f510d9d257d6063412a9ed5adddd6f" title="function sets the 3x3 matrix A to the identity matrix " alt="" coords="805,208,913,235"/>
<area shape="rect" id="node10" href="matrix_8c.html#aad87540028353c5db92043a38ed70c1a" title="fComputeEigSlice" alt="" coords="615,157,741,184"/>
<area shape="rect" id="node12" href="matrix_8c.html#a661c761f004eb9f4b050f201b0991004" title="function calculates the determinant of a 3x3 matrix " alt="" coords="623,208,733,235"/>
<area shape="rect" id="node13" href="matrix_8c.html#a810b959d44c67c3cd94347fe34d02d96" title="function negates all elements of 3x3 matrix A " alt="" coords="603,259,753,285"/>
<area shape="rect" id="node14" href="matrix_8c.html#a95d2ac82a68706e246b4cdd516f9378f" title="function directly calculates the symmetric inverse of a symmetric 3x3 matrix only the on and above di..." alt="" coords="600,309,756,336"/>
<area shape="rect" id="node15" href="matrix_8c.html#a36f36bcaf2395595541a20fd4ab7c351" title="function multiplies all elements of 3x3 matrix A by the specified scalar " alt="" coords="599,360,757,387"/>
</map>
</div>
</p>

<p><div id="dynsection-14" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-14-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-14-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-14-content" class="dyncontent" style="display:none;">
<div class="center"><img src="sensor__fusion_8c_aaf8b47198fa614f0b50265addf44a8b0_icgraph.png" border="0" usemap="#sensor__fusion_8c_aaf8b47198fa614f0b50265addf44a8b0_icgraph" alt=""/></div>
<map name="sensor__fusion_8c_aaf8b47198fa614f0b50265addf44a8b0_icgraph" id="sensor__fusion_8c_aaf8b47198fa614f0b50265addf44a8b0_icgraph">
<area shape="rect" id="node2" href="sensor__fusion_8h.html#aef2b1f23f820d2b513bc827f8baffd0d" title="conditionSensorReadings() transforms raw software FIFO readings into forms that can be consumed by th..." alt="" coords="173,5,343,32"/>
<area shape="rect" id="node3" href="sensor__fusion_8h.html#a367d92b99365a8143700b76439915d65" title="utility function to insert default values in the top level structure " alt="" coords="391,5,553,32"/>
<area shape="rect" id="node4" href="main__agm01__freertos__two__tasks_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="This is a FreeRTOS (dual task) implementation of the NXP sensor fusion demo build. " alt="" coords="601,5,652,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ae96e36747e6a1aabbec1381f15132ec6"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void queueStatus </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSensorFusionGlobals.html">SensorFusionGlobals</a> *&#160;</td>
          <td class="paramname"><em>sfg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sensor__fusion_8h.html#a69ee883e1c22b117df163c0bd83f66dd">fusion_status_t</a>&#160;</td>
          <td class="paramname"><em>status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Poor man's inheritance for status subsystem queueStatus command. This function is normally involved via the "sfg." global pointer. </p>

<p>Definition at line <a class="el" href="sensor__fusion_8c_source.html#l00050">50</a> of file <a class="el" href="sensor__fusion_8c_source.html">sensor_fusion.c</a>.</p>

<p>Referenced by <a class="el" href="sensor__fusion_8c_source.html#l00068">initSensorFusionGlobals()</a>.</p>
<div class="fragment"><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;{</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a8f77cc84b021a9a1d91f6f049029d76d">pStatusSubsystem</a>-&gt;<a class="code" href="structStatusSubsystem.html#a15f064f701fa865d5ef96db12a023ef0">queue</a>(sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a8f77cc84b021a9a1d91f6f049029d76d">pStatusSubsystem</a>, status);</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;}</div><div class="ttc" id="structSensorFusionGlobals_html_a8f77cc84b021a9a1d91f6f049029d76d"><div class="ttname"><a href="structSensorFusionGlobals.html#a8f77cc84b021a9a1d91f6f049029d76d">SensorFusionGlobals::pStatusSubsystem</a></div><div class="ttdeci">struct StatusSubsystem * pStatusSubsystem</div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00476">sensor_fusion.h:476</a></div></div>
<div class="ttc" id="structStatusSubsystem_html_a15f064f701fa865d5ef96db12a023ef0"><div class="ttname"><a href="structStatusSubsystem.html#a15f064f701fa865d5ef96db12a023ef0">StatusSubsystem::queue</a></div><div class="ttdeci">ssSetStatus_t * queue</div><div class="ttdoc">queue status change for next regular interval </div><div class="ttdef"><b>Definition:</b> <a href="status_8h_source.html#l00051">status.h:51</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-15" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-15-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-15-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-15-content" class="dyncontent" style="display:none;">
<div class="center"><img src="sensor__fusion_8c_ae96e36747e6a1aabbec1381f15132ec6_icgraph.png" border="0" usemap="#sensor__fusion_8c_ae96e36747e6a1aabbec1381f15132ec6_icgraph" alt=""/></div>
<map name="sensor__fusion_8c_ae96e36747e6a1aabbec1381f15132ec6_icgraph" id="sensor__fusion_8c_ae96e36747e6a1aabbec1381f15132ec6_icgraph">
<area shape="rect" id="node2" href="sensor__fusion_8h.html#a367d92b99365a8143700b76439915d65" title="utility function to insert default values in the top level structure " alt="" coords="148,5,311,32"/>
<area shape="rect" id="node3" href="main__agm01__freertos__two__tasks_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="This is a FreeRTOS (dual task) implementation of the NXP sensor fusion demo build. " alt="" coords="359,5,409,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a0d688188b65f43d38ac760a79d9eb116"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">int8_t readSensors </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSensorFusionGlobals.html">SensorFusionGlobals</a> *&#160;</td>
          <td class="paramname"><em>sfg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>read_loop_counter</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>readSensors traverses the linked list of physical sensors, calling the individual read functions one by one. This function is normally involved via the "sfg." global pointer. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">sfg</td><td>pointer to global sensor fusion data structure </td></tr>
    <tr><td class="paramname">read_loop_counter</td><td>current loop counter (used for multirate processing) </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="sensor__fusion_8c_source.html#l00276">276</a> of file <a class="el" href="sensor__fusion_8c_source.html">sensor_fusion.c</a>.</p>

<p>Referenced by <a class="el" href="sensor__fusion_8c_source.html#l00068">initSensorFusionGlobals()</a>.</p>
<div class="fragment"><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;{</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;    <a class="code" href="structPhysicalSensor.html">PhysicalSensor</a>  *pSensor;</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;    int8_t          s;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    int8_t          status = 0;</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordtype">float</span>           remainder;</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    pSensor = sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a234522d09ba87b3f4177a113b241e573">pSensors</a>;</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">for</span> (pSensor = sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a234522d09ba87b3f4177a113b241e573">pSensors</a>; pSensor != NULL; pSensor = pSensor-&gt;<a class="code" href="structPhysicalSensor.html#aa204a2ffb38c3a97a939a72960a63637">next</a>)</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;    {   <span class="keywordflow">if</span> (pSensor-&gt;<a class="code" href="structPhysicalSensor.html#a87223885ad859bb82fdc45644bc1f0b2">isInitialized</a>) {</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;            remainder = fmod(read_loop_counter, pSensor-&gt;<a class="code" href="structPhysicalSensor.html#a69cae2cbda50f7742cce5b9ad412670b">schedule</a>);</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            <span class="keywordflow">if</span> (remainder==0) {</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                s = pSensor-&gt;<a class="code" href="structPhysicalSensor.html#a8dcb713c71ef9c193bd7c17c6bf10cb5">read</a>(pSensor, sfg);</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                <span class="keywordflow">if</span> (status == 0) status = s;            <span class="comment">// will return 1st error flag, but try all sensors</span></div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;            }</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;        }</div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;    }</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;    <span class="keywordflow">if</span> (status==SENSOR_ERROR_INIT) sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#aa22f9fd7adaca53616ef6bfb6cb051b4">setStatus</a>(sfg, <a class="code" href="sensor__fusion_8h.html#a69ee883e1c22b117df163c0bd83f66dda2142c7e506bbaf9dba4175fee014862f">HARD_FAULT</a>);  <span class="comment">// Never returns</span></div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;    <span class="keywordflow">return</span> (status);</div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;}</div><div class="ttc" id="structPhysicalSensor_html_a8dcb713c71ef9c193bd7c17c6bf10cb5"><div class="ttname"><a href="structPhysicalSensor.html#a8dcb713c71ef9c193bd7c17c6bf10cb5">PhysicalSensor::read</a></div><div class="ttdeci">readSensor_t * read</div><div class="ttdoc">pointer to function to read sensor using the supplied drivers </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00178">sensor_fusion.h:178</a></div></div>
<div class="ttc" id="structPhysicalSensor_html_a69cae2cbda50f7742cce5b9ad412670b"><div class="ttname"><a href="structPhysicalSensor.html#a69cae2cbda50f7742cce5b9ad412670b">PhysicalSensor::schedule</a></div><div class="ttdeci">uint16_t schedule</div><div class="ttdoc">Parameter to control sensor sampling rate. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00176">sensor_fusion.h:176</a></div></div>
<div class="ttc" id="structPhysicalSensor_html_aa204a2ffb38c3a97a939a72960a63637"><div class="ttname"><a href="structPhysicalSensor.html#aa204a2ffb38c3a97a939a72960a63637">PhysicalSensor::next</a></div><div class="ttdeci">struct PhysicalSensor * next</div><div class="ttdoc">pointer to next sensor in this linked list </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00175">sensor_fusion.h:175</a></div></div>
<div class="ttc" id="sensor__fusion_8h_html_a69ee883e1c22b117df163c0bd83f66dda2142c7e506bbaf9dba4175fee014862f"><div class="ttname"><a href="sensor__fusion_8h.html#a69ee883e1c22b117df163c0bd83f66dda2142c7e506bbaf9dba4175fee014862f">HARD_FAULT</a></div><div class="ttdoc">Non-recoverable FAULT = something went very wrong. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00127">sensor_fusion.h:127</a></div></div>
<div class="ttc" id="structPhysicalSensor_html"><div class="ttname"><a href="structPhysicalSensor.html">PhysicalSensor</a></div><div class="ttdoc">An instance of PhysicalSensor structure type should be allocated for each physical sensors (combo dev...</div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00170">sensor_fusion.h:170</a></div></div>
<div class="ttc" id="structPhysicalSensor_html_a87223885ad859bb82fdc45644bc1f0b2"><div class="ttname"><a href="structPhysicalSensor.html#a87223885ad859bb82fdc45644bc1f0b2">PhysicalSensor::isInitialized</a></div><div class="ttdeci">uint16_t isInitialized</div><div class="ttdoc">Bitfields to indicate sensor is active (use SensorBitFields from build.h) </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00173">sensor_fusion.h:173</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_aa22f9fd7adaca53616ef6bfb6cb051b4"><div class="ttname"><a href="structSensorFusionGlobals.html#aa22f9fd7adaca53616ef6bfb6cb051b4">SensorFusionGlobals::setStatus</a></div><div class="ttdeci">setStatus_t * setStatus</div><div class="ttdoc">change status indicator immediately </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00544">sensor_fusion.h:544</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_a234522d09ba87b3f4177a113b241e573"><div class="ttname"><a href="structSensorFusionGlobals.html#a234522d09ba87b3f4177a113b241e573">SensorFusionGlobals::pSensors</a></div><div class="ttdeci">PhysicalSensor * pSensors</div><div class="ttdoc">a linked list of physical sensors </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00481">sensor_fusion.h:481</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-16" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-16-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-16-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-16-content" class="dyncontent" style="display:none;">
<div class="center"><img src="sensor__fusion_8c_a0d688188b65f43d38ac760a79d9eb116_icgraph.png" border="0" usemap="#sensor__fusion_8c_a0d688188b65f43d38ac760a79d9eb116_icgraph" alt=""/></div>
<map name="sensor__fusion_8c_a0d688188b65f43d38ac760a79d9eb116_icgraph" id="sensor__fusion_8c_a0d688188b65f43d38ac760a79d9eb116_icgraph">
<area shape="rect" id="node2" href="sensor__fusion_8h.html#a367d92b99365a8143700b76439915d65" title="utility function to insert default values in the top level structure " alt="" coords="148,5,311,32"/>
<area shape="rect" id="node3" href="main__agm01__freertos__two__tasks_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="This is a FreeRTOS (dual task) implementation of the NXP sensor fusion demo build. " alt="" coords="359,5,409,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a8b90119fee979d0309cc923bf1fad543"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void runFusion </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSensorFusionGlobals.html">SensorFusionGlobals</a> *&#160;</td>
          <td class="paramname"><em>sfg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>runFusion the top level call that actually runs the sensor fusion. This is a utility function which manages the various defines in build.h. You should feel free to drop down a level and implement only those portions of <a class="el" href="fusion_8c.html#aeb60375528d75ee9fec67a96916141ca">fFuseSensors()</a> that your application needs. This function is normally involved via the "sfg." global pointer. </p>

<p>Definition at line <a class="el" href="sensor__fusion_8c_source.html#l00386">386</a> of file <a class="el" href="sensor__fusion_8c_source.html">sensor_fusion.c</a>.</p>

<p>Referenced by <a class="el" href="sensor__fusion_8c_source.html#l00068">initSensorFusionGlobals()</a>.</p>
<div class="fragment"><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;{</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="keyword">struct </span><a class="code" href="structSV__1DOF__P__BASIC.html">SV_1DOF_P_BASIC</a> *pSV_1DOF_P_BASIC;</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="keyword">struct </span><a class="code" href="structSV__3DOF__G__BASIC.html">SV_3DOF_G_BASIC</a> *pSV_3DOF_G_BASIC;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="keyword">struct </span><a class="code" href="structSV__3DOF__B__BASIC.html">SV_3DOF_B_BASIC</a> *pSV_3DOF_B_BASIC;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="keyword">struct </span><a class="code" href="structSV__3DOF__Y__BASIC.html">SV_3DOF_Y_BASIC</a> *pSV_3DOF_Y_BASIC;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="keyword">struct </span><a class="code" href="structSV__6DOF__GB__BASIC.html">SV_6DOF_GB_BASIC</a> *pSV_6DOF_GB_BASIC;</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="keyword">struct </span><a class="code" href="structSV__6DOF__GY__KALMAN.html">SV_6DOF_GY_KALMAN</a> *pSV_6DOF_GY_KALMAN;</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="keyword">struct </span><a class="code" href="structSV__9DOF__GBY__KALMAN.html">SV_9DOF_GBY_KALMAN</a> *pSV_9DOF_GBY_KALMAN;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="keyword">struct </span><a class="code" href="structAccelSensor.html">AccelSensor</a> *pAccel;</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="keyword">struct </span><a class="code" href="structMagSensor.html">MagSensor</a> *pMag;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="keyword">struct </span><a class="code" href="structGyroSensor.html">GyroSensor</a> *pGyro;</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="keyword">struct </span><a class="code" href="structPressureSensor.html">PressureSensor</a> *pPressure;</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;    <span class="keyword">struct </span><a class="code" href="structMagCalibration.html">MagCalibration</a> *pMagCal;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;<span class="preprocessor">#if F_1DOF_P_BASIC</span></div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;    pSV_1DOF_P_BASIC = &amp;(sfg-&gt;SV_1DOF_P_BASIC);</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;    pSV_1DOF_P_BASIC = NULL;</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;<span class="preprocessor">#if F_3DOF_G_BASIC</span></div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;    pSV_3DOF_G_BASIC = &amp;(sfg-&gt;SV_3DOF_G_BASIC)  ;</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    pSV_3DOF_G_BASIC = NULL;</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;<span class="preprocessor">#if F_3DOF_B_BASIC</span></div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    pSV_3DOF_B_BASIC = &amp;(sfg-&gt;SV_3DOF_B_BASIC);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    pSV_3DOF_B_BASIC = NULL;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;<span class="preprocessor">#if F_3DOF_Y_BASIC</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    pSV_3DOF_Y_BASIC = &amp;(sfg-&gt;SV_3DOF_Y_BASIC);</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;    pSV_3DOF_Y_BASIC = NULL;</div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00420"></a><span class="lineno">  420</span>&#160;<span class="preprocessor">#if F_6DOF_GB_BASIC</span></div><div class="line"><a name="l00421"></a><span class="lineno">  421</span>&#160;    pSV_6DOF_GB_BASIC = &amp;(sfg-&gt;SV_6DOF_GB_BASIC);</div><div class="line"><a name="l00422"></a><span class="lineno">  422</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;    pSV_6DOF_GB_BASIC = NULL;</div><div class="line"><a name="l00424"></a><span class="lineno">  424</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00425"></a><span class="lineno">  425</span>&#160;<span class="preprocessor">#if F_6DOF_GY_KALMAN</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;    pSV_6DOF_GY_KALMAN = &amp;(sfg-&gt;SV_6DOF_GY_KALMAN);</div><div class="line"><a name="l00427"></a><span class="lineno">  427</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00428"></a><span class="lineno">  428</span>&#160;    pSV_6DOF_GY_KALMAN = NULL;</div><div class="line"><a name="l00429"></a><span class="lineno">  429</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;<span class="preprocessor">#if F_9DOF_GBY_KALMAN</span></div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;    pSV_9DOF_GBY_KALMAN = &amp;(sfg-&gt;SV_9DOF_GBY_KALMAN);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;    pSV_9DOF_GBY_KALMAN = NULL;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;<span class="preprocessor">#if F_USING_ACCEL</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;    pAccel =  &amp;(sfg-&gt;Accel);</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00438"></a><span class="lineno">  438</span>&#160;    pAccel = NULL;</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;<span class="preprocessor">#if F_USING_MAG</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    pMag = &amp;(sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a876af8fddc05153d04bda2d8a8107819">Mag</a>);</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    pMagCal = &amp;(sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#acf241c1ff86d307d296f560449acc2a4">MagCal</a>);</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;    pMag = NULL;</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;    pMagCal = NULL;</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;<span class="preprocessor">#if F_USING_GYRO</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;    pGyro = &amp;(sfg-&gt;Gyro);</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    pGyro = NULL;</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;<span class="preprocessor">#if F_USING_PRESSURE</span></div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    pPressure = &amp;(sfg-&gt;Pressure);</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;<span class="preprocessor">#else</span></div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    pPressure = NULL;</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;<span class="preprocessor">#endif</span></div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;    <span class="comment">// conditionSensorReadings(sfg);  must be called prior to this function</span></div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;    <span class="comment">// fuse the sensor data</span></div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;    <a class="code" href="fusion_8c.html#aeb60375528d75ee9fec67a96916141ca">fFuseSensors</a>(pSV_1DOF_P_BASIC, pSV_3DOF_G_BASIC,</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;                 pSV_3DOF_B_BASIC, pSV_3DOF_Y_BASIC,</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;                 pSV_6DOF_GB_BASIC, pSV_6DOF_GY_KALMAN,</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;                 pSV_9DOF_GBY_KALMAN, pAccel, pMag, pGyro,</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                 pPressure, pMagCal);</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;    <a class="code" href="sensor__fusion_8c.html#a9af8710b3e87acd2a33e7988b2d75b6c">clearFIFOs</a>(sfg);</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;}</div><div class="ttc" id="structSV__3DOF__Y__BASIC_html"><div class="ttname"><a href="structSV__3DOF__Y__BASIC.html">SV_3DOF_Y_BASIC</a></div><div class="ttdoc">SV_3DOF_Y_BASIC structure is the 3DOF basic gyroscope state vector structure. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00328">sensor_fusion.h:328</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_acf241c1ff86d307d296f560449acc2a4"><div class="ttname"><a href="structSensorFusionGlobals.html#acf241c1ff86d307d296f560449acc2a4">SensorFusionGlobals::MagCal</a></div><div class="ttdeci">MagCalibration MagCal</div><div class="ttdoc">mag cal storage </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00503">sensor_fusion.h:503</a></div></div>
<div class="ttc" id="structSV__3DOF__G__BASIC_html"><div class="ttname"><a href="structSV__3DOF__G__BASIC.html">SV_3DOF_G_BASIC</a></div><div class="ttdoc">This is the 3DOF basic accelerometer state vector structure. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00284">sensor_fusion.h:284</a></div></div>
<div class="ttc" id="sensor__fusion_8c_html_a9af8710b3e87acd2a33e7988b2d75b6c"><div class="ttname"><a href="sensor__fusion_8c.html#a9af8710b3e87acd2a33e7988b2d75b6c">clearFIFOs</a></div><div class="ttdeci">void clearFIFOs(SensorFusionGlobals *sfg)</div><div class="ttdoc">Function to clear FIFO at the end of each fusion computation. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8c_source.html#l00363">sensor_fusion.c:363</a></div></div>
<div class="ttc" id="structAccelSensor_html"><div class="ttname"><a href="structAccelSensor.html">AccelSensor</a></div><div class="ttdoc">The AccelSensor structure stores raw and processed measurements for a 3-axis accelerometer. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00205">sensor_fusion.h:205</a></div></div>
<div class="ttc" id="structMagCalibration_html"><div class="ttname"><a href="structMagCalibration.html">MagCalibration</a></div><div class="ttdoc">Magnetic Calibration Structure. </div><div class="ttdef"><b>Definition:</b> <a href="magnetic_8h_source.html#l00072">magnetic.h:72</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_a876af8fddc05153d04bda2d8a8107819"><div class="ttname"><a href="structSensorFusionGlobals.html#a876af8fddc05153d04bda2d8a8107819">SensorFusionGlobals::Mag</a></div><div class="ttdeci">MagSensor Mag</div><div class="ttdoc">magnetometer storage </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00492">sensor_fusion.h:492</a></div></div>
<div class="ttc" id="structSV__1DOF__P__BASIC_html"><div class="ttname"><a href="structSV__1DOF__P__BASIC.html">SV_1DOF_P_BASIC</a></div><div class="ttdoc">The SV_1DOF_P_BASIC structure contains state information for a pressure sensor/altimeter. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00273">sensor_fusion.h:273</a></div></div>
<div class="ttc" id="structSV__3DOF__B__BASIC_html"><div class="ttname"><a href="structSV__3DOF__B__BASIC.html">SV_3DOF_B_BASIC</a></div><div class="ttdoc">This is the 3DOF basic magnetometer state vector structure/. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00306">sensor_fusion.h:306</a></div></div>
<div class="ttc" id="structPressureSensor_html"><div class="ttname"><a href="structPressureSensor.html">PressureSensor</a></div><div class="ttdoc">The PressureSensor structure stores raw and processed measurements for an altimeter. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00187">sensor_fusion.h:187</a></div></div>
<div class="ttc" id="structSV__6DOF__GB__BASIC_html"><div class="ttname"><a href="structSV__6DOF__GB__BASIC.html">SV_6DOF_GB_BASIC</a></div><div class="ttdoc">SV_6DOF_GB_BASIC is the 6DOF basic accelerometer and magnetometer state vector structure. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00347">sensor_fusion.h:347</a></div></div>
<div class="ttc" id="structMagSensor_html"><div class="ttname"><a href="structMagSensor.html">MagSensor</a></div><div class="ttdoc">The MagSensor structure stores raw and processed measurements for a 3-axis magnetic sensor...</div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00227">sensor_fusion.h:227</a></div></div>
<div class="ttc" id="structGyroSensor_html"><div class="ttname"><a href="structGyroSensor.html">GyroSensor</a></div><div class="ttdoc">The GyroSensor structure stores raw and processed measurements for a 3-axis gyroscope. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00249">sensor_fusion.h:249</a></div></div>
<div class="ttc" id="fusion_8c_html_aeb60375528d75ee9fec67a96916141ca"><div class="ttname"><a href="fusion_8c.html#aeb60375528d75ee9fec67a96916141ca">fFuseSensors</a></div><div class="ttdeci">void fFuseSensors(struct SV_1DOF_P_BASIC *pthisSV_1DOF_P_BASIC, struct SV_3DOF_G_BASIC *pthisSV_3DOF_G_BASIC, struct SV_3DOF_B_BASIC *pthisSV_3DOF_B_BASIC, struct SV_3DOF_Y_BASIC *pthisSV_3DOF_Y_BASIC, struct SV_6DOF_GB_BASIC *pthisSV_6DOF_GB_BASIC, struct SV_6DOF_GY_KALMAN *pthisSV_6DOF_GY_KALMAN, struct SV_9DOF_GBY_KALMAN *pthisSV_9DOF_GBY_KALMAN, struct AccelSensor *pthisAccel, struct MagSensor *pthisMag, struct GyroSensor *pthisGyro, struct PressureSensor *pthisPressure, struct MagCalibration *pthisMagCal)</div><div class="ttdef"><b>Definition:</b> <a href="fusion_8c_source.html#l00086">fusion.c:86</a></div></div>
<div class="ttc" id="structSV__6DOF__GY__KALMAN_html"><div class="ttname"><a href="structSV__6DOF__GY__KALMAN.html">SV_6DOF_GY_KALMAN</a></div><div class="ttdoc">SV_6DOF_GY_KALMAN is the 6DOF Kalman filter accelerometer and gyroscope state vector structure...</div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00371">sensor_fusion.h:371</a></div></div>
<div class="ttc" id="structSV__9DOF__GBY__KALMAN_html"><div class="ttname"><a href="structSV__9DOF__GBY__KALMAN.html">SV_9DOF_GBY_KALMAN</a></div><div class="ttdoc">SV_9DOF_GBY_KALMAN is the 9DOF Kalman filter accelerometer, magnetometer and gyroscope state vector s...</div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00405">sensor_fusion.h:405</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-17" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-17-trigger" src="closed.png" alt="+"/> Here is the call graph for this function:</div>
<div id="dynsection-17-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-17-content" class="dyncontent" style="display:none;">
<div class="center"><img src="sensor__fusion_8c_a8b90119fee979d0309cc923bf1fad543_cgraph.png" border="0" usemap="#sensor__fusion_8c_a8b90119fee979d0309cc923bf1fad543_cgraph" alt=""/></div>
<map name="sensor__fusion_8c_a8b90119fee979d0309cc923bf1fad543_cgraph" id="sensor__fusion_8c_a8b90119fee979d0309cc923bf1fad543_cgraph">
<area shape="rect" id="node2" href="fusion_8c.html#aeb60375528d75ee9fec67a96916141ca" title="fFuseSensors" alt="" coords="132,715,235,741"/>
<area shape="rect" id="node43" href="sensor__fusion_8c.html#a9af8710b3e87acd2a33e7988b2d75b6c" title="Function to clear FIFO at the end of each fusion computation. " alt="" coords="140,765,227,792"/>
<area shape="rect" id="node3" href="driver__systick_8c.html#a63b11c5b24615bf03103d7d9e923ba2f" title="ARM_systick_start_ticks" alt="" coords="287,496,455,523"/>
<area shape="rect" id="node4" href="fusion_8c.html#a2e2258d4d0cd14011d5b198b8cbdab95" title="fRun_1DOF_P_BASIC" alt="" coords="295,547,446,573"/>
<area shape="rect" id="node6" href="driver__systick_8c.html#a11d2757f060c3c65c1dfe1f7a314bbb3" title="ARM_systick_elapsed\l_ticks" alt="" coords="295,598,447,639"/>
<area shape="rect" id="node7" href="fusion_8c.html#a7b5db1923cfa0dc160016e7d9b45b1c2" title="fRun_3DOF_G_BASIC" alt="" coords="295,664,447,691"/>
<area shape="rect" id="node21" href="fusion_8c.html#a2df5be5795338038774a64b41cf53a8e" title="fRun_3DOF_B_BASIC" alt="" coords="295,715,446,741"/>
<area shape="rect" id="node26" href="fusion_8c.html#a288f51cd39aeb8ace643d844e219e9d3" title="fRun_3DOF_Y_BASIC" alt="" coords="295,971,446,997"/>
<area shape="rect" id="node29" href="fusion_8c.html#a34c550860d0e4e42bf22a2a3527043b9" title="fRun_6DOF_GB_BASIC" alt="" coords="290,1113,451,1140"/>
<area shape="rect" id="node34" href="fusion_8c.html#a942d619f897d6820d5c148bdc910f962" title="fRun_6DOF_GY_KALMAN" alt="" coords="283,1573,459,1600"/>
<area shape="rect" id="node40" href="fusion_8h.html#a2288989efddb6c41fd593b2f75b7a844" title="fRun_9DOF_GBY_KALMAN" alt="" coords="527,2232,713,2259"/>
<area shape="rect" id="node5" href="fusion_8c.html#aa42722127b9e91519749cba1cfa07ebe" title="fInit_1DOF_P_BASIC" alt="" coords="547,5,693,32"/>
<area shape="rect" id="node8" href="fusion_8c.html#a41f2c6419c8e0c019e08618283338d21" title="fInit_3DOF_G_BASIC" alt="" coords="547,157,693,184"/>
<area shape="rect" id="node9" href="orientation_8h.html#addec350696b9ab89918808b56292bd9a" title="Aerospace NED accelerometer 3DOF tilt function, computing rotation matrix fR. " alt="" coords="843,107,946,133"/>
<area shape="rect" id="node10" href="orientation_8h.html#a480280c72c7243e5c192cab628e0a38d" title="Android accelerometer 3DOF tilt function computing, rotation matrix fR. " alt="" coords="835,157,955,184"/>
<area shape="rect" id="node11" href="orientation_8h.html#a292e27a8f966749f38e5e7936b05e29b" title="Windows 8 accelerometer 3DOF tilt function computing, rotation matrix fR. " alt="" coords="841,208,948,235"/>
<area shape="rect" id="node12" href="orientation_8c.html#a04da5468213c1687c5b3485f15af288e" title="compute the orientation quaternion from a 3x3 rotation matrix " alt="" coords="793,639,996,665"/>
<area shape="rect" id="node14" href="orientation_8c.html#ad60a32e44f24a4b8fa5bddfb23721bc8" title="function low pass filters an orientation quaternion and computes virtual gyro rotation rate ..." alt="" coords="533,715,707,741"/>
<area shape="rect" id="node15" href="orientation_8c.html#aa48ae334cf6bbedf2b9e7423d17cb4ac" title="computes rotation vector (deg) from rotation quaternion " alt="" coords="781,765,1008,792"/>
<area shape="rect" id="node17" href="orientation_8c.html#ab93a6fd700fd1557e9b8f6796bfe3035" title="compute the rotation matrix from an orientation quaternion " alt="" coords="519,883,721,909"/>
<area shape="rect" id="node18" href="orientation_8c.html#aa781ea4b9430531df4697d3cb39f7454" title="extract the NED angles in degrees from the NED rotation matrix " alt="" coords="523,934,717,975"/>
<area shape="rect" id="node19" href="orientation_8c.html#a77eeda9a699b1456bb8b02665ad80522" title="extract the Android angles in degrees from the Android rotation matrix " alt="" coords="515,1051,725,1093"/>
<area shape="rect" id="node20" href="orientation_8c.html#a13cd93780206a620abc7bdf7907e6dc6" title="extract the Windows 8 angles in degrees from the Windows 8 rotation matrix " alt="" coords="522,817,718,858"/>
<area shape="rect" id="node13" href="orientation_8c.html#a3bcc5aef9bd7abd545d33660aa3ccbd0" title="function normalizes a rotation quaternion and ensures q0 is non&#45;negative " alt="" coords="1116,967,1219,993"/>
<area shape="rect" id="node16" href="orientation_8c.html#a22a32becfcb162db012f41ff4f3bc942" title="function compute the quaternion product qA = qA * qB " alt="" coords="856,1117,933,1144"/>
<area shape="rect" id="node22" href="fusion_8c.html#adc49d74394c2a94a33ff65edea18233b" title="fInit_3DOF_B_BASIC" alt="" coords="547,411,693,437"/>
<area shape="rect" id="node23" href="orientation_8c.html#a3aea6b9a9647d15db0dad4be820fbba9" title="Aerospace NED magnetometer 3DOF flat eCompass function, computing rotation matrix fR..." alt="" coords="792,360,997,387"/>
<area shape="rect" id="node24" href="orientation_8c.html#a765e472022e2ba9717989e6527df49a8" title="Android magnetometer 3DOF flat eCompass function, computing rotation matrix fR. " alt="" coords="1056,411,1279,437"/>
<area shape="rect" id="node25" href="orientation_8c.html#a79e9bfb4c86c1cd82b83058afd08df10" title="Windows 8 magnetometer 3DOF flat eCompass function, computing rotation matrix fR. ..." alt="" coords="791,461,999,488"/>
<area shape="rect" id="node27" href="fusion_8c.html#a0d585ddb24fa91e8d18228bee7a9539c" title="fInit_3DOF_Y_BASIC" alt="" coords="547,1000,693,1027"/>
<area shape="rect" id="node28" href="orientation_8c.html#a9f946d534fae22e9e68b9f0e2e2822ef" title="computes normalized rotation quaternion from a rotation vector (deg) " alt="" coords="507,1269,733,1296"/>
<area shape="rect" id="node30" href="fusion_8c.html#ab5f459ab0c8c9b4123e2fb33f5061332" title="fInit_6DOF_GB_BASIC" alt="" coords="543,1624,697,1651"/>
<area shape="rect" id="node31" href="orientation_8c.html#afcde979fba0bcae15591096fe68648c9" title="NED: basic 6DOF e&#45;Compass function, computing rotation matrix fR and magnetic inclination angle fDelt..." alt="" coords="837,1599,952,1625"/>
<area shape="rect" id="node32" href="orientation_8c.html#a43ad72cf13f54b0f96355bb7005b6872" title="Android: basic 6DOF e&#45;Compass function, computing rotation matrix fR and magnetic inclination angle f..." alt="" coords="829,1700,960,1727"/>
<area shape="rect" id="node33" href="orientation_8c.html#aabc044b27a0cdd7db677c3203b77de90" title="Win8: basic 6DOF e&#45;Compass function, computing rotation matrix fR and magnetic inclination angle fDel..." alt="" coords="836,1776,953,1803"/>
<area shape="rect" id="node35" href="fusion_8c.html#adb837744c0801f50a0890f1385ca5c75" title="fInit_6DOF_GY_KALMAN" alt="" coords="535,208,705,235"/>
<area shape="rect" id="node36" href="orientation_8c.html#a4ced4d83316052e2c97ce2746abdc1e0" title="function computes the rotation quaternion that rotates unit vector u onto unit vector v as v=q*..." alt="" coords="572,1928,668,1955"/>
<area shape="rect" id="node37" href="matrix_8c.html#a64363bfcc2226e12d1bc28e7382591cc" title="function uses Gauss&#45;Jordan elimination to compute the inverse of matrix A in situ on exit..." alt="" coords="566,1979,674,2005"/>
<area shape="rect" id="node38" href="orientation_8c.html#a12448c36b93d8f3375ce000ef4527b4a" title="function compute the quaternion product qB * qC " alt="" coords="581,2029,659,2056"/>
<area shape="rect" id="node39" href="matrix_8c.html#ae53011a90e9f9b3bcd60085e94feaf32" title="function rotates 3x1 vector u onto 3x1 vector using 3x3 rotation matrix fR. the rotation is applied i..." alt="" coords="590,2080,650,2107"/>
<area shape="rect" id="node41" href="fusion_8c.html#a5627f82d4cbb9af1102d10ad1bea3699" title="fInit_9DOF_GBY_KALMAN" alt="" coords="531,1675,709,1701"/>
<area shape="rect" id="node42" href="matrix_8c.html#ae4f1812ac41a02374b5f6a40cb02a902" title="function sets 3x3 matrix A to 3x3 matrix B " alt="" coords="563,2131,677,2157"/>
</map>
</div>
</p>

<p><div id="dynsection-18" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-18-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-18-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-18-content" class="dyncontent" style="display:none;">
<div class="center"><img src="sensor__fusion_8c_a8b90119fee979d0309cc923bf1fad543_icgraph.png" border="0" usemap="#sensor__fusion_8c_a8b90119fee979d0309cc923bf1fad543_icgraph" alt=""/></div>
<map name="sensor__fusion_8c_a8b90119fee979d0309cc923bf1fad543_icgraph" id="sensor__fusion_8c_a8b90119fee979d0309cc923bf1fad543_icgraph">
<area shape="rect" id="node2" href="sensor__fusion_8h.html#a367d92b99365a8143700b76439915d65" title="utility function to insert default values in the top level structure " alt="" coords="132,5,295,32"/>
<area shape="rect" id="node3" href="main__agm01__freertos__two__tasks_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="This is a FreeRTOS (dual task) implementation of the NXP sensor fusion demo build. " alt="" coords="343,5,393,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a741fd2193cc58c09b692d1ae2b7a81e8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void setStatus </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSensorFusionGlobals.html">SensorFusionGlobals</a> *&#160;</td>
          <td class="paramname"><em>sfg</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype"><a class="el" href="sensor__fusion_8h.html#a69ee883e1c22b117df163c0bd83f66dd">fusion_status_t</a>&#160;</td>
          <td class="paramname"><em>status</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Poor man's inheritance for status subsystem setStatus command This function is normally involved via the "sfg." global pointer. </p>

<p>Definition at line <a class="el" href="sensor__fusion_8c_source.html#l00043">43</a> of file <a class="el" href="sensor__fusion_8c_source.html">sensor_fusion.c</a>.</p>

<p>Referenced by <a class="el" href="sensor__fusion_8c_source.html#l00068">initSensorFusionGlobals()</a>.</p>
<div class="fragment"><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;{</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a8f77cc84b021a9a1d91f6f049029d76d">pStatusSubsystem</a>-&gt;<a class="code" href="structStatusSubsystem.html#a354e24b13a239c13adac160f8abcef68">set</a>(sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a8f77cc84b021a9a1d91f6f049029d76d">pStatusSubsystem</a>, status);</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;}</div><div class="ttc" id="structSensorFusionGlobals_html_a8f77cc84b021a9a1d91f6f049029d76d"><div class="ttname"><a href="structSensorFusionGlobals.html#a8f77cc84b021a9a1d91f6f049029d76d">SensorFusionGlobals::pStatusSubsystem</a></div><div class="ttdeci">struct StatusSubsystem * pStatusSubsystem</div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00476">sensor_fusion.h:476</a></div></div>
<div class="ttc" id="structStatusSubsystem_html_a354e24b13a239c13adac160f8abcef68"><div class="ttname"><a href="structStatusSubsystem.html#a354e24b13a239c13adac160f8abcef68">StatusSubsystem::set</a></div><div class="ttdeci">ssSetStatus_t * set</div><div class="ttdoc">change status immediately - no delay </div><div class="ttdef"><b>Definition:</b> <a href="status_8h_source.html#l00050">status.h:50</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-19" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-19-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-19-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-19-content" class="dyncontent" style="display:none;">
<div class="center"><img src="sensor__fusion_8c_a741fd2193cc58c09b692d1ae2b7a81e8_icgraph.png" border="0" usemap="#sensor__fusion_8c_a741fd2193cc58c09b692d1ae2b7a81e8_icgraph" alt=""/></div>
<map name="sensor__fusion_8c_a741fd2193cc58c09b692d1ae2b7a81e8_icgraph" id="sensor__fusion_8c_a741fd2193cc58c09b692d1ae2b7a81e8_icgraph">
<area shape="rect" id="node2" href="sensor__fusion_8h.html#a367d92b99365a8143700b76439915d65" title="utility function to insert default values in the top level structure " alt="" coords="132,5,295,32"/>
<area shape="rect" id="node3" href="main__agm01__freertos__two__tasks_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="This is a FreeRTOS (dual task) implementation of the NXP sensor fusion demo build. " alt="" coords="343,5,393,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="a142a0a30c123f8acf79a3e8e5072cad8"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void testStatus </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSensorFusionGlobals.html">SensorFusionGlobals</a> *&#160;</td>
          <td class="paramname"><em>sfg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Definition at line <a class="el" href="sensor__fusion_8c_source.html#l00062">62</a> of file <a class="el" href="sensor__fusion_8c_source.html">sensor_fusion.c</a>.</p>

<p>Referenced by <a class="el" href="sensor__fusion_8c_source.html#l00068">initSensorFusionGlobals()</a>.</p>
<div class="fragment"><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;{</div><div class="line"><a name="l00064"></a><span class="lineno">   64</span>&#160;    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a8f77cc84b021a9a1d91f6f049029d76d">pStatusSubsystem</a>-&gt;<a class="code" href="structStatusSubsystem.html#a611d0be652d0e27ffe49e00e8f5b7db3">test</a>(sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a8f77cc84b021a9a1d91f6f049029d76d">pStatusSubsystem</a>);</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;}</div><div class="ttc" id="structStatusSubsystem_html_a611d0be652d0e27ffe49e00e8f5b7db3"><div class="ttname"><a href="structStatusSubsystem.html#a611d0be652d0e27ffe49e00e8f5b7db3">StatusSubsystem::test</a></div><div class="ttdeci">ssUpdateStatus_t * test</div><div class="ttdoc">unit test which simply increments to next state </div><div class="ttdef"><b>Definition:</b> <a href="status_8h_source.html#l00053">status.h:53</a></div></div>
<div class="ttc" id="structSensorFusionGlobals_html_a8f77cc84b021a9a1d91f6f049029d76d"><div class="ttname"><a href="structSensorFusionGlobals.html#a8f77cc84b021a9a1d91f6f049029d76d">SensorFusionGlobals::pStatusSubsystem</a></div><div class="ttdeci">struct StatusSubsystem * pStatusSubsystem</div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00476">sensor_fusion.h:476</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-20" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-20-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-20-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-20-content" class="dyncontent" style="display:none;">
<div class="center"><img src="sensor__fusion_8c_a142a0a30c123f8acf79a3e8e5072cad8_icgraph.png" border="0" usemap="#sensor__fusion_8c_a142a0a30c123f8acf79a3e8e5072cad8_icgraph" alt=""/></div>
<map name="sensor__fusion_8c_a142a0a30c123f8acf79a3e8e5072cad8_icgraph" id="sensor__fusion_8c_a142a0a30c123f8acf79a3e8e5072cad8_icgraph">
<area shape="rect" id="node2" href="sensor__fusion_8h.html#a367d92b99365a8143700b76439915d65" title="utility function to insert default values in the top level structure " alt="" coords="136,5,299,32"/>
<area shape="rect" id="node3" href="main__agm01__freertos__two__tasks_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="This is a FreeRTOS (dual task) implementation of the NXP sensor fusion demo build. " alt="" coords="347,5,397,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="aa13c4a9f07f3a2abfdb2e0808e5752d4"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void updateStatus </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structSensorFusionGlobals.html">SensorFusionGlobals</a> *&#160;</td>
          <td class="paramname"><em>sfg</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Poor man's inheritance for status subsystem updateStatus command. This function is normally involved via the "sfg." global pointer. </p>

<p>Definition at line <a class="el" href="sensor__fusion_8c_source.html#l00057">57</a> of file <a class="el" href="sensor__fusion_8c_source.html">sensor_fusion.c</a>.</p>

<p>Referenced by <a class="el" href="sensor__fusion_8c_source.html#l00068">initSensorFusionGlobals()</a>.</p>
<div class="fragment"><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;{</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;    sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a8f77cc84b021a9a1d91f6f049029d76d">pStatusSubsystem</a>-&gt;<a class="code" href="structStatusSubsystem.html#a928558f2d3d07e91b583fa7e67368b59">update</a>(sfg-&gt;<a class="code" href="structSensorFusionGlobals.html#a8f77cc84b021a9a1d91f6f049029d76d">pStatusSubsystem</a>);</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;}</div><div class="ttc" id="structSensorFusionGlobals_html_a8f77cc84b021a9a1d91f6f049029d76d"><div class="ttname"><a href="structSensorFusionGlobals.html#a8f77cc84b021a9a1d91f6f049029d76d">SensorFusionGlobals::pStatusSubsystem</a></div><div class="ttdeci">struct StatusSubsystem * pStatusSubsystem</div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00476">sensor_fusion.h:476</a></div></div>
<div class="ttc" id="structStatusSubsystem_html_a928558f2d3d07e91b583fa7e67368b59"><div class="ttname"><a href="structStatusSubsystem.html#a928558f2d3d07e91b583fa7e67368b59">StatusSubsystem::update</a></div><div class="ttdeci">ssUpdateStatus_t * update</div><div class="ttdoc">make pending status active/visible </div><div class="ttdef"><b>Definition:</b> <a href="status_8h_source.html#l00052">status.h:52</a></div></div>
</div><!-- fragment -->
<p><div id="dynsection-21" onclick="return toggleVisibility(this)" class="dynheader closed" style="cursor:pointer;">
  <img id="dynsection-21-trigger" src="closed.png" alt="+"/> Here is the caller graph for this function:</div>
<div id="dynsection-21-summary" class="dynsummary" style="display:block;">
</div>
<div id="dynsection-21-content" class="dyncontent" style="display:none;">
<div class="center"><img src="sensor__fusion_8c_aa13c4a9f07f3a2abfdb2e0808e5752d4_icgraph.png" border="0" usemap="#sensor__fusion_8c_aa13c4a9f07f3a2abfdb2e0808e5752d4_icgraph" alt=""/></div>
<map name="sensor__fusion_8c_aa13c4a9f07f3a2abfdb2e0808e5752d4_icgraph" id="sensor__fusion_8c_aa13c4a9f07f3a2abfdb2e0808e5752d4_icgraph">
<area shape="rect" id="node2" href="sensor__fusion_8h.html#a367d92b99365a8143700b76439915d65" title="utility function to insert default values in the top level structure " alt="" coords="152,5,315,32"/>
<area shape="rect" id="node3" href="main__agm01__freertos__two__tasks_8c.html#a840291bc02cba5474a4cb46a9b9566fe" title="This is a FreeRTOS (dual task) implementation of the NXP sensor fusion demo build. " alt="" coords="363,5,413,32"/>
</map>
</div>
</p>

</div>
</div>
<a class="anchor" id="ac57932c39d665755aeee1e62fac763e3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">void zeroArray </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structStatusSubsystem.html">StatusSubsystem</a> *&#160;</td>
          <td class="paramname"><em>pStatus</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">void *&#160;</td>
          <td class="paramname"><em>data</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>size</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint16_t&#160;</td>
          <td class="paramname"><em>numElements</em>, </td>
        </tr>
        <tr>
          <td class="paramkey"></td>
          <td></td>
          <td class="paramtype">uint8_t&#160;</td>
          <td class="paramname"><em>check</em>&#160;</td>
        </tr>
        <tr>
          <td></td>
          <td>)</td>
          <td></td><td></td>
        </tr>
      </table>
</div><div class="memdoc">
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramname">pStatus</td><td>Status subsystem pointer </td></tr>
    <tr><td class="paramname">data</td><td>pointer to array to be zeroed </td></tr>
    <tr><td class="paramname">size</td><td>data type size = 8, 16 or 32 </td></tr>
    <tr><td class="paramname">numElements</td><td>number of elements to zero out </td></tr>
    <tr><td class="paramname">check</td><td>true if you would like to verify writes, false otherwise </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="sensor__fusion_8c_source.html#l00320">320</a> of file <a class="el" href="sensor__fusion_8c_source.html">sensor_fusion.c</a>.</p>
<div class="fragment"><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                                                                                                         {</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;  uint16_t i;</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;  uint8_t *d8;</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;  uint16_t *d16;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;  uint32_t *d32;</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;  <span class="keywordflow">switch</span>(size) {</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;  <span class="keywordflow">case</span> 8:</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;    d8 = data;</div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;numElements; i++) d8[i]=0;</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;  <span class="keywordflow">case</span> 16:</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    d16 = data;</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;numElements; i++) d16[i]=0;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;  <span class="keywordflow">case</span> 32:</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;    d32 = data;</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;    <span class="keywordflow">for</span> (i=0; i&lt;numElements; i++) d32[i]=0;</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;    <span class="keywordflow">break</span>;</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;  <span class="keywordflow">default</span>:</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;    pStatus-&gt;<a class="code" href="structStatusSubsystem.html#a354e24b13a239c13adac160f8abcef68">set</a>(pStatus, <a class="code" href="sensor__fusion_8h.html#a69ee883e1c22b117df163c0bd83f66dda2142c7e506bbaf9dba4175fee014862f">HARD_FAULT</a>);</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;  }</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;  <span class="keywordflow">if</span> (check) {</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;    <span class="keywordflow">switch</span>(size) {</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;    <span class="keywordflow">case</span> 8:</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;      d8 = data;</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;      <span class="keywordflow">for</span> (i=0; i&lt;numElements; i++)</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        <span class="keywordflow">if</span> (d8[i]!=0) pStatus-&gt;<a class="code" href="structStatusSubsystem.html#a354e24b13a239c13adac160f8abcef68">set</a>(pStatus, <a class="code" href="sensor__fusion_8h.html#a69ee883e1c22b117df163c0bd83f66dda2142c7e506bbaf9dba4175fee014862f">HARD_FAULT</a>);</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;    <span class="keywordflow">case</span> 16:</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      d16 = data;</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;      <span class="keywordflow">for</span> (i=0; i&lt;numElements; i++)</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;        <span class="keywordflow">if</span> (d16[i]!=0) pStatus-&gt;<a class="code" href="structStatusSubsystem.html#a354e24b13a239c13adac160f8abcef68">set</a>(pStatus, <a class="code" href="sensor__fusion_8h.html#a69ee883e1c22b117df163c0bd83f66dda2142c7e506bbaf9dba4175fee014862f">HARD_FAULT</a>);</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    <span class="keywordflow">case</span> 32:</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;      d32 = data;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;      <span class="keywordflow">for</span> (i=0; i&lt;numElements; i++)</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;        <span class="keywordflow">if</span> (d32[i]!=0) pStatus-&gt;<a class="code" href="structStatusSubsystem.html#a354e24b13a239c13adac160f8abcef68">set</a>(pStatus, <a class="code" href="sensor__fusion_8h.html#a69ee883e1c22b117df163c0bd83f66dda2142c7e506bbaf9dba4175fee014862f">HARD_FAULT</a>);</div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;    }</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;  }</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;}</div><div class="ttc" id="sensor__fusion_8h_html_a69ee883e1c22b117df163c0bd83f66dda2142c7e506bbaf9dba4175fee014862f"><div class="ttname"><a href="sensor__fusion_8h.html#a69ee883e1c22b117df163c0bd83f66dda2142c7e506bbaf9dba4175fee014862f">HARD_FAULT</a></div><div class="ttdoc">Non-recoverable FAULT = something went very wrong. </div><div class="ttdef"><b>Definition:</b> <a href="sensor__fusion_8h_source.html#l00127">sensor_fusion.h:127</a></div></div>
<div class="ttc" id="structStatusSubsystem_html_a354e24b13a239c13adac160f8abcef68"><div class="ttname"><a href="structStatusSubsystem.html#a354e24b13a239c13adac160f8abcef68">StatusSubsystem::set</a></div><div class="ttdeci">ssSetStatus_t * set</div><div class="ttdoc">change status immediately - no delay </div><div class="ttdef"><b>Definition:</b> <a href="status_8h_source.html#l00050">status.h:50</a></div></div>
</div><!-- fragment -->
</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- HTML footer for doxygen 1.8.5-->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul class="foot">
<!--    <li class="footer"> &copy; 2016 Freescale Semiconductor, Inc. All rights reserved. 
    </li> -->
	    <li class="footer"> &copy; 2016 NXP B.V. 
    </li>
  </ul>
</div>
</body>
</html>
