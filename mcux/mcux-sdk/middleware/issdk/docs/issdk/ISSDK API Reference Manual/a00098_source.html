<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.13"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>ISSDK: sensors/host_io_uart.c Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="issdk_stylesheet.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="nxp_logo_small.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">ISSDK
   &#160;<span id="projectnumber">1.8</span>
   </div>
   <div id="projectbrief">IoT Sensing Software Development Kit</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.13 -->
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',false,false,'search.php','Search');
});
</script>
<div id="main-nav"></div>
<div id="nav-path" class="navpath">
  <ul>
<li class="navelem"><a class="el" href="dir_c77a8e2546a9c75bbba96be2ef542c8e.html">sensors</a></li>  </ul>
</div>
</div><!-- top -->
<div class="header">
  <div class="headertitle">
<div class="title">host_io_uart.c</div>  </div>
</div><!--header-->
<div class="contents">
<a href="a00098.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> * Copyright (c) 2016, Freescale Semiconductor, Inc.</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> * Copyright 2016-2017 NXP</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> * All rights reserved.</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> * SPDX-License-Identifier: BSD-3-Clause</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"></span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment">/**</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> * @file host_io_uart.c</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> * @brief The host_io_uart.c file contains definitions for UART based streaming interface</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> * for sending and reseiving messages to and from Host using ISSDK Host Protocol.</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;</div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment">/*******************************************************************************</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> * Standard C Includes</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment"> ******************************************************************************/</span></div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;<span class="preprocessor">#include &lt;stdlib.h&gt;</span></div><div class="line"><a name="l00019"></a><span class="lineno">   19</span>&#160;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;<span class="comment">/*******************************************************************************</span></div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="comment"> * SDK Includes</span></div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="comment"> ******************************************************************************/</span></div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="preprocessor">#include &quot;fsl_common.h&quot;</span></div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="comment">/*******************************************************************************</span></div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="comment"> * ISSDK Includes</span></div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="comment"> ******************************************************************************/</span></div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a00101.html">host_io_uart.h</a>&quot;</span></div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a00170.html">register_io_i2c.h</a>&quot;</span></div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a00176.html">register_io_spi.h</a>&quot;</span></div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a00512.html">data_format_hdlc.h</a>&quot;</span></div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="preprocessor">#include &quot;<a class="code" href="a00518.html">data_format_json.h</a>&quot;</span></div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="comment">/*******************************************************************************</span></div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="comment"> * Global Variables</span></div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="comment"> ******************************************************************************/</span></div><div class="line"><a name="l00037"></a><span class="lineno"><a class="line" href="a00098.html#a5d3ae17c131354598c173e13c349e81b">   37</a></span>&#160;<a class="code" href="a03943.html">host_interface_handle_t</a> <a class="code" href="a00098.html#a5d3ae17c131354598c173e13c349e81b">gHostHandle</a> = {0};</div><div class="line"><a name="l00038"></a><span class="lineno"><a class="line" href="a00098.html#a286445357d1a40bad2dd064f0f653510">   38</a></span>&#160;uint8_t <a class="code" href="a00098.html#a286445357d1a40bad2dd064f0f653510">gUartRxBuff</a>, <a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a>[<a class="code" href="a00101.html#adb701b5640d108f34d7395a98547b724">HOST_RX_BUF_LEN</a>];</div><div class="line"><a name="l00039"></a><span class="lineno"><a class="line" href="a00098.html#abed4be42ee7c54dcc1132ab8897f06a6">   39</a></span>&#160;<a class="code" href="a02927.html">host_rx_packet_t</a> <a class="code" href="a00098.html#abed4be42ee7c54dcc1132ab8897f06a6">gHostRxPkt</a> = {.<a class="code" href="a02927.html#a7154405d775832040d46ee3336363378">pRxbuf</a> = <a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a>};</div><div class="line"><a name="l00040"></a><span class="lineno"><a class="line" href="a00098.html#a8c0bca493307d9132485c8a4e71fd03e">   40</a></span>&#160;<a class="code" href="a02923.html">host_channel_params_t</a> <a class="code" href="a00098.html#a8c0bca493307d9132485c8a4e71fd03e">gHostChannelParams</a>[<a class="code" href="a00101.html#ae7d102c35c708dd10f5dbe5e01685ce4">MAX_HOST_STREAMS</a>];</div><div class="line"><a name="l00041"></a><span class="lineno"><a class="line" href="a00098.html#aaa9965c3c746bcf8e7e9eda2117056ad">   41</a></span>&#160;<span class="keyword">volatile</span> <span class="keywordtype">bool</span> <a class="code" href="a00098.html#aaa9965c3c746bcf8e7e9eda2117056ad">bUartTxComplete</a>, <a class="code" href="a00098.html#aa86e36e002f9c35901d49a9a99f47aa4">bUartRxPendingMsg</a>, <a class="code" href="a00098.html#a0a02605045d9d7117b2c54ec8db7daeb">bUartErrorMsg</a>;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="comment">/*******************************************************************************</span></div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="comment"> * Functions</span></div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="comment"> ******************************************************************************/</span></div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;<span class="comment">/* Callback functions to handle incomming messages form the Host over UART. */</span></div><div class="line"><a name="l00047"></a><span class="lineno"><a class="line" href="a00101.html#a5f7481a79b18cfdeb27562acebca6ba0">   47</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="a00098.html#a5f7481a79b18cfdeb27562acebca6ba0">HOST_SignalEvent_t</a>(uint32_t event)</div><div class="line"><a name="l00048"></a><span class="lineno">   48</span>&#160;{</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;    <span class="keywordflow">switch</span> (event)</div><div class="line"><a name="l00050"></a><span class="lineno">   50</span>&#160;    {</div><div class="line"><a name="l00051"></a><span class="lineno">   51</span>&#160;        <span class="keywordflow">case</span> ARM_USART_EVENT_RECEIVE_COMPLETE:</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;            <a class="code" href="a00098.html#aa86e36e002f9c35901d49a9a99f47aa4">bUartRxPendingMsg</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00054"></a><span class="lineno">   54</span>&#160;        <span class="keywordflow">case</span> ARM_USART_EVENT_SEND_COMPLETE:</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;            <a class="code" href="a00098.html#aaa9965c3c746bcf8e7e9eda2117056ad">bUartTxComplete</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00056"></a><span class="lineno">   56</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00057"></a><span class="lineno">   57</span>&#160;        <span class="keywordflow">default</span>:</div><div class="line"><a name="l00058"></a><span class="lineno">   58</span>&#160;            <a class="code" href="a00098.html#a0a02605045d9d7117b2c54ec8db7daeb">bUartErrorMsg</a> = <span class="keyword">true</span>;</div><div class="line"><a name="l00059"></a><span class="lineno">   59</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00060"></a><span class="lineno">   60</span>&#160;    }</div><div class="line"><a name="l00061"></a><span class="lineno">   61</span>&#160;}</div><div class="line"><a name="l00062"></a><span class="lineno">   62</span>&#160;</div><div class="line"><a name="l00063"></a><span class="lineno">   63</span>&#160;<span class="comment">/* Function to lookup slave handle. */</span></div><div class="line"><a name="l00064"></a><span class="lineno"><a class="line" href="a00098.html#a1b00cf0487d683b14751aeadbd18fa77">   64</a></span>&#160;uint8_t <a class="code" href="a00098.html#a1b00cf0487d683b14751aeadbd18fa77">getSlaveIndex</a>(uint8_t slaveAddress)</div><div class="line"><a name="l00065"></a><span class="lineno">   65</span>&#160;{</div><div class="line"><a name="l00066"></a><span class="lineno">   66</span>&#160;    <span class="keywordflow">for</span> (uint8_t stream = 0; stream &lt; <a class="code" href="a00101.html#ae7d102c35c708dd10f5dbe5e01685ce4">MAX_HOST_STREAMS</a>; stream++)</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    {</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;        <span class="keywordflow">if</span> (gHostChannelParams[stream].slaveAddress == slaveAddress)</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;        {</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;            <span class="keywordflow">return</span> stream;</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        }</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;    }</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;    <span class="comment">/* If Address in not recognised, default to the first stream. */</span></div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;    <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;}</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;<span class="comment">/* Function to populate Streaming Packet Header.</span></div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;<span class="comment"> * Outgoing  Iso Packet Format: (As per ISSDK Host Protocol Definition)</span></div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;<span class="comment"> * Byte 0 : (Start Byte) HDLC Frame START MARKER. (Will be added by HDLC_Process_Tx_Msg())</span></div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;<span class="comment"> * Byte 1 : Frame TAG (Interface)</span></div><div class="line"><a name="l00082"></a><span class="lineno">   82</span>&#160;<span class="comment"> * Byte 2 : Length    (Payload Length)</span></div><div class="line"><a name="l00083"></a><span class="lineno">   83</span>&#160;<span class="comment"> * Byte 3+: Payload   (Depending upon sensor sample length + 1 for Stream ID)</span></div><div class="line"><a name="l00084"></a><span class="lineno">   84</span>&#160;<span class="comment"> * Byte E : (End Byte) HDLC Frame STOP MARKER. (Will be added by HDLC_Process_Tx_Msg())</span></div><div class="line"><a name="l00085"></a><span class="lineno">   85</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00086"></a><span class="lineno"><a class="line" href="a00101.html#a68a2c033a0f6f967149dca76897f5c8a">   86</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="a00098.html#a68a2c033a0f6f967149dca76897f5c8a">Host_IO_Add_ISO_Header</a>(uint8_t streamID, uint8_t *pStreamingPacket, <span class="keywordtype">size_t</span> sizePayload)</div><div class="line"><a name="l00087"></a><span class="lineno">   87</span>&#160;{</div><div class="line"><a name="l00088"></a><span class="lineno">   88</span>&#160;    <span class="keywordflow">if</span> (pStreamingPacket == NULL)</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    {</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    }</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    pStreamingPacket[<a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02a869f718992b3a1413d42fe96294fdcb7">HOST_MSG_HDR_TAG_OFFSET</a>] = <a class="code" href="a00101.html#ab21d1c8714400342fc64db60dcf6e05f">HOST_PRO_INT_ISO_TAG</a>;</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;    pStreamingPacket[<a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02aae167b647c99bc31a7fb7f8c94aca12f">HOST_ISO_LEN_MSB_OFFSET</a>] = (sizePayload + 1) &gt;&gt; 8;     <span class="comment">/* Size of Sample + Stream ID */</span></div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;    pStreamingPacket[<a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02a7d25131112210b00c80642bef852d4f4">HOST_ISO_LEN_LSB_OFFSET</a>] = (sizePayload + 1) &amp; 0x00FF; <span class="comment">/* Size of Sample + Stream ID */</span></div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    pStreamingPacket[<a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02a82bb9264bd2257ba906bd8f051ff72d3">HOST_ISO_PAYLOAD_OFFSET</a>] = streamID;</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;}</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;<span class="comment">/* Function to get Stream ID, set Encoding and configure RLI related parameters. */</span></div><div class="line"><a name="l00100"></a><span class="lineno"><a class="line" href="a00101.html#ab4b858422bbaae71aff2ab540ae0e2b1">  100</a></span>&#160;uint8_t <a class="code" href="a00098.html#ab4b858422bbaae71aff2ab540ae0e2b1">Host_IO_Init</a>(ARM_DRIVER_USART *pDrv, <span class="keywordtype">void</span> *pBus, <span class="keywordtype">void</span> *pDevInfo, <span class="keywordtype">void</span> *spiSlaveParams, uint16_t slaveAddress)</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;{</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;    <span class="keyword">static</span> uint8_t streamID = 0;</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    <span class="comment">/* Configure the UART callback if not already configured. */</span></div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;    <span class="keywordflow">if</span> (gHostHandle.<a class="code" href="a03943.html#aa1a7122e5b01453391a9ab53f13efcff">pCommInterface</a> == NULL)</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;    {</div><div class="line"><a name="l00107"></a><span class="lineno">  107</span>&#160;        <a class="code" href="a00524.html#aaa19dab07f472f4f64938a4902ef6eed">HOST_Initialize</a>(&amp;gHostHandle, <a class="code" href="a00506.html#a3ec76cbd0350991085b430f1a9e2f6acaaf4b9442ca66d2f23c46a10dec1f5f11">COMM_UART</a>, (<span class="keywordtype">void</span> *)pDrv, <a class="code" href="a00506.html#a6e3bbe66379f732578e50af28a7f3981a733e810a23aa669c73a88d1bb4938f86">COMM_NONBLOCKING</a>, <a class="code" href="a00098.html#a5f7481a79b18cfdeb27562acebca6ba0">HOST_SignalEvent_t</a>, NULL);</div><div class="line"><a name="l00108"></a><span class="lineno">  108</span>&#160;        <span class="keywordflow">do</span> <span class="comment">/* Flush RX buffer. */</span></div><div class="line"><a name="l00109"></a><span class="lineno">  109</span>&#160;        {</div><div class="line"><a name="l00110"></a><span class="lineno">  110</span>&#160;            <a class="code" href="a00098.html#aa86e36e002f9c35901d49a9a99f47aa4">bUartRxPendingMsg</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00111"></a><span class="lineno">  111</span>&#160;            <a class="code" href="a00524.html#aeb19f7f23fe9119b1a678cf7434a91dc">HOST_Receive</a>(&amp;gHostHandle, &amp;<a class="code" href="a00098.html#a286445357d1a40bad2dd064f0f653510">gUartRxBuff</a>, NULL, 1, NULL);</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;        } <span class="keywordflow">while</span> (<a class="code" href="a00098.html#aa86e36e002f9c35901d49a9a99f47aa4">bUartRxPendingMsg</a>);</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;        <a class="code" href="a00098.html#aaa9965c3c746bcf8e7e9eda2117056ad">bUartTxComplete</a> = <span class="keyword">true</span>; <span class="comment">/* Reset TX Flag. */</span></div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;        <a class="code" href="a00098.html#a0a02605045d9d7117b2c54ec8db7daeb">bUartErrorMsg</a> = <span class="keyword">false</span>;  <span class="comment">/* Reset Error Flag. */</span></div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    }</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="comment">/* Host has to be accesible by 1 UART interface for all subscriptions</span></div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;<span class="comment">     * and Number of streams less than MAX. */</span></div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;    <span class="keywordflow">if</span> (gHostHandle.<a class="code" href="a03943.html#ac0f97a5935c8c1d55a949c43b44c2bec">commHandle</a>.<a class="code" href="a03927.html#a59f965a3233585fdd10c975bd4458948">pComm</a> != pDrv || streamID == <a class="code" href="a00101.html#ae7d102c35c708dd10f5dbe5e01685ce4">MAX_HOST_STREAMS</a>)</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    {</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;    }</div><div class="line"><a name="l00123"></a><span class="lineno">  123</span>&#160;</div><div class="line"><a name="l00124"></a><span class="lineno">  124</span>&#160;    <span class="comment">/* Save the I2C/SPI Bus handle. */</span></div><div class="line"><a name="l00125"></a><span class="lineno">  125</span>&#160;    gHostChannelParams[streamID].<a class="code" href="a02923.html#ab2a215cc9313cc96f710af5470f89964">pCommDrv</a> = pBus;</div><div class="line"><a name="l00126"></a><span class="lineno">  126</span>&#160;    gHostChannelParams[streamID].<a class="code" href="a02923.html#aef2a754643e613a67e01f82b7340dca0">deviceInfo</a> = pDevInfo;</div><div class="line"><a name="l00127"></a><span class="lineno">  127</span>&#160;    gHostChannelParams[streamID].<a class="code" href="a02923.html#a67af74c3fc959654c6dc8bcff3a2ea80">slaveAddress</a> = slaveAddress;</div><div class="line"><a name="l00128"></a><span class="lineno">  128</span>&#160;</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    <span class="comment">/* If device type is I2C, Slave Handle will be NULL. */</span></div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    gHostChannelParams[streamID].<a class="code" href="a02923.html#aaaf594566c8ab249734b58bc29dfb193">pSPIparams</a> = spiSlaveParams;</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    <span class="keywordflow">return</span> ++streamID;</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;}</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;<span class="comment">/* Function to send bytes to Host over UART. */</span></div><div class="line"><a name="l00136"></a><span class="lineno"><a class="line" href="a00101.html#a719ad6da4502e713f1573b5353af9617">  136</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="a00098.html#a719ad6da4502e713f1573b5353af9617">Host_IO_Send</a>(uint8_t *pMsg, <span class="keywordtype">size_t</span> <a class="code" href="a00521.html#a18e09d6eabccd6dfc2d5066542020e59">size</a>, uint8_t encoding)</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;{</div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;    <span class="keywordtype">size_t</span> encodedSize = 0;</div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keyword">static</span> uint8_t *pMsgEncoded = NULL;</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    <span class="keywordflow">while</span> (<a class="code" href="a00098.html#aaa9965c3c746bcf8e7e9eda2117056ad">bUartTxComplete</a> == <span class="keyword">false</span>)</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    {</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;        __NOP(); <span class="comment">/* Wait if the previous Tx is still Pending. */</span></div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    }</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;    free(pMsgEncoded);</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00147"></a><span class="lineno">  147</span>&#160;    <span class="keywordflow">switch</span> (encoding)</div><div class="line"><a name="l00148"></a><span class="lineno">  148</span>&#160;    {</div><div class="line"><a name="l00149"></a><span class="lineno">  149</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="a00101.html#a15b8f0a0cc23d28aafa1b827c46a5305a7c754ec0cda1ed431ce52c2c4a6a63da">HOST_FORMAT_HDLC</a>:</div><div class="line"><a name="l00150"></a><span class="lineno">  150</span>&#160;            pMsgEncoded = malloc(size * 2); <span class="comment">/* Allocate 2x the size to compensate for escape characters. */</span></div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;            encodedSize = <a class="code" href="a00509.html#a1b0cdde224e0adf381d431058d2de34a">HDLC_Process_Tx_Msg</a>(pMsg, pMsgEncoded, size); <span class="comment">/* Get the Encoded Message. */</span></div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="a00101.html#a15b8f0a0cc23d28aafa1b827c46a5305a7ed4651d866a686a5c463e985df09f08">HOST_FORMAT_JSON</a>:</div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;            pMsgEncoded = malloc(size * 4); <span class="comment">/* Allocate 4x the size to compensate for string character encoding. */</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;            encodedSize = <a class="code" href="a00515.html#abab3c54ca70a6f8384cd4aab3e475c19">JSON_Process_Tx_Msg</a>(pMsg, pMsgEncoded, size); <span class="comment">/* Get the Encoded Message. */</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;        <span class="keywordflow">case</span> <a class="code" href="a00101.html#a15b8f0a0cc23d28aafa1b827c46a5305a7920b2c6c711fc957a804d5f66dee301">HOST_FORMAT_PLAIN</a>:</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;        <span class="keywordflow">default</span>:</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;            pMsgEncoded = malloc(size);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;            memcpy(pMsgEncoded, pMsg, size);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;            encodedSize = <a class="code" href="a00521.html#a18e09d6eabccd6dfc2d5066542020e59">size</a>;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;            <span class="keywordflow">break</span>;</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;    }</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;    <span class="comment">/* Send message to Host. */</span></div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    <a class="code" href="a00098.html#aaa9965c3c746bcf8e7e9eda2117056ad">bUartTxComplete</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <a class="code" href="a00524.html#ad708231312ecd814cb70c710fcdea37d">HOST_Send</a>(&amp;gHostHandle, pMsgEncoded, encodedSize);</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;}</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;<span class="comment">/*  Function to check Rx and process received bytes and (re)enable UART Rx.</span></div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;<span class="comment"> *  Command Types Supported :</span></div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;<span class="comment"> *  1) Write App Data - Start/Stop Streaming.</span></div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;<span class="comment"> *  2) Write Register Data - Register Address and Value.</span></div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;<span class="comment"> *  3) Read Register Data - Start Address and Number of Bytes.</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;<span class="comment"> *  4) Read Device Info - Return Major/Minor + Board and Shield Names.</span></div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;<span class="comment"> * Incoming Message Format (Host Commands): (As per ISSDK Host Protocol Definition)</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;<span class="comment"> * Byte 0 : Frame TAG   (Interface|Command)</span></div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;<span class="comment"> * Byte 1 : Sequence ID (Random Txn Identifier)</span></div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;<span class="comment"> * Byte 2 : Length MSB  (Payload Length MSB)</span></div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;<span class="comment"> * Byte 3 : Length LSB  (Payload Length LSB)</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;<span class="comment"> * Byte 4+: Payload</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;<span class="comment"> * Outgoing Respone Format (Host Commands): (As per ISSDK Host Protocol Definition)</span></div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;<span class="comment"> * Byte 0 : Frame TAG   (Status|Interface|Command)</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;<span class="comment"> * Byte 1 : Sequence ID (Random Txn Identifier)</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;<span class="comment"> * Byte 2 : Length MSB  (Payload Length MSB)</span></div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;<span class="comment"> * Byte 3 : Length LSB  (Payload Length LSB)</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;<span class="comment"> * Byte 4+: Payload (Optional, depending upon requested operation)</span></div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;<span class="comment"> * Incoming Message Format (ISO Command): (As per ISSDK Host Protocol Definition)</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;<span class="comment"> * Byte 0 : Frame TAG   (Interface)</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;<span class="comment"> * Byte 1 : Length MSB  (Payload Length MSB)</span></div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;<span class="comment"> * Byte 2 : Length LSB  (Payload Length LSB)</span></div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;<span class="comment"> * Byte 3+: Payload</span></div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;<span class="comment"> * Incoming Message Format (Device Info): (As per ISSDK Host Protocol Definition)</span></div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;<span class="comment"> * Byte 0 : Frame TAG   (Interface)</span></div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;<span class="comment"> * Outgoing Respone Format (Device Info): (As per ISSDK Host Protocol Definition)</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;<span class="comment"> * Byte 0 : Frame TAG   (Interface)</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;<span class="comment"> * Byte 1 : Version ID  (ISSDK : Major | Minor Numbers)</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;<span class="comment"> * Byte 2 : Length of Board Name (Optional : populated by user callback)</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;<span class="comment"> * Byte 3 : Length of Shield Name (Optional : populated by user callback)</span></div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;<span class="comment"> * Byte 4+: Payload (Board Name + Board Name) (Optional : populated by user callback)</span></div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;<span class="comment"> */</span></div><div class="line"><a name="l00207"></a><span class="lineno"><a class="line" href="a00101.html#a3924d21a0703878695ebdb68f720fff9">  207</a></span>&#160;<span class="keywordtype">void</span> <a class="code" href="a00098.html#a3924d21a0703878695ebdb68f720fff9">Host_IO_Receive</a>(<a class="code" href="a00101.html#a4b0be146f341173bd85affcec8c68f52">host_cmd_proc_fn_t</a> <a class="code" href="a00401.html#a0076d28c9a17cd6908c7b3b0f5c6006c">process_host_command</a>, uint8_t encoding)</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;{</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    uint8_t responseTag = <a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a>[<a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02a869f718992b3a1413d42fe96294fdcb7">HOST_MSG_HDR_TAG_OFFSET</a>] &amp; <a class="code" href="a00101.html#abfac3847cc565a419e29418d97c45af4">HOST_PRO_CMD_WR_NAK_TAG</a>;</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <a class="code" href="a03931.html">comm_control_t</a> rxAbort = {.<a class="code" href="a03931.html#af47d900be5b5e5b1cce48f959401cb4e">control</a> = ARM_USART_ABORT_RECEIVE, .arg = 0};</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="keywordtype">size_t</span> dataLength, responseSize = <a class="code" href="a00101.html#a651ffcb801a111da39997564bb77cf66">HOST_RSP_HDR_LEN</a>;</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordtype">bool</span> bCmdSuccess = <span class="keyword">false</span>, bMessageReceived = <span class="keyword">false</span>;</div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;    uint8_t *pMsgResponse = NULL;</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;    <span class="comment">/* If error flag is set ABORT and RESTART transaction. */</span></div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="a00098.html#a0a02605045d9d7117b2c54ec8db7daeb">bUartErrorMsg</a>)</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;    {</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        <a class="code" href="a00098.html#a0a02605045d9d7117b2c54ec8db7daeb">bUartErrorMsg</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <a class="code" href="a00098.html#aa86e36e002f9c35901d49a9a99f47aa4">bUartRxPendingMsg</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;        <a class="code" href="a00524.html#ae3e5d4f17870b1311c165af014a3e09f">HOST_Configure</a>(&amp;gHostHandle, &amp;rxAbort);</div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <a class="code" href="a00524.html#aeb19f7f23fe9119b1a678cf7434a91dc">HOST_Receive</a>(&amp;gHostHandle, &amp;<a class="code" href="a00098.html#a286445357d1a40bad2dd064f0f653510">gUartRxBuff</a>, NULL, 1, NULL);</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;    }</div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="a00098.html#aa86e36e002f9c35901d49a9a99f47aa4">bUartRxPendingMsg</a>)</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    {</div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;        <span class="keywordflow">switch</span> (encoding)</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;        {</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="a00101.html#a15b8f0a0cc23d28aafa1b827c46a5305a7c754ec0cda1ed431ce52c2c4a6a63da">HOST_FORMAT_HDLC</a>:</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;                bMessageReceived = <a class="code" href="a00509.html#af69cf775e44516f29d6ba5a93eacfbd8">HDLC_Process_Rx_Byte</a>(<a class="code" href="a00098.html#a286445357d1a40bad2dd064f0f653510">gUartRxBuff</a>, &amp;gHostRxPkt);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;            <span class="keywordflow">case</span> <a class="code" href="a00101.html#a15b8f0a0cc23d28aafa1b827c46a5305a7ed4651d866a686a5c463e985df09f08">HOST_FORMAT_JSON</a>:</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;                bMessageReceived = <a class="code" href="a00515.html#a82cfef5d07d5b3c2b1f8795309ab9e67">JSON_Process_Rx_Byte</a>(<a class="code" href="a00098.html#a286445357d1a40bad2dd064f0f653510">gUartRxBuff</a>, &amp;gHostRxPkt);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;            <span class="keywordflow">default</span>:</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;        }</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        <a class="code" href="a00098.html#a0a02605045d9d7117b2c54ec8db7daeb">bUartErrorMsg</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;        <a class="code" href="a00098.html#aa86e36e002f9c35901d49a9a99f47aa4">bUartRxPendingMsg</a> = <span class="keyword">false</span>;</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        <a class="code" href="a00524.html#aeb19f7f23fe9119b1a678cf7434a91dc">HOST_Receive</a>(&amp;gHostHandle, &amp;<a class="code" href="a00098.html#a286445357d1a40bad2dd064f0f653510">gUartRxBuff</a>, NULL, 1, NULL);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;    }</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    <span class="keywordflow">if</span> (bMessageReceived)</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    {</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;        <span class="keywordflow">do</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;        {</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;            dataLength = gHostRxPkt.<a class="code" href="a02927.html#a000f6e2acab93210fdd84fa0709c95ca">mIndex</a>;</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;            <span class="comment">/* Check if it is a 1-byte Device Info Message from Host. */</span></div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;            <span class="keywordflow">if</span> ((<a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a>[<a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02a869f718992b3a1413d42fe96294fdcb7">HOST_MSG_HDR_TAG_OFFSET</a>] &amp; <a class="code" href="a00101.html#a6a3695a33b82875d8285b40c8c417de1">HOST_PRO_INT_DEV_TAG</a>) &amp;&amp; (dataLength == 1))</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;            { <span class="comment">/* Allocate memory for response packet for this command and populate the payload. */</span></div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;                pMsgResponse = malloc(<a class="code" href="a00101.html#ad6633eaf1ea26ebdd208b31a73075f9b">HOST_DEV_RSP_LEN</a>);</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;                dataLength = 0; <span class="comment">/* Incoming Payload is Zero. */</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;                <span class="keywordflow">if</span> (process_host_command)</div><div class="line"><a name="l00254"></a><span class="lineno">  254</span>&#160;                { <span class="comment">/* Call the user callback to proces the user specific payload. */</span></div><div class="line"><a name="l00255"></a><span class="lineno">  255</span>&#160;                    bCmdSuccess = <a class="code" href="a00401.html#a0076d28c9a17cd6908c7b3b0f5c6006c">process_host_command</a>(<a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a>[<a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02a869f718992b3a1413d42fe96294fdcb7">HOST_MSG_HDR_TAG_OFFSET</a>], NULL,</div><div class="line"><a name="l00256"></a><span class="lineno">  256</span>&#160;                                                       pMsgResponse + <a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02add8f03bdf28a3e04774fa34081dc901e">HOST_DEV_LEN_STR_OFFSET</a>, &amp;dataLength,</div><div class="line"><a name="l00257"></a><span class="lineno">  257</span>&#160;                                                       <a class="code" href="a00101.html#ad6633eaf1ea26ebdd208b31a73075f9b">HOST_DEV_RSP_LEN</a> - <a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02add8f03bdf28a3e04774fa34081dc901e">HOST_DEV_LEN_STR_OFFSET</a>);</div><div class="line"><a name="l00258"></a><span class="lineno">  258</span>&#160;                }</div><div class="line"><a name="l00259"></a><span class="lineno">  259</span>&#160;                <span class="keywordflow">if</span> (bCmdSuccess == <span class="keyword">false</span>)</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                {</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;                    dataLength = 0;</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;                }</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;                responseTag = <a class="code" href="a00101.html#a6a3695a33b82875d8285b40c8c417de1">HOST_PRO_INT_DEV_TAG</a>;</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;                responseSize = <a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02add8f03bdf28a3e04774fa34081dc901e">HOST_DEV_LEN_STR_OFFSET</a> + dataLength;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;            }</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;            dataLength = (((uint16_t)<a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a>[<a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02aae167b647c99bc31a7fb7f8c94aca12f">HOST_ISO_LEN_MSB_OFFSET</a>] &lt;&lt; 8) | <a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a>[<a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02a7d25131112210b00c80642bef852d4f4">HOST_ISO_LEN_LSB_OFFSET</a>]);</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;            <span class="comment">/* Check if it is an ISO Message from Host and has &gt; 0 Byte payload. */</span></div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;            <span class="keywordflow">if</span> ((<a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a>[<a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02a869f718992b3a1413d42fe96294fdcb7">HOST_MSG_HDR_TAG_OFFSET</a>] &amp; <a class="code" href="a00101.html#ab21d1c8714400342fc64db60dcf6e05f">HOST_PRO_INT_ISO_TAG</a>) &amp;&amp; (dataLength &gt; 0))</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;            {</div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;                <span class="keywordflow">if</span> (dataLength == (gHostRxPkt.<a class="code" href="a02927.html#a000f6e2acab93210fdd84fa0709c95ca">mIndex</a> - <a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02a82bb9264bd2257ba906bd8f051ff72d3">HOST_ISO_PAYLOAD_OFFSET</a>) &amp;&amp; <a class="code" href="a00401.html#a0076d28c9a17cd6908c7b3b0f5c6006c">process_host_command</a>)</div><div class="line"><a name="l00273"></a><span class="lineno">  273</span>&#160;                { <span class="comment">/* Call the user callback to proces the user specific payload if packet integrity is valid. */</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;                    <a class="code" href="a00401.html#a0076d28c9a17cd6908c7b3b0f5c6006c">process_host_command</a>(<a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a>[<a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02a869f718992b3a1413d42fe96294fdcb7">HOST_MSG_HDR_TAG_OFFSET</a>], <a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a> + <a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02a82bb9264bd2257ba906bd8f051ff72d3">HOST_ISO_PAYLOAD_OFFSET</a>,</div><div class="line"><a name="l00275"></a><span class="lineno">  275</span>&#160;                                         NULL, <span class="comment">/* No buffer since no response for ISO Messages. */</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                                         &amp;dataLength, 0);</div><div class="line"><a name="l00277"></a><span class="lineno">  277</span>&#160;                }</div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                <span class="keywordflow">return</span>; <span class="comment">/* No response for ISO Messages. */</span></div><div class="line"><a name="l00279"></a><span class="lineno">  279</span>&#160;            }</div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno">  281</span>&#160;            dataLength = (((uint16_t)<a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a>[<a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02a0f735713456e47ca551cae3f581c9a7c">HOST_MSG_LEN_MSB_OFFSET</a>] &lt;&lt; 8) | <a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a>[<a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02aa7fc80700bf9fa14ef02fd298fb660e7">HOST_MSG_LEN_LSB_OFFSET</a>]);</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;            <span class="keywordflow">if</span> (dataLength != (gHostRxPkt.<a class="code" href="a02927.html#a000f6e2acab93210fdd84fa0709c95ca">mIndex</a> - <a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02ae5286100318272176fbc8b91843604ec">HOST_MSG_CMD_OPC_OFFSET</a>)) <span class="comment">/* Ensure packet integrity */</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;            {</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;                <span class="keywordflow">return</span>; <span class="comment">/* Drop corrupted and duplicate packets */</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;            }</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;            <span class="comment">/* Allocate memory for response packet for this command. */</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;            pMsgResponse = malloc(responseSize);</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;            <span class="comment">/* Check if it is a Command from Host to Write Register Data and has 3+ Byte payload (SlaveAddress,</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;<span class="comment">             * RegisterAddress and ValuesToWrite). */</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;            <span class="keywordflow">if</span> ((<a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a>[<a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02a869f718992b3a1413d42fe96294fdcb7">HOST_MSG_HDR_TAG_OFFSET</a>] == (<a class="code" href="a00101.html#a24c0ee2064102a8de73651950dd9fbcb">HOST_PRO_INT_CMD_TAG</a> | <a class="code" href="a00101.html#a071e5542770ff815dcc93a74fdad769a">HOST_PRO_CMD_W_REG_TAG</a>)) &amp;&amp;</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;                (dataLength &gt;= 3))</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;            {</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;                <a class="code" href="a00521.html#a5d7069350a7d7e65686c77a8038f462f">int32_t</a> <a class="code" href="a00359.html#a369536ebfe385731562c0b55dd6f3a7c">status</a> = ARM_DRIVER_ERROR;</div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                <span class="comment">/* Fetch the slave bus handle using known Slave Address. */</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                uint8_t deviceID = <a class="code" href="a00098.html#a1b00cf0487d683b14751aeadbd18fa77">getSlaveIndex</a>(<a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a>[<a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02a9cc0543af7e2bb1c2367f78c877afa19">HOST_MSG_CMD_SLAVE_ADDR_OFFSET</a>]);</div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                <span class="keywordflow">if</span> (process_host_command)</div><div class="line"><a name="l00298"></a><span class="lineno">  298</span>&#160;                { <span class="comment">/* Call the user callback to enable user pre-proces the register write payload (if required). */</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                    <a class="code" href="a00401.html#a0076d28c9a17cd6908c7b3b0f5c6006c">process_host_command</a>(<a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a>[<a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02a869f718992b3a1413d42fe96294fdcb7">HOST_MSG_HDR_TAG_OFFSET</a>],</div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                                         <a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a> + HOST_MSG_CMD_SLAVE_ADDR_OFFSET, NULL, &amp;dataLength, 0);</div><div class="line"><a name="l00301"></a><span class="lineno">  301</span>&#160;                }</div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                <span class="comment">/* Confirm payload has enough number of bytes to write. */</span></div><div class="line"><a name="l00303"></a><span class="lineno">  303</span>&#160;                <span class="keywordflow">if</span> (gHostChannelParams[deviceID].pCommDrv &amp;&amp;</div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                    gHostRxPkt.<a class="code" href="a02927.html#a000f6e2acab93210fdd84fa0709c95ca">mIndex</a> - HOST_MSG_CMD_SLAVE_ADDR_OFFSET &gt;= dataLength)</div><div class="line"><a name="l00305"></a><span class="lineno">  305</span>&#160;                {</div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                    <span class="keywordflow">if</span> (gHostChannelParams[deviceID].pSPIparams)</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;                    {</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                        status = <a class="code" href="a00173.html#a0662e3575811a227d02c1cfe802744c5">Register_SPI_BlockWrite</a>(</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;                            gHostChannelParams[deviceID].pCommDrv, gHostChannelParams[deviceID].deviceInfo,</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                            gHostChannelParams[deviceID].pSPIparams, <a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a>[<a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02a8414becebdadfaf00ee9cf5df5bfa887">HOST_MSG_CMD_REGIS_ADDR_OFFSET</a>],</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                            <a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a> + <a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02ad0f2fd8313dd065bc85bd295572ccf73">HOST_MSG_CMD_VALUE_OFFSET</a>, dataLength - 2);</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;                    }</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;                    {</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                        status = <a class="code" href="a00167.html#ac5a66aa1b8d95d267c9d68cb475c9e01">Register_I2C_BlockWrite</a>(</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;                            gHostChannelParams[deviceID].pCommDrv, gHostChannelParams[deviceID].deviceInfo,</div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                            <a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a>[HOST_MSG_CMD_SLAVE_ADDR_OFFSET], <a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a>[<a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02a8414becebdadfaf00ee9cf5df5bfa887">HOST_MSG_CMD_REGIS_ADDR_OFFSET</a>],</div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                            <a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a> + <a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02ad0f2fd8313dd065bc85bd295572ccf73">HOST_MSG_CMD_VALUE_OFFSET</a>, dataLength - 2);</div><div class="line"><a name="l00319"></a><span class="lineno">  319</span>&#160;                    }</div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                }</div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                <span class="keywordflow">if</span> (ARM_DRIVER_OK == status)</div><div class="line"><a name="l00322"></a><span class="lineno">  322</span>&#160;                {</div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                    responseTag |= <a class="code" href="a00101.html#aea343e5b005737ea7fbd1ed33c17f5ba">HOST_PRO_CMD_WR_ACK_TAG</a>;</div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                }</div><div class="line"><a name="l00325"></a><span class="lineno">  325</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;            }</div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;            <span class="comment">/* Check if it is a Command from Host to Read Register Data and has 3 Byte payload (SlaveAddress,</span></div><div class="line"><a name="l00328"></a><span class="lineno">  328</span>&#160;<span class="comment">             * RegisterAddress and BytesToRead). */</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;            <span class="keywordflow">if</span> ((<a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a>[<a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02a869f718992b3a1413d42fe96294fdcb7">HOST_MSG_HDR_TAG_OFFSET</a>] == (<a class="code" href="a00101.html#a24c0ee2064102a8de73651950dd9fbcb">HOST_PRO_INT_CMD_TAG</a> | <a class="code" href="a00101.html#a764fc306a207f31b46440521051f6d3f">HOST_PRO_CMD_R_REG_TAG</a>)) &amp;&amp;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                (dataLength == 3))</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;            {</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;                <a class="code" href="a00521.html#a5d7069350a7d7e65686c77a8038f462f">int32_t</a> <a class="code" href="a00359.html#a369536ebfe385731562c0b55dd6f3a7c">status</a> = ARM_DRIVER_ERROR;</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                <span class="comment">/* Fetch the slave bus handle using known Slave Address. */</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                uint8_t deviceID = <a class="code" href="a00098.html#a1b00cf0487d683b14751aeadbd18fa77">getSlaveIndex</a>(<a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a>[<a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02a9cc0543af7e2bb1c2367f78c877afa19">HOST_MSG_CMD_SLAVE_ADDR_OFFSET</a>]);</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;                <span class="comment">/* Allocate memory as per updated size of response packet for this command. */</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                free(pMsgResponse);</div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                pMsgResponse = malloc(responseSize + <a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a>[<a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02a232d750ea83fb6243414132a9aa37e84">HOST_MSG_CMD_LENGTH_OFFSET</a>]);</div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;                <span class="keywordflow">if</span> (gHostChannelParams[deviceID].pCommDrv)</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;                {</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                    <span class="keywordflow">if</span> (gHostChannelParams[deviceID].pSPIparams)</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;                    {</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                        status = <a class="code" href="a00173.html#a76a3aee498397854509b81ae2da2f85e">Register_SPI_Read</a>(</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;                            gHostChannelParams[deviceID].pCommDrv, gHostChannelParams[deviceID].deviceInfo,</div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;                            gHostChannelParams[deviceID].pSPIparams, <a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a>[<a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02a8414becebdadfaf00ee9cf5df5bfa887">HOST_MSG_CMD_REGIS_ADDR_OFFSET</a>],</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                            <a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a>[HOST_MSG_CMD_LENGTH_OFFSET], pMsgResponse + responseSize);</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                    }</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;                    <span class="keywordflow">else</span></div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;                    {</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;                        status = <a class="code" href="a00167.html#ac8a60c799d9dbc84531b4680762eb8dc">Register_I2C_Read</a>(</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                            gHostChannelParams[deviceID].pCommDrv, gHostChannelParams[deviceID].deviceInfo,</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;                            <a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a>[HOST_MSG_CMD_SLAVE_ADDR_OFFSET], <a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a>[<a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02a8414becebdadfaf00ee9cf5df5bfa887">HOST_MSG_CMD_REGIS_ADDR_OFFSET</a>],</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;                            <a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a>[HOST_MSG_CMD_LENGTH_OFFSET], pMsgResponse + responseSize);</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                    }</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;                }</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;                <span class="keywordflow">if</span> (process_host_command)</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;                { <span class="comment">/* Call the user callback to enable user post-process the register read payload (if required). */</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;                    <a class="code" href="a00401.html#a0076d28c9a17cd6908c7b3b0f5c6006c">process_host_command</a>(<a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a>[<a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02a869f718992b3a1413d42fe96294fdcb7">HOST_MSG_HDR_TAG_OFFSET</a>],</div><div class="line"><a name="l00358"></a><span class="lineno">  358</span>&#160;                                         <a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a> + HOST_MSG_CMD_SLAVE_ADDR_OFFSET, pMsgResponse + responseSize,</div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                                         &amp;dataLength, <a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a>[HOST_MSG_CMD_LENGTH_OFFSET]);</div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                }</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;                <span class="keywordflow">if</span> (ARM_DRIVER_OK == status)</div><div class="line"><a name="l00362"></a><span class="lineno">  362</span>&#160;                {</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;                    responseTag |= <a class="code" href="a00101.html#aea343e5b005737ea7fbd1ed33c17f5ba">HOST_PRO_CMD_WR_ACK_TAG</a>;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;                    responseSize += <a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a>[<a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02a232d750ea83fb6243414132a9aa37e84">HOST_MSG_CMD_LENGTH_OFFSET</a>];</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;                }</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;            }</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;            <span class="comment">/* Check if it is a Command from Host for Read/Write Configuration or User defined and has &gt; 0 Byte payload.</span></div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;<span class="comment">             */</span></div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;            <span class="keywordflow">if</span> ((<a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a>[<a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02a869f718992b3a1413d42fe96294fdcb7">HOST_MSG_HDR_TAG_OFFSET</a>] &amp; <a class="code" href="a00101.html#a24c0ee2064102a8de73651950dd9fbcb">HOST_PRO_INT_CMD_TAG</a>) &amp;&amp; (dataLength &gt; 0))</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;            { <span class="comment">/* Allocate memory for max possible response packet size for this command and populate the payload. */</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;                free(pMsgResponse);</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;                pMsgResponse = malloc(<a class="code" href="a00101.html#a76e42ea7e038084c4187840bea184a6e">HOST_CMD_RSP_LEN</a>);</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                <span class="keywordflow">if</span> (process_host_command)</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;                { <span class="comment">/* Call the user callback to proces the user specific payload. */</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                    bCmdSuccess = <a class="code" href="a00401.html#a0076d28c9a17cd6908c7b3b0f5c6006c">process_host_command</a>(<a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a>[<a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02a869f718992b3a1413d42fe96294fdcb7">HOST_MSG_HDR_TAG_OFFSET</a>],</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;                                                       <a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a> + <a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02ae5286100318272176fbc8b91843604ec">HOST_MSG_CMD_OPC_OFFSET</a>,</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;                                                       pMsgResponse + <a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02ae5286100318272176fbc8b91843604ec">HOST_MSG_CMD_OPC_OFFSET</a>, &amp;dataLength,</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;                                                       <a class="code" href="a00101.html#a76e42ea7e038084c4187840bea184a6e">HOST_CMD_RSP_LEN</a> - <a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02ae5286100318272176fbc8b91843604ec">HOST_MSG_CMD_OPC_OFFSET</a>);</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;                }</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;                <span class="keywordflow">if</span> (bCmdSuccess)</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;                {</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;                    responseTag |= <a class="code" href="a00101.html#aea343e5b005737ea7fbd1ed33c17f5ba">HOST_PRO_CMD_WR_ACK_TAG</a>;</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;                }</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;                <span class="keywordflow">else</span></div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;                {</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;                    dataLength = 0;</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;                }</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;                responseSize = <a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02ae5286100318272176fbc8b91843604ec">HOST_MSG_CMD_OPC_OFFSET</a> + dataLength;</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;                <span class="keywordflow">break</span>;</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;            }</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;        } <span class="keywordflow">while</span> (<span class="keyword">false</span>);</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;        <span class="comment">/* Populate the response packet header. */</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;        pMsgResponse[<a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02a869f718992b3a1413d42fe96294fdcb7">HOST_MSG_HDR_TAG_OFFSET</a>] = responseTag;</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;        <span class="keywordflow">if</span> (responseTag == <a class="code" href="a00101.html#a6a3695a33b82875d8285b40c8c417de1">HOST_PRO_INT_DEV_TAG</a>)</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;        {</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;            pMsgResponse[<a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02a697d65fa9de804270ef05d1cce64c47d">HOST_DEV_HDR_VER_OFFSET</a>] = <a class="code" href="a00527.html#ada0e093e051350fd5ae901155777b701">HOST_INTERFACE_VERSION</a>;</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;        }</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;        {</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;            pMsgResponse[<a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02aa6cb4df6f3a2285a8c972232b5019fd8">HOST_MSG_HDR_SEQ_OFFSET</a>] = <a class="code" href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a>[<a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02aa6cb4df6f3a2285a8c972232b5019fd8">HOST_MSG_HDR_SEQ_OFFSET</a>];</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;            pMsgResponse[<a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02a0f735713456e47ca551cae3f581c9a7c">HOST_MSG_LEN_MSB_OFFSET</a>] = (responseSize - <a class="code" href="a00101.html#a651ffcb801a111da39997564bb77cf66">HOST_RSP_HDR_LEN</a>) &gt;&gt; 8;</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;            pMsgResponse[<a class="code" href="a00101.html#a831b5795adf211dfa086182261563b02aa7fc80700bf9fa14ef02fd298fb660e7">HOST_MSG_LEN_LSB_OFFSET</a>] = (responseSize - <a class="code" href="a00101.html#a651ffcb801a111da39997564bb77cf66">HOST_RSP_HDR_LEN</a>) &amp; 0xFF;</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;        }</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;        <span class="comment">/* Send response to Host. */</span></div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;        <a class="code" href="a00098.html#a719ad6da4502e713f1573b5353af9617">Host_IO_Send</a>(pMsgResponse, responseSize, encoding);</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;        free(pMsgResponse);</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    }</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;}</div><div class="ttc" id="a00521_html_a18e09d6eabccd6dfc2d5066542020e59"><div class="ttname"><a href="a00521.html#a18e09d6eabccd6dfc2d5066542020e59">size</a></div><div class="ttdeci">uint32_t size</div><div class="ttdef"><b>Definition:</b> <a href="a00521_source.html#l00043">data_format_service.h:43</a></div></div>
<div class="ttc" id="a00098_html_aa86e36e002f9c35901d49a9a99f47aa4"><div class="ttname"><a href="a00098.html#aa86e36e002f9c35901d49a9a99f47aa4">bUartRxPendingMsg</a></div><div class="ttdeci">volatile bool bUartRxPendingMsg</div><div class="ttdef"><b>Definition:</b> <a href="a00098_source.html#l00041">host_io_uart.c:41</a></div></div>
<div class="ttc" id="a00098_html_a1b00cf0487d683b14751aeadbd18fa77"><div class="ttname"><a href="a00098.html#a1b00cf0487d683b14751aeadbd18fa77">getSlaveIndex</a></div><div class="ttdeci">uint8_t getSlaveIndex(uint8_t slaveAddress)</div><div class="ttdef"><b>Definition:</b> <a href="a00098_source.html#l00064">host_io_uart.c:64</a></div></div>
<div class="ttc" id="a00098_html_ab4b858422bbaae71aff2ab540ae0e2b1"><div class="ttname"><a href="a00098.html#ab4b858422bbaae71aff2ab540ae0e2b1">Host_IO_Init</a></div><div class="ttdeci">uint8_t Host_IO_Init(ARM_DRIVER_USART *pDrv, void *pBus, void *pDevInfo, void *spiSlaveParams, uint16_t slaveAddress)</div><div class="ttdef"><b>Definition:</b> <a href="a00098_source.html#l00100">host_io_uart.c:100</a></div></div>
<div class="ttc" id="a02923_html_a67af74c3fc959654c6dc8bcff3a2ea80"><div class="ttname"><a href="a02923.html#a67af74c3fc959654c6dc8bcff3a2ea80">host_channel_params_t::slaveAddress</a></div><div class="ttdeci">uint16_t slaveAddress</div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00041">host_io_uart.h:41</a></div></div>
<div class="ttc" id="a00098_html_a3924d21a0703878695ebdb68f720fff9"><div class="ttname"><a href="a00098.html#a3924d21a0703878695ebdb68f720fff9">Host_IO_Receive</a></div><div class="ttdeci">void Host_IO_Receive(host_cmd_proc_fn_t process_host_command, uint8_t encoding)</div><div class="ttdef"><b>Definition:</b> <a href="a00098_source.html#l00207">host_io_uart.c:207</a></div></div>
<div class="ttc" id="a00101_html_aea343e5b005737ea7fbd1ed33c17f5ba"><div class="ttname"><a href="a00101.html#aea343e5b005737ea7fbd1ed33c17f5ba">HOST_PRO_CMD_WR_ACK_TAG</a></div><div class="ttdeci">#define HOST_PRO_CMD_WR_ACK_TAG</div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00070">host_io_uart.h:70</a></div></div>
<div class="ttc" id="a00359_html_a369536ebfe385731562c0b55dd6f3a7c"><div class="ttname"><a href="a00359.html#a369536ebfe385731562c0b55dd6f3a7c">status</a></div><div class="ttdeci">int32_t status</div><div class="ttdef"><b>Definition:</b> <a href="a00359_source.html#l00248">fxls896xaf_freemaster_demo.c:248</a></div></div>
<div class="ttc" id="a00101_html_a764fc306a207f31b46440521051f6d3f"><div class="ttname"><a href="a00101.html#a764fc306a207f31b46440521051f6d3f">HOST_PRO_CMD_R_REG_TAG</a></div><div class="ttdeci">#define HOST_PRO_CMD_R_REG_TAG</div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00066">host_io_uart.h:66</a></div></div>
<div class="ttc" id="a00167_html_ac8a60c799d9dbc84531b4680762eb8dc"><div class="ttname"><a href="a00167.html#ac8a60c799d9dbc84531b4680762eb8dc">Register_I2C_Read</a></div><div class="ttdeci">int32_t Register_I2C_Read(ARM_DRIVER_I2C *pCommDrv, registerDeviceInfo_t *devInfo, uint16_t slaveAddress, uint8_t offset, uint8_t length, uint8_t *pOutBuffer)</div><div class="ttdoc">The interface function to read a sensor register. </div><div class="ttdef"><b>Definition:</b> <a href="a00167_source.html#l00310">register_io_i2c.c:310</a></div></div>
<div class="ttc" id="a00101_html_a831b5795adf211dfa086182261563b02aae167b647c99bc31a7fb7f8c94aca12f"><div class="ttname"><a href="a00101.html#a831b5795adf211dfa086182261563b02aae167b647c99bc31a7fb7f8c94aca12f">HOST_ISO_LEN_MSB_OFFSET</a></div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00089">host_io_uart.h:89</a></div></div>
<div class="ttc" id="a00101_html"><div class="ttname"><a href="a00101.html">host_io_uart.h</a></div><div class="ttdoc">The host_io_uart.h file contains the Host Protocol interface definitions and configuration. </div></div>
<div class="ttc" id="a00101_html_a831b5795adf211dfa086182261563b02a697d65fa9de804270ef05d1cce64c47d"><div class="ttname"><a href="a00101.html#a831b5795adf211dfa086182261563b02a697d65fa9de804270ef05d1cce64c47d">HOST_DEV_HDR_VER_OFFSET</a></div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00087">host_io_uart.h:87</a></div></div>
<div class="ttc" id="a02923_html_ab2a215cc9313cc96f710af5470f89964"><div class="ttname"><a href="a02923.html#ab2a215cc9313cc96f710af5470f89964">host_channel_params_t::pCommDrv</a></div><div class="ttdeci">void * pCommDrv</div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00039">host_io_uart.h:39</a></div></div>
<div class="ttc" id="a00101_html_abfac3847cc565a419e29418d97c45af4"><div class="ttname"><a href="a00101.html#abfac3847cc565a419e29418d97c45af4">HOST_PRO_CMD_WR_NAK_TAG</a></div><div class="ttdeci">#define HOST_PRO_CMD_WR_NAK_TAG</div><div class="ttdoc">Bit aligned values for Host Protocol Command Interface Status IDs (Bit 7). </div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00069">host_io_uart.h:69</a></div></div>
<div class="ttc" id="a00176_html"><div class="ttname"><a href="a00176.html">register_io_spi.h</a></div><div class="ttdoc">The register_io_spi.h file declares low-level interface functions for reading and writing sensor regi...</div></div>
<div class="ttc" id="a00524_html_aaa19dab07f472f4f64938a4902ef6eed"><div class="ttname"><a href="a00524.html#aaa19dab07f472f4f64938a4902ef6eed">HOST_Initialize</a></div><div class="ttdeci">int32_t HOST_Initialize(host_interface_handle_t *pHandle, comm_type_t type, void *pCommInstance, comm_instance_type_t inType, Host_Event_t event, void *pInData)</div><div class="ttdoc">The function to Initialize the Host. </div><div class="ttdef"><b>Definition:</b> <a href="a00524_source.html#l00026">host_interface_service.c:26</a></div></div>
<div class="ttc" id="a00101_html_a831b5795adf211dfa086182261563b02aa6cb4df6f3a2285a8c972232b5019fd8"><div class="ttname"><a href="a00101.html#a831b5795adf211dfa086182261563b02aa6cb4df6f3a2285a8c972232b5019fd8">HOST_MSG_HDR_SEQ_OFFSET</a></div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00082">host_io_uart.h:82</a></div></div>
<div class="ttc" id="a00527_html_ada0e093e051350fd5ae901155777b701"><div class="ttname"><a href="a00527.html#ada0e093e051350fd5ae901155777b701">HOST_INTERFACE_VERSION</a></div><div class="ttdeci">#define HOST_INTERFACE_VERSION</div><div class="ttdef"><b>Definition:</b> <a href="a00527_source.html#l00021">host_interface_service.h:21</a></div></div>
<div class="ttc" id="a00101_html_a831b5795adf211dfa086182261563b02a7d25131112210b00c80642bef852d4f4"><div class="ttname"><a href="a00101.html#a831b5795adf211dfa086182261563b02a7d25131112210b00c80642bef852d4f4">HOST_ISO_LEN_LSB_OFFSET</a></div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00090">host_io_uart.h:90</a></div></div>
<div class="ttc" id="a03927_html_a59f965a3233585fdd10c975bd4458948"><div class="ttname"><a href="a03927.html#a59f965a3233585fdd10c975bd4458948">_comm_handle_::pComm</a></div><div class="ttdeci">void * pComm</div><div class="ttdef"><b>Definition:</b> <a href="a00506_source.html#l00030">comm_interface.h:30</a></div></div>
<div class="ttc" id="a00101_html_a15b8f0a0cc23d28aafa1b827c46a5305a7920b2c6c711fc957a804d5f66dee301"><div class="ttname"><a href="a00101.html#a15b8f0a0cc23d28aafa1b827c46a5305a7920b2c6c711fc957a804d5f66dee301">HOST_FORMAT_PLAIN</a></div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00076">host_io_uart.h:76</a></div></div>
<div class="ttc" id="a00098_html_a286445357d1a40bad2dd064f0f653510"><div class="ttname"><a href="a00098.html#a286445357d1a40bad2dd064f0f653510">gUartRxBuff</a></div><div class="ttdeci">uint8_t gUartRxBuff</div><div class="ttdef"><b>Definition:</b> <a href="a00098_source.html#l00038">host_io_uart.c:38</a></div></div>
<div class="ttc" id="a00101_html_ae7d102c35c708dd10f5dbe5e01685ce4"><div class="ttname"><a href="a00101.html#ae7d102c35c708dd10f5dbe5e01685ce4">MAX_HOST_STREAMS</a></div><div class="ttdeci">#define MAX_HOST_STREAMS</div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00030">host_io_uart.h:30</a></div></div>
<div class="ttc" id="a00098_html_a5f7481a79b18cfdeb27562acebca6ba0"><div class="ttname"><a href="a00098.html#a5f7481a79b18cfdeb27562acebca6ba0">HOST_SignalEvent_t</a></div><div class="ttdeci">void HOST_SignalEvent_t(uint32_t event)</div><div class="ttdoc">Defines the HOST UART signal event handler. </div><div class="ttdef"><b>Definition:</b> <a href="a00098_source.html#l00047">host_io_uart.c:47</a></div></div>
<div class="ttc" id="a02927_html"><div class="ttname"><a href="a02927.html">host_rx_packet_t</a></div><div class="ttdoc">This structure holds information to receive a packet of data to the host. </div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00049">host_io_uart.h:49</a></div></div>
<div class="ttc" id="a00101_html_a831b5795adf211dfa086182261563b02a0f735713456e47ca551cae3f581c9a7c"><div class="ttname"><a href="a00101.html#a831b5795adf211dfa086182261563b02a0f735713456e47ca551cae3f581c9a7c">HOST_MSG_LEN_MSB_OFFSET</a></div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00083">host_io_uart.h:83</a></div></div>
<div class="ttc" id="a00101_html_a831b5795adf211dfa086182261563b02a869f718992b3a1413d42fe96294fdcb7"><div class="ttname"><a href="a00101.html#a831b5795adf211dfa086182261563b02a869f718992b3a1413d42fe96294fdcb7">HOST_MSG_HDR_TAG_OFFSET</a></div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00081">host_io_uart.h:81</a></div></div>
<div class="ttc" id="a00521_html_a5d7069350a7d7e65686c77a8038f462f"><div class="ttname"><a href="a00521.html#a5d7069350a7d7e65686c77a8038f462f">int32_t</a></div><div class="ttdeci">typedef int32_t(DATA_FORMAT_Append_t))(void *pData</div><div class="ttdoc">The interface function to append the data on the formated stream. </div></div>
<div class="ttc" id="a02927_html_a7154405d775832040d46ee3336363378"><div class="ttname"><a href="a02927.html#a7154405d775832040d46ee3336363378">host_rx_packet_t::pRxbuf</a></div><div class="ttdeci">uint8_t * pRxbuf</div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00053">host_io_uart.h:53</a></div></div>
<div class="ttc" id="a00518_html"><div class="ttname"><a href="a00518.html">data_format_json.h</a></div><div class="ttdoc">The format_json.h file describes the structures and definitions for the data-format standard JSON...</div></div>
<div class="ttc" id="a00170_html"><div class="ttname"><a href="a00170.html">register_io_i2c.h</a></div><div class="ttdoc">The register_io_i2c.h file declares low-level interface functions for reading and writing sensor regi...</div></div>
<div class="ttc" id="a00401_html_a0076d28c9a17cd6908c7b3b0f5c6006c"><div class="ttname"><a href="a00401.html#a0076d28c9a17cd6908c7b3b0f5c6006c">process_host_command</a></div><div class="ttdeci">bool process_host_command(uint8_t tag, uint8_t *hostCommand, uint8_t *hostResponse, size_t *hostMsgSize, size_t respBufferSize)</div><div class="ttdef"><b>Definition:</b> <a href="a00401_source.html#l00144">data_logger_demo.c:144</a></div></div>
<div class="ttc" id="a00509_html_af69cf775e44516f29d6ba5a93eacfbd8"><div class="ttname"><a href="a00509.html#af69cf775e44516f29d6ba5a93eacfbd8">HDLC_Process_Rx_Byte</a></div><div class="ttdeci">bool HDLC_Process_Rx_Byte(uint8_t c, host_rx_packet_t *pHostRxPkt)</div><div class="ttdef"><b>Definition:</b> <a href="a00509_source.html#l00024">data_format_hdlc.c:24</a></div></div>
<div class="ttc" id="a00506_html_a6e3bbe66379f732578e50af28a7f3981a733e810a23aa669c73a88d1bb4938f86"><div class="ttname"><a href="a00506.html#a6e3bbe66379f732578e50af28a7f3981a733e810a23aa669c73a88d1bb4938f86">COMM_NONBLOCKING</a></div><div class="ttdef"><b>Definition:</b> <a href="a00506_source.html#l00058">comm_interface.h:58</a></div></div>
<div class="ttc" id="a00098_html_a68a2c033a0f6f967149dca76897f5c8a"><div class="ttname"><a href="a00098.html#a68a2c033a0f6f967149dca76897f5c8a">Host_IO_Add_ISO_Header</a></div><div class="ttdeci">void Host_IO_Add_ISO_Header(uint8_t streamID, uint8_t *pStreamingPacket, size_t sizePayload)</div><div class="ttdef"><b>Definition:</b> <a href="a00098_source.html#l00086">host_io_uart.c:86</a></div></div>
<div class="ttc" id="a00101_html_a831b5795adf211dfa086182261563b02a9cc0543af7e2bb1c2367f78c877afa19"><div class="ttname"><a href="a00101.html#a831b5795adf211dfa086182261563b02a9cc0543af7e2bb1c2367f78c877afa19">HOST_MSG_CMD_SLAVE_ADDR_OFFSET</a></div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00092">host_io_uart.h:92</a></div></div>
<div class="ttc" id="a00101_html_a071e5542770ff815dcc93a74fdad769a"><div class="ttname"><a href="a00101.html#a071e5542770ff815dcc93a74fdad769a">HOST_PRO_CMD_W_REG_TAG</a></div><div class="ttdeci">#define HOST_PRO_CMD_W_REG_TAG</div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00065">host_io_uart.h:65</a></div></div>
<div class="ttc" id="a00101_html_adb701b5640d108f34d7395a98547b724"><div class="ttname"><a href="a00101.html#adb701b5640d108f34d7395a98547b724">HOST_RX_BUF_LEN</a></div><div class="ttdeci">#define HOST_RX_BUF_LEN</div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00026">host_io_uart.h:26</a></div></div>
<div class="ttc" id="a02923_html_aef2a754643e613a67e01f82b7340dca0"><div class="ttname"><a href="a02923.html#aef2a754643e613a67e01f82b7340dca0">host_channel_params_t::deviceInfo</a></div><div class="ttdeci">void * deviceInfo</div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00038">host_io_uart.h:38</a></div></div>
<div class="ttc" id="a02923_html"><div class="ttname"><a href="a02923.html">host_channel_params_t</a></div><div class="ttdoc">This structure holds information regarding the Encoding and RLI interface parameters. </div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00036">host_io_uart.h:36</a></div></div>
<div class="ttc" id="a00509_html_a1b0cdde224e0adf381d431058d2de34a"><div class="ttname"><a href="a00509.html#a1b0cdde224e0adf381d431058d2de34a">HDLC_Process_Tx_Msg</a></div><div class="ttdeci">size_t HDLC_Process_Tx_Msg(const uint8_t *pBuffer, uint8_t *pMsg, size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="a00509_source.html#l00103">data_format_hdlc.c:103</a></div></div>
<div class="ttc" id="a00101_html_a831b5795adf211dfa086182261563b02ad0f2fd8313dd065bc85bd295572ccf73"><div class="ttname"><a href="a00101.html#a831b5795adf211dfa086182261563b02ad0f2fd8313dd065bc85bd295572ccf73">HOST_MSG_CMD_VALUE_OFFSET</a></div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00094">host_io_uart.h:94</a></div></div>
<div class="ttc" id="a03943_html"><div class="ttname"><a href="a03943.html">_host_interface_handle_</a></div><div class="ttdef"><b>Definition:</b> <a href="a00527_source.html#l00031">host_interface_service.h:31</a></div></div>
<div class="ttc" id="a00524_html_aeb19f7f23fe9119b1a678cf7434a91dc"><div class="ttname"><a href="a00524.html#aeb19f7f23fe9119b1a678cf7434a91dc">HOST_Receive</a></div><div class="ttdeci">int32_t HOST_Receive(host_interface_handle_t *pHandle, uint8_t *pData, uint32_t *pRecvSize, uint32_t size, BlockRead_t process)</div><div class="ttdoc">The function to receive data from the host. </div><div class="ttdef"><b>Definition:</b> <a href="a00524_source.html#l00067">host_interface_service.c:67</a></div></div>
<div class="ttc" id="a00101_html_ad6633eaf1ea26ebdd208b31a73075f9b"><div class="ttname"><a href="a00101.html#ad6633eaf1ea26ebdd208b31a73075f9b">HOST_DEV_RSP_LEN</a></div><div class="ttdeci">#define HOST_DEV_RSP_LEN</div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00028">host_io_uart.h:28</a></div></div>
<div class="ttc" id="a00098_html_a7cfa89fd8cb56f14a3221987c7296eca"><div class="ttname"><a href="a00098.html#a7cfa89fd8cb56f14a3221987c7296eca">gHostRxBuff</a></div><div class="ttdeci">uint8_t gHostRxBuff[HOST_RX_BUF_LEN]</div><div class="ttdef"><b>Definition:</b> <a href="a00098_source.html#l00038">host_io_uart.c:38</a></div></div>
<div class="ttc" id="a00098_html_a719ad6da4502e713f1573b5353af9617"><div class="ttname"><a href="a00098.html#a719ad6da4502e713f1573b5353af9617">Host_IO_Send</a></div><div class="ttdeci">void Host_IO_Send(uint8_t *pMsg, size_t size, uint8_t encoding)</div><div class="ttdef"><b>Definition:</b> <a href="a00098_source.html#l00136">host_io_uart.c:136</a></div></div>
<div class="ttc" id="a00101_html_a15b8f0a0cc23d28aafa1b827c46a5305a7c754ec0cda1ed431ce52c2c4a6a63da"><div class="ttname"><a href="a00101.html#a15b8f0a0cc23d28aafa1b827c46a5305a7c754ec0cda1ed431ce52c2c4a6a63da">HOST_FORMAT_HDLC</a></div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00074">host_io_uart.h:74</a></div></div>
<div class="ttc" id="a03931_html_af47d900be5b5e5b1cce48f959401cb4e"><div class="ttname"><a href="a03931.html#af47d900be5b5e5b1cce48f959401cb4e">_comm_control_::control</a></div><div class="ttdeci">uint32_t control</div><div class="ttdef"><b>Definition:</b> <a href="a00506_source.html#l00038">comm_interface.h:38</a></div></div>
<div class="ttc" id="a00512_html"><div class="ttname"><a href="a00512.html">data_format_hdlc.h</a></div><div class="ttdoc">The data_format_hdlc.h file contains the Host interface definitions and configuration. </div></div>
<div class="ttc" id="a00101_html_a831b5795adf211dfa086182261563b02a82bb9264bd2257ba906bd8f051ff72d3"><div class="ttname"><a href="a00101.html#a831b5795adf211dfa086182261563b02a82bb9264bd2257ba906bd8f051ff72d3">HOST_ISO_PAYLOAD_OFFSET</a></div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00091">host_io_uart.h:91</a></div></div>
<div class="ttc" id="a02927_html_a000f6e2acab93210fdd84fa0709c95ca"><div class="ttname"><a href="a02927.html#a000f6e2acab93210fdd84fa0709c95ca">host_rx_packet_t::mIndex</a></div><div class="ttdeci">uint8_t mIndex</div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00052">host_io_uart.h:52</a></div></div>
<div class="ttc" id="a03943_html_ac0f97a5935c8c1d55a949c43b44c2bec"><div class="ttname"><a href="a03943.html#ac0f97a5935c8c1d55a949c43b44c2bec">_host_interface_handle_::commHandle</a></div><div class="ttdeci">comm_handle_t commHandle</div><div class="ttdef"><b>Definition:</b> <a href="a00527_source.html#l00036">host_interface_service.h:36</a></div></div>
<div class="ttc" id="a00101_html_a6a3695a33b82875d8285b40c8c417de1"><div class="ttname"><a href="a00101.html#a6a3695a33b82875d8285b40c8c417de1">HOST_PRO_INT_DEV_TAG</a></div><div class="ttdeci">#define HOST_PRO_INT_DEV_TAG</div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00059">host_io_uart.h:59</a></div></div>
<div class="ttc" id="a00101_html_a831b5795adf211dfa086182261563b02ae5286100318272176fbc8b91843604ec"><div class="ttname"><a href="a00101.html#a831b5795adf211dfa086182261563b02ae5286100318272176fbc8b91843604ec">HOST_MSG_CMD_OPC_OFFSET</a></div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00085">host_io_uart.h:85</a></div></div>
<div class="ttc" id="a00101_html_ab21d1c8714400342fc64db60dcf6e05f"><div class="ttname"><a href="a00101.html#ab21d1c8714400342fc64db60dcf6e05f">HOST_PRO_INT_ISO_TAG</a></div><div class="ttdeci">#define HOST_PRO_INT_ISO_TAG</div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00058">host_io_uart.h:58</a></div></div>
<div class="ttc" id="a00101_html_a15b8f0a0cc23d28aafa1b827c46a5305a7ed4651d866a686a5c463e985df09f08"><div class="ttname"><a href="a00101.html#a15b8f0a0cc23d28aafa1b827c46a5305a7ed4651d866a686a5c463e985df09f08">HOST_FORMAT_JSON</a></div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00075">host_io_uart.h:75</a></div></div>
<div class="ttc" id="a00098_html_a8c0bca493307d9132485c8a4e71fd03e"><div class="ttname"><a href="a00098.html#a8c0bca493307d9132485c8a4e71fd03e">gHostChannelParams</a></div><div class="ttdeci">host_channel_params_t gHostChannelParams[MAX_HOST_STREAMS]</div><div class="ttdef"><b>Definition:</b> <a href="a00098_source.html#l00040">host_io_uart.c:40</a></div></div>
<div class="ttc" id="a00524_html_ad708231312ecd814cb70c710fcdea37d"><div class="ttname"><a href="a00524.html#ad708231312ecd814cb70c710fcdea37d">HOST_Send</a></div><div class="ttdeci">int32_t HOST_Send(host_interface_handle_t *pHandle, uint8_t *pData, uint32_t size)</div><div class="ttdoc">The function to Send the data to the host. </div><div class="ttdef"><b>Definition:</b> <a href="a00524_source.html#l00058">host_interface_service.c:58</a></div></div>
<div class="ttc" id="a00506_html_a3ec76cbd0350991085b430f1a9e2f6acaaf4b9442ca66d2f23c46a10dec1f5f11"><div class="ttname"><a href="a00506.html#a3ec76cbd0350991085b430f1a9e2f6acaaf4b9442ca66d2f23c46a10dec1f5f11">COMM_UART</a></div><div class="ttdef"><b>Definition:</b> <a href="a00506_source.html#l00046">comm_interface.h:46</a></div></div>
<div class="ttc" id="a00515_html_abab3c54ca70a6f8384cd4aab3e475c19"><div class="ttname"><a href="a00515.html#abab3c54ca70a6f8384cd4aab3e475c19">JSON_Process_Tx_Msg</a></div><div class="ttdeci">size_t JSON_Process_Tx_Msg(const uint8_t *pBuffer, uint8_t *pMsg, size_t size)</div><div class="ttdef"><b>Definition:</b> <a href="a00515_source.html#l00164">data_format_json.c:164</a></div></div>
<div class="ttc" id="a00524_html_ae3e5d4f17870b1311c165af014a3e09f"><div class="ttname"><a href="a00524.html#ae3e5d4f17870b1311c165af014a3e09f">HOST_Configure</a></div><div class="ttdeci">int32_t HOST_Configure(host_interface_handle_t *pHandle, void *pConfigData)</div><div class="ttdoc">The function to Configure the Host. </div><div class="ttdef"><b>Definition:</b> <a href="a00524_source.html#l00049">host_interface_service.c:49</a></div></div>
<div class="ttc" id="a03943_html_aa1a7122e5b01453391a9ab53f13efcff"><div class="ttname"><a href="a03943.html#aa1a7122e5b01453391a9ab53f13efcff">_host_interface_handle_::pCommInterface</a></div><div class="ttdeci">comm_interface_t * pCommInterface</div><div class="ttdef"><b>Definition:</b> <a href="a00527_source.html#l00033">host_interface_service.h:33</a></div></div>
<div class="ttc" id="a00173_html_a0662e3575811a227d02c1cfe802744c5"><div class="ttname"><a href="a00173.html#a0662e3575811a227d02c1cfe802744c5">Register_SPI_BlockWrite</a></div><div class="ttdeci">int32_t Register_SPI_BlockWrite(ARM_DRIVER_SPI *pCommDrv, registerDeviceInfo_t *devInfo, void *pWriteParams, uint8_t offset, const uint8_t *pBuffer, uint8_t bytesToWrite)</div><div class="ttdoc">The interface function to block write to a sensor register. </div><div class="ttdef"><b>Definition:</b> <a href="a00173_source.html#l00162">register_io_spi.c:162</a></div></div>
<div class="ttc" id="a00167_html_ac5a66aa1b8d95d267c9d68cb475c9e01"><div class="ttname"><a href="a00167.html#ac5a66aa1b8d95d267c9d68cb475c9e01">Register_I2C_BlockWrite</a></div><div class="ttdeci">int32_t Register_I2C_BlockWrite(ARM_DRIVER_I2C *pCommDrv, registerDeviceInfo_t *devInfo, uint16_t slaveAddress, uint8_t offset, const uint8_t *pBuffer, uint8_t bytesToWrite)</div><div class="ttdoc">The interface function to write a sensor register. </div><div class="ttdef"><b>Definition:</b> <a href="a00167_source.html#l00149">register_io_i2c.c:149</a></div></div>
<div class="ttc" id="a00515_html_a82cfef5d07d5b3c2b1f8795309ab9e67"><div class="ttname"><a href="a00515.html#a82cfef5d07d5b3c2b1f8795309ab9e67">JSON_Process_Rx_Byte</a></div><div class="ttdeci">bool JSON_Process_Rx_Byte(uint8_t c, host_rx_packet_t *pHostRxPkt)</div><div class="ttdoc">Function to handle incomming JSON encoded bytes form the Host over UART. </div><div class="ttdef"><b>Definition:</b> <a href="a00515_source.html#l00158">data_format_json.c:158</a></div></div>
<div class="ttc" id="a00098_html_aaa9965c3c746bcf8e7e9eda2117056ad"><div class="ttname"><a href="a00098.html#aaa9965c3c746bcf8e7e9eda2117056ad">bUartTxComplete</a></div><div class="ttdeci">volatile bool bUartTxComplete</div><div class="ttdef"><b>Definition:</b> <a href="a00098_source.html#l00041">host_io_uart.c:41</a></div></div>
<div class="ttc" id="a00098_html_abed4be42ee7c54dcc1132ab8897f06a6"><div class="ttname"><a href="a00098.html#abed4be42ee7c54dcc1132ab8897f06a6">gHostRxPkt</a></div><div class="ttdeci">host_rx_packet_t gHostRxPkt</div><div class="ttdef"><b>Definition:</b> <a href="a00098_source.html#l00039">host_io_uart.c:39</a></div></div>
<div class="ttc" id="a00101_html_a76e42ea7e038084c4187840bea184a6e"><div class="ttname"><a href="a00101.html#a76e42ea7e038084c4187840bea184a6e">HOST_CMD_RSP_LEN</a></div><div class="ttdeci">#define HOST_CMD_RSP_LEN</div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00029">host_io_uart.h:29</a></div></div>
<div class="ttc" id="a00101_html_a651ffcb801a111da39997564bb77cf66"><div class="ttname"><a href="a00101.html#a651ffcb801a111da39997564bb77cf66">HOST_RSP_HDR_LEN</a></div><div class="ttdeci">#define HOST_RSP_HDR_LEN</div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00027">host_io_uart.h:27</a></div></div>
<div class="ttc" id="a00101_html_a831b5795adf211dfa086182261563b02add8f03bdf28a3e04774fa34081dc901e"><div class="ttname"><a href="a00101.html#a831b5795adf211dfa086182261563b02add8f03bdf28a3e04774fa34081dc901e">HOST_DEV_LEN_STR_OFFSET</a></div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00088">host_io_uart.h:88</a></div></div>
<div class="ttc" id="a00101_html_a831b5795adf211dfa086182261563b02a232d750ea83fb6243414132a9aa37e84"><div class="ttname"><a href="a00101.html#a831b5795adf211dfa086182261563b02a232d750ea83fb6243414132a9aa37e84">HOST_MSG_CMD_LENGTH_OFFSET</a></div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00095">host_io_uart.h:95</a></div></div>
<div class="ttc" id="a03931_html"><div class="ttname"><a href="a03931.html">_comm_control_</a></div><div class="ttdef"><b>Definition:</b> <a href="a00506_source.html#l00036">comm_interface.h:36</a></div></div>
<div class="ttc" id="a00101_html_a24c0ee2064102a8de73651950dd9fbcb"><div class="ttname"><a href="a00101.html#a24c0ee2064102a8de73651950dd9fbcb">HOST_PRO_INT_CMD_TAG</a></div><div class="ttdeci">#define HOST_PRO_INT_CMD_TAG</div><div class="ttdoc">Bit aligned values for Host Protocol Interface IDs (Bits 5-6). </div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00057">host_io_uart.h:57</a></div></div>
<div class="ttc" id="a00173_html_a76a3aee498397854509b81ae2da2f85e"><div class="ttname"><a href="a00173.html#a76a3aee498397854509b81ae2da2f85e">Register_SPI_Read</a></div><div class="ttdeci">int32_t Register_SPI_Read(ARM_DRIVER_SPI *pCommDrv, registerDeviceInfo_t *devInfo, void *pReadParams, uint8_t offset, uint8_t length, uint8_t *pOutBuffer)</div><div class="ttdoc">The interface function to read a sensor register. </div><div class="ttdef"><b>Definition:</b> <a href="a00173_source.html#l00313">register_io_spi.c:313</a></div></div>
<div class="ttc" id="a00098_html_a0a02605045d9d7117b2c54ec8db7daeb"><div class="ttname"><a href="a00098.html#a0a02605045d9d7117b2c54ec8db7daeb">bUartErrorMsg</a></div><div class="ttdeci">volatile bool bUartErrorMsg</div><div class="ttdef"><b>Definition:</b> <a href="a00098_source.html#l00041">host_io_uart.c:41</a></div></div>
<div class="ttc" id="a02923_html_aaaf594566c8ab249734b58bc29dfb193"><div class="ttname"><a href="a02923.html#aaaf594566c8ab249734b58bc29dfb193">host_channel_params_t::pSPIparams</a></div><div class="ttdeci">void * pSPIparams</div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00040">host_io_uart.h:40</a></div></div>
<div class="ttc" id="a00101_html_a4b0be146f341173bd85affcec8c68f52"><div class="ttname"><a href="a00101.html#a4b0be146f341173bd85affcec8c68f52">host_cmd_proc_fn_t</a></div><div class="ttdeci">bool(* host_cmd_proc_fn_t)(uint8_t, uint8_t *, uint8_t *, size_t *, size_t)</div><div class="ttdoc">The Host Command Process Function ([IN]Command TAG, [IN]Commad Buffer, [OUT]Response Buffer...</div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00046">host_io_uart.h:46</a></div></div>
<div class="ttc" id="a00101_html_a831b5795adf211dfa086182261563b02a8414becebdadfaf00ee9cf5df5bfa887"><div class="ttname"><a href="a00101.html#a831b5795adf211dfa086182261563b02a8414becebdadfaf00ee9cf5df5bfa887">HOST_MSG_CMD_REGIS_ADDR_OFFSET</a></div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00093">host_io_uart.h:93</a></div></div>
<div class="ttc" id="a00101_html_a831b5795adf211dfa086182261563b02aa7fc80700bf9fa14ef02fd298fb660e7"><div class="ttname"><a href="a00101.html#a831b5795adf211dfa086182261563b02aa7fc80700bf9fa14ef02fd298fb660e7">HOST_MSG_LEN_LSB_OFFSET</a></div><div class="ttdef"><b>Definition:</b> <a href="a00101_source.html#l00084">host_io_uart.h:84</a></div></div>
<div class="ttc" id="a00098_html_a5d3ae17c131354598c173e13c349e81b"><div class="ttname"><a href="a00098.html#a5d3ae17c131354598c173e13c349e81b">gHostHandle</a></div><div class="ttdeci">host_interface_handle_t gHostHandle</div><div class="ttdef"><b>Definition:</b> <a href="a00098_source.html#l00037">host_io_uart.c:37</a></div></div>
</div><!-- fragment --></div><!-- contents -->

<hr class="footer"/><address class="footer"><small>
&copy; Copyright 2016-2022 NXP. All Rights Reserved. SPDX-License-Identifier: BSD-3-Clause
</small></address>
</body>
</html>
